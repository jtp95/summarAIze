{"1": "Introduction to Haar Measure Tools in Quantum\nInformation: A Beginner\u2019s Tutorial\nAntonio Anna Mele\nDahlem Center for Complex Quantum Systems, Freie Universit\u00a8at Berlin, 14195 Berlin, Germany\nThe Haar measure plays a vital role in quantum information, but its study often re-\nquires a deep understanding of representation theory, posing a challenge for beginners.\nThis tutorial aims to provide a basic introduction to Haar measure tools in quantum\ninformation, utilizing only basic knowledge of linear algebra and thus aiming to make\nthis topic more accessible. The tutorial begins by introducing the Haar measure with\na specific emphasis on characterizing the moment operator, an essential element for\ncomputing integrals over the Haar measure. It also covers properties of the symmetric\nsubspace and introduces helpful tools like tensor network diagrammatic notation, which\naid in visualizing and simplifying calculations. Next, the tutorial explores the concept\nof unitary designs, providing equivalent definitions, and subsequently explores approx-\nimate notions of unitary designs, shedding light on the relationships between these\ndifferent notions. Practical examples of Haar measure calculations are illustrated, in-\ncluding the derivation of well-known formulas such as the twirling of a quantum channel.\nLastly, the tutorial showcases the applications of Haar measure calculations in quantum\nmachine learning and classical shadow tomography.\nContents\n1\nIntroduction\n1\n2\nNotation and Preliminaries\n1\n3\nHaar measure and moment operator\n2\n4\nSymmetric subspace\n9\n5\nVectorization formalism\n14\n6\nTensor network diagrams\n17\n7\nUnitary designs\n22\n8\nApproximate unitary designs\n26\n9\nExamples and applications\n30\n9.1\nExamples of moment calculations . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n31\n9.2\nConcentration inequalities . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n35\n9.3\nApplications in Quantum Machine Learning . . . . . . . . . . . . . . . . . . . . . .\n37\n9.4\nClassical shadow tomography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n39\n10 Acknowledgments\n43\nAntonio Anna Mele: a.mele@fu-berlin.de\nAccepted in Quantum 2024-02-14, click title to verify. Published under CC-BY 4.0.\n1\narXiv:2307.08956v4  [quant-ph]  9 Apr 2024\n", "2": "1\nIntroduction\nThe notion of Haar measure formalizes the fundamental concept of drawing unitary matrices\nuniformly at random. In the context of quantum information, unitary matrices often represent\nquantum evolutions that are commonly described using quantum circuits. The applications of\nthe Haar measure are widespread across various domains within quantum information, such as\nquantum tomography [1\u20138], computational advantage of random quantum circuits sampling [9\u2013\n16], benchmarking of quantum devices [17\u201320], quantum foundations and communication [21\u201329],\nquantum machine learning [30\u201333], quantum many-body and high energy physics [34\u201344].\nAlthough the Haar measure serves as a fundamental tool in quantum information, its study can\nbe challenging for beginners due to its reliance on advanced concepts from representation theory.\nIn order to make this topic more accessible, this tutorial provides an introduction to Haar measure\ntools using only concepts from linear algebra. Throughout the tutorial, we intentionally avoid\ndelving into representation theory to enhance accessibility. For further reading, one can refer, for\nexample, to [39, 40, 45\u201351].\nThe tutorial is structured as follows. Section 2 offers an overview of the notation and pre-\nliminary concepts that will be used throughout the tutorial. Section 3 focuses on introducing the\nHaar measure, with a specific emphasis on characterizing the moment operator\u2014a crucial quantity\nfor computing integrals over the Haar measure. In Section 4, the symmetric and antisymmetric\nsubspaces are introduced, highlighting their properties and their connection to the Haar measure\nover pure states. Sections 5 and 6 introduce tools that facilitate calculations in Haar measure\napplications. Section 5 presents the vectorization formalism, while Section 6 introduces the tensor\nnetworks diagrammatic notation, providing visual representations that enhance comprehension and\nstreamline computations. Section 7 introduces the concept of unitary designs\u2014a method employed\nto mimic some properties of the Haar measure, facilitating efficient protocols in quantum comput-\ning. Building upon this foundation, Section 8 explores approximate notions of unitary designs,\nelucidating the relationships between the different introduced notions. In Section 9, the tutorial\nshowcases practical examples of Haar measure calculations. We begin by deriving well-known for-\nmulas such as the twirling of a quantum channel, average gate fidelity, average purity of reduced\nstates in bipartite systems, and Haar averages of observables expectation values. Furthermore, we\ndemonstrate how these expected value calculations can be translated into probability statements\nusing concentration inequalities. Finally, we delve into two in-depth applications: Barren Plateaus\nphenomena in Quantum Machine Learning and Classical Shadow Tomography, both of which rely\non the theory of k-designs.\n2\nNotation and Preliminaries\nWe use the following notation throughout this tutorial. L(Cd) is the set of linear operators that act\non the d-dimensional complex vector space Cd, while Herm(Cd) is the set of Hermitian operators\non Cd. The identity operator is denoted by I, and we define the operator I := I \u2297I as the tensor\nproduct of two identity operators. The unitary group is denoted by U(d) and is defined as the set\nof operators U \u2208L(Cd) such that U \u2020U = I. Furthermore, we use the notation [d] to denote the\nset of integers from 1 to d, i.e., [d] := {1, . . . , d}.\nLet v \u2208Cd be a vector, and let p \u2208[1, \u221e].\nThe p-norm of v is denoted by \u2225v\u2225p, and is\ndefined as \u2225v\u2225p := (Pd\ni=1 |vi|p)1/p.\nThe Schatten p-norm of a matrix A \u2208L\n\u0000Cd\u0001\nis given by\n\u2225A\u2225p := Tr((\n\u221a\nA\u2020A)p)1/p, which corresponds to the p-norm of the vector of singular values of A.\nThe trace norm and the Hilbert-Schmidt norm are important instances of Schatten p-norms and\nare respectively denoted as \u2225\u00b7 \u22251 and \u2225\u00b7 \u22252. The Hilbert-Schmidt norm is induced by the Hilbert-\nSchmidt scalar product \u27e8A, B\u27e9HS := Tr\n\u0000A\u2020B\n\u0001\nfor A, B \u2208L\n\u0000Cd\u0001\n. The infinite norm, denoted as\n\u2225\u00b7\u2225\u221e, of a matrix is defined as its largest singular value. This norm can be understood as the limit\nof the Schatten p-norm of the matrix as p approaches infinity. Important facts about the Schatten\np-norms that will be used in the tutorial are the following. For all matrices A and 1 \u2264p \u2264q, we\nhave \u2225A\u2225q \u2264\u2225A\u2225p and \u2225A\u2225p \u2264rank(A)(p\u22121\u2212q\u22121)\u2225A\u2225q. Additionally, for all unitaries U and V ,\nand matrix A, we have the unitary invariance property \u2225UAV \u2225p = \u2225A\u2225p. Furthermore, we also\nhave the tensor product property \u2225A \u2297B\u2225p = \u2225A\u2225p\u2225B\u2225p and the submultiplicativity property\n1\n", "3": "\u2225AB\u2225p \u2264\u2225A\u2225p\u2225B\u2225p, for all matrices A and B.\nWe use the bra-ket notation, where we denote a vector v \u2208Cd using the ket notation |v\u27e9and its\nadjoint using the bra notation \u27e8v|. We refer to a vector |\u03c8\u27e9\u2208Cd as a (pure) state if \u2225|\u03c8\u27e9\u22252 = 1. The\ncanonical basis of Cd is denoted by {|i\u27e9}d\ni=1. We define the non-normalized maximally entangled\nstate |\u2126\u27e9as |\u2126\u27e9:= Pd\ni=1 |i\u27e9\u2297|i\u27e9= Pd\ni=1 |i, i\u27e9. We define the set of density matrices (or quantum\nstates) as S\n\u0000Cd\u0001 := {\u03c1 \u2208L\n\u0000Cd\u0001\n: \u03c1 \u22650, Tr(\u03c1) = 1}. A quantum channel \u03a6 : L(Cd) \u2192L(Cd) is a\nlinear map that is completely positive and trace-preserving. In particular, the completely positive\ncondition means that for all positive operators \u03c3 \u2208L(Cd \u2297CD), for all D \u2208N, the operator\n\u03a6 \u2297I(\u03c3) is also positive. Here, I : L\n\u0000CD\u0001\n\u2192L\n\u0000CD\u0001\ndenotes the identity map, which simply\nmaps any A \u2208L\n\u0000CD\u0001\nto itself. Additionally, every quantum channel \u03a6 can be expressed in terms\nof d2 Kraus operators, i.e., there exist {Ki}d2\ni=1 operators such that \u03a6 (\u00b7) = Pd2\ni=1 Ki (\u00b7) K\u2020\ni , subject\nto the condition that Pd2\ni=1 K\u2020\ni Ki = I in order to satisfy the trace-preserving property.\n3\nHaar measure and moment operator\nDefinition 1 (Haar measure). The Haar measure on the unitary group U(d) is the unique proba-\nbility measure \u00b5H that is both left and right invariant over the group U(d), i.e., for all integrable\nfunctions f and for all V \u2208U(d), we have:\nZ\nU(d)\nf (U) d\u00b5H(U) =\nZ\nU(d)\nf (UV ) d\u00b5H(U) =\nZ\nU(d)\nf (V U) d\u00b5H(U).\n(1)\nIn fact, for compact groups such as the unitary group, there exists a unique probability measure\nthat is both left and right invariant under group multiplication [52]. However, we will not delve\ndeeper into the theory of compact groups and measures in this tutorial, as our focus is on applica-\ntions of the tools we describe. For a more comprehensive treatment of this topic, we recommend\nreferring to [51, 52].\nThe Haar measure is a probability measure, satisfying the properties\nR\nS 1 d\u00b5H(U) \u22650 for all\nsets S \u2286U(d) and\nR\nU(d) 1 d\u00b5H(U) = 1. Consequently, we can denote the integral of any function\nf(U) over the Haar measure as the expected value of f(U) with respect to the probability measure\n\u00b5H, denoted as\nE\nU\u223c\u00b5H[f(U)].\nE\nU\u223c\u00b5H [f (U)] :=\nZ\nU(d)\nf (U) d\u00b5H(U).\n(2)\nWhen f(U) is a matrix function, the expected value is understood to be the expected value of each\nof its entries.\nWe can prove the following proposition, which shows that any integral involving an unbalanced\nproduct of matrix entries of U and U \u2217must vanish. In the following, we use the notation U \u2297k :=\nU \u2297\u00b7 \u00b7 \u00b7 \u2297U\n|\n{z\n}\nk times\n.1\nProposition 2.\nLet k1, k2 \u2208N. If k1 \u0338= k2, then we have\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k1 \u2297U \u2217\u2297k2\u0003\n= 0.\nProof. We can use the right invariance multiplying U by the unitary exp\n\u0010\ni\n\u03c0\nk1\u2212k2\n\u0011\nI:\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k1 \u2297U \u2217\u2297k2\u0003\n= \u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k1 \u2297U \u2217\u2297k2\u0003\n,\n(3)\nfrom which the claim follows.\n1The significance of investigating tensor powers of unitaries and their adjoints, i.e. U\u2297k \u2297U\u2217\u2297k, becomes evident\nwhen considering applications (Section 9). In brief, within various scenarios, the computation of integrals over the\nHaar measure of the relevant quantity reduces to evaluating integrals of homogeneous polynomials of degree k\nin the matrix elements of U and U\u2217, for some k \u2208N.\nRemarkably, any such polynomial can be expressed as\nTr\u0000AU\u2297k \u2297U\u2217\u2297k\u0001\n, where A is a matrix that contains the coefficients of the polynomial.\n2\n", "4": "This next proposition will be useful in our subsequent calculations.\nIt states that in Haar\nintegrals, we are free to change the variable U with U \u2020.\nProposition 3. For all integrable functions f defined on U(d), we have that:\nE\nU\u223c\u00b5H\n\u0002\nf\n\u0000U \u2020\u0001\u0003\n=\nE\nU\u223c\u00b5H [f (U)] .\n(4)\nProof. Let \u00b5\u2020 be a probability measure defined as\nZ\nU(d)\nf (U) d\u00b5\u2020(U) :=\nZ\nU(d)\nf\n\u0000U \u2020\u0001\nd\u00b5H(U).\n(5)\nWe will now show that \u00b5\u2020 is right and left invariant, which implies that it coincides with \u00b5H\nbecause of the uniqueness of the Haar measure. To this end, let V be a fixed unitary matrix:\nZ\nU(d)\nf (UV ) d\u00b5\u2020(U) =\nZ\nU(d)\nf\n\u0000U \u2020V\n\u0001\nd\u00b5H(U) =\nZ\nU(d)\nf\n\u0000U \u2020V \u2020V\n\u0001\nd\u00b5H(U)\n(6)\n=\nZ\nU(d)\nf\n\u0000U \u2020\u0001\nd\u00b5H(U) =\nZ\nU(d)\nf (U) d\u00b5\u2020(U).\n(7)\nThis shows that \u00b5\u2020 is right-invariant, as claimed. Left-invariance similarly follows.\nA quantity that plays a crucial role in our analysis is the k-th moment operator, where k is a\nnatural number.\nDefinition 4 (k-th Moment operator). The k-th moment operator, with respect to the probability\nmeasure \u00b5H, is defined as M(k)\n\u00b5H : L\n\u0000(Cd)\u2297k\u0001\n\u2192L\n\u0000(Cd)\u2297k\u0001\n:\nM(k)\n\u00b5H(O) :=\nE\nU\u223c\u00b5H\n\u0002\nU \u2297kOU \u2020\u2297k\u0003\n,\n(8)\nfor all operators O \u2208L((Cd)\u2297k).\nBy characterizing the moment operator and computing its matrix elements, we can explicitly\nevaluate integrals over the Haar measure. For example, let O = |i1, . . . , ik\u27e9\u27e8j1, . . . , jk| with ia, ja \u2208\n[d] for all a \u2208[k], we have:\n\u27e8l1, . . . , lk|\nE\nU\u223c\u00b5H\n\u0002\nU \u2297kOU \u2020\u2297k\u0003\n|m1, . . . , mk\u27e9=\nE\nU\u223c\u00b5H\n\u0002\nUl1,i1 \u00b7 \u00b7 \u00b7 Ulk,ikU \u2217\nm1,j1 \u00b7 \u00b7 \u00b7 U \u2217\nmk,jk\n\u0003\n(9)\nwhere la, ma \u2208[d] for all a \u2208[k]. In order to characterize the moment operator, we need to define\nthe k-th order commutant of a set of matrices S.\nDefinition 5 (Commutant). Given S \u2286L\n\u0000Cd\u0001\n, we define its k-th order commutant as\nComm(S, k) := {A \u2208L\n\u0000(Cd)\u2297k\u0001\n:\n\u0002\nA, B\u2297k\u0003\n= 0 \u2200B \u2208S}.\n(10)\nIt is worth noting that Comm(S, k) is a vector subspace.\nIn the following we will show\nthat the moment operator is the orthogonal projector onto the commutant of the unitary group\nComm(U(d), k) with respect to the Hilbert-Schmidt inner product. In order to do so, we first prove\nthe following Lemma.\nLemma 6 (Properties of the moment operator).\nThe moment operator M(k)\n\u00b5H(\u00b7) :=\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k (\u00b7) U \u2020\u2297k\u0003\nhas the following properties:\n1. It is linear, trace-preserving, and self-adjoint with respect to the Hilbert-Schmidt inner prod-\nuct.\n2. For all A \u2208L\n\u0000(Cd)\u2297k\u0001\n, M(k)\n\u00b5H(A) \u2208Comm(U(d), k).\n3. If A \u2208Comm(U(d), k), then M(k)\n\u00b5H(A) = A.\n3\n", "5": "Proof.\n1. Linearity and the trace preserving property follow easily from Definition 4. To show that the\nmoment operator is self-adjoint, we need to prove that:\n\u27e8M(k)\n\u00b5H(A) , B\u27e9HS = \u27e8A, M(k)\n\u00b5H(B)\u27e9HS.\n(11)\nfor all A, B \u2208L\n\u0000(Cd)\u2297k\u0001\n. This follows because:\nTr\n\u0010\nM\u2020\nk(A) B\n\u0011\n=\nE\nU\u223c\u00b5H Tr\n\u0000U \u2297kA\u2020U \u2020\u2297kB\n\u0001\n(12)\n= Tr\n\u0012\nA\u2020\nE\nU\u223c\u00b5H\n\u0002\nU \u2020\u2297kBU \u2297k\u0003\u0013\n(13)\n= Tr\n\u0010\nA\u2020M(k)\n\u00b5H(B)\n\u0011\n,\n(14)\nwhere in the last step we used Proposition 3.\n2. For all V \u2208U(d), we have that:\nV \u2297kM(k)\n\u00b5H(A) =\nE\nU\u223c\u00b5H\nh\n(V U)\u2297k AU \u2020\u2297ki\n=\nE\nU\u223c\u00b5H\nh\nU \u2297kA\n\u0000V \u2020U\n\u0001\u2020\u2297ki\n(15)\n=\nE\nU\u223c\u00b5H\n\u0002\nU \u2297kAU \u2020\u2297k\u0003\nV \u2297k = M(k)\n\u00b5H(A) V \u2297k,\n(16)\nwhere we used the left invariance of the Haar measure.\n3. Since A \u2208Comm(U(d), k), we have:\nM(k)\n\u00b5H(A) =\nE\nU\u223c\u00b5H\n\u0002\nU \u2297kAU \u2020\u2297k\u0003\n=\nE\nU\u223c\u00b5H\n\u0002\nAU \u2297kU \u2020\u2297k\u0003\n= A.\n(17)\nTheorem 7 (Projector onto the commutant). The moment operator M(k)\n\u00b5H(\u00b7) =\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k (\u00b7) U \u2020\u2297k\u0003\nis the orthogonal projector onto the commutant Comm := Comm(U(d), k) with respect to the\nHilbert-Schmidt inner product. In particular, let P1, . . . , Pdim(Comm) be an orthonormal basis of\nComm and let O \u2208L((Cd)\u2297k). Then, we have:\nM(k)\n\u00b5H(O) =\ndim(Comm)\nX\ni=1\n\u27e8Pi, O\u27e9HSPi .\n(18)\nProof. Let us extend the orthonormal basis of the commutant with the orthonormal operators Pi\nfor i \u2208{dim (Comm) + 1, . . . , dim (V )}, where V := L\n\u0000(Cd)\u2297k\u0001\n. This extended basis forms an\northonormal basis for V . Therefore we have:\nM(k)\n\u00b5H(O) =\ndim(V )\nX\ni=1\n\u27e8Pi, M(k)\n\u00b5H(O)\u27e9HSPi\n(19)\n=\ndim(Comm)\nX\ni=1\n\u27e8M(k)\n\u00b5H(Pi) , O\u27e9HSPi +\ndim(V )\nX\ni=dim(Comm)+1\n\u27e8Pi, M(k)\n\u00b5H(O)\u27e9HSPi\n(20)\n=\ndim(Comm)\nX\ni=1\n\u27e8M(k)\n\u00b5H(Pi) , O\u27e9HSPi + 0\n(21)\n=\ndim(Comm)\nX\ni=1\n\u27e8Pi, O\u27e9HSPi,\n(22)\nwhere in the second line we used the fact that the moment operator is self-adjoint (Lemma 6.1),\nin the third line that M(k)\n\u00b5H(O) \u2208Comm (Lemma 6.2) and that Pi with i \u2208{dim (Comm) +\n1, . . . , dim (V )} are in its orthogonal complement, in the fourth line that Pi \u2208Comm for i \u2208\n{1, . . . , dim (Comm)} and Lemma 6.3.\n4\n", "6": "We have just shown that the moment operator is intimately related to the k-order commutant\nof the unitary group, i.e. all the matrices that commute with U \u2297k for any unitary U. A set of\noperations that surely commutes with U \u2297k is if we exchange some tensor factors. For this purpose,\nwe will now define the operators that implement such transformations, namely the permutation\noperators.\nDefinition 8 (Permutation operators). Given \u03c0 \u2208Sk an element of the symmetric group Sk, we\ndefine the permutation matrix Vd(\u03c0) to be the unitary matrix that satisfies:\nVd(\u03c0) |\u03c81\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|\u03c8k\u27e9=\n\f\f\u03c8\u03c0\u22121(1)\n\u000b\n\u2297\u00b7 \u00b7 \u00b7 \u2297\n\f\f\u03c8\u03c0\u22121(k)\n\u000b\n,\n(23)\nfor all |\u03c81\u27e9, . . . , |\u03c8k\u27e9\u2208Cd.\nNote that from this definition it follows that Vd(\u03c3)Vd(\u03c0) = Vd(\u03c3\u03c0) and Vd(\u03c0\u22121) = V \u2020\nd (\u03c0).\nEquivalently, we can write the permutation matrix as:\nVd(\u03c0) =\nX\ni1,...,ik\u2208[d]k\n\f\fi\u03c0\u22121(1), . . . , i\u03c0\u22121(k)\n\u000b\ni1, \u00b7 \u00b7 \u00b7 , ik\n\f\f .\n(24)\nThus, we have the following property:\nVd(\u03c0) (A1 \u2297\u00b7 \u00b7 \u00b7 \u2297Ak) V \u2020\nd (\u03c0) = A\u03c0\u22121(1) \u2297\u00b7 \u00b7 \u00b7 \u2297A\u03c0\u22121(k),\n(25)\nfor A1, . . . , Ak \u2208L\n\u0000Cd\u0001\n.\nA crucial and much celebrated result of representation theory is now that the permutation\noperators characterize all possible matrices in the commutant \u2013 this is the Schur-Weyl duality.\nTheorem 9 (Schur-Weyl duality [53]). The k-th order commutant of the unitary group is the span\nof the permutation operators associated to Sk:\nComm(U(d), k) = span\n\u0010\nVd(\u03c0) : \u03c0 \u2208Sk\n\u0011\n.\n(26)\nWe will omit the proof of this theorem here, except for the cases where k = 1 and k = 2, which\nwe will show later in this section. Interested readers can refer to Refs. [46, 53, 54] for a detailed\nexposition. However we can easily check that span\n\u0010\nVd(\u03c0) : \u03c0 \u2208Sk\n\u0011\n\u2286Comm(U(d), k). To see\nwhy this is true, consider an arbitrary permutation Vd(\u03c0) with \u03c0 \u2208Sk and U \u2208U (d). We have:\nVd(\u03c0)U \u2297k |\u03c81\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|\u03c8k\u27e9= Vd(\u03c0)(U |\u03c81\u27e9) \u2297\u00b7 \u00b7 \u00b7 \u2297(U |\u03c8k\u27e9)\n(27)\n= U\n\f\f\u03c8\u03c0\u22121(1)\n\u000b\n\u2297\u00b7 \u00b7 \u00b7 \u2297U\n\f\f\u03c8\u03c0\u22121(k)\n\u000b\n(28)\n= U \u2297kVd(\u03c0) |\u03c81\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|\u03c8k\u27e9,\n(29)\nfor all |\u03c81\u27e9, . . . , |\u03c8k\u27e9\u2208Cd. Hence we have that\n\u0002\nVd(\u03c0), U \u2297k\u0003\n= 0 for all \u03c0 \u2208Sk, from which the\nclaim follows.\nThe permutation matrices form a basis for the k-th order commutant of the unitary group,\ncapturing its essential structure. However, it is important to note that they are not orthonormal\nwith respect to the Hilbert-Schmidt inner product. Therefore, we cannot directly apply Theorem 7.\nNevertheless, we have an alternative approach that allows us to evaluate the moment operator and,\nconsequently, compute integrals over the Haar measure. The following theorem presents a recipe\nfor accomplishing this task.\nTheorem 10. (Computing moments) Let O \u2208L\n\u0000(Cd)\u2297k\u0001\n. The moment operator can then be\nexpressed as a linear combination of permutation operators:\nE\nU\u223c\u00b5H\n\u0002\nU \u2297kOU \u2020\u2297k\u0003\n=\nX\n\u03c0\u2208Sk\nc\u03c0(O)Vd(\u03c0),\n(30)\nwhere the coefficients c\u03c0(O) can be determined by solving the following linear system of k! equations:\nTr\n\u0010\nV \u2020\nd (\u03c3)O\n\u0011\n=\nX\n\u03c0\u2208Sk\nc\u03c0(O) Tr\n\u0010\nV \u2020\nd (\u03c3)Vd(\u03c0)\n\u0011\nfor all \u03c3 \u2208Sk.\n(31)\nThis system always has at least one solution.\n5\n", "7": "Proof. Equation (30) follows from Lemma 6.2, which states that M(k)\n\u00b5H(O) =\nE\nU\u223c\u00b5H\n\u0002\nU \u2297kOU \u2020\u2297k\u0003\n\u2208\nComm(U(d), k), and from Schur-Weyl duality (Theorem 9).\nTo obtain the linear system of equations, we begin by multiplying both sides of Eq. (30) by\nV \u2020\nd (\u03c3) and taking the trace for all \u03c3 \u2208Sk. This yields:\nX\n\u03c0\u2208Sk\nc\u03c0(O) Tr\n\u0010\nV \u2020\nd (\u03c3)Vd(\u03c0)\n\u0011\n= Tr\n\u0010\nV \u2020\nd (\u03c3)M(k)\n\u00b5H(O)\n\u0011\n(32)\n= Tr\n\u0010\nM(k)\n\u00b5H\n\u0010\nV \u2020\nd (\u03c3)O\n\u0011\u0011\n(33)\n= Tr\n\u0010\nV \u2020\nd (\u03c3)O\n\u0011\n,\n(34)\nwhere in the first equality we used Eq. (30), in the second equality we used that V \u2020\nd (\u03c3) commutes\nwith U \u2297k, and in the last equality we used the fact that the moment operator is trace preserving\n(Lemma 6.1). Since M(k)\n\u00b5H(O) \u2208span (Vd(\u03c0) : \u03c0 \u2208Sk), a solution to this linear system of equations\nalways exists.\nThe previous theorem provides an explicit expression for the coefficients of the moment operator\nin the permutation basis as c\u03c0(O) = P\n\u03c3\u2208Sk (G+)\u03c0,\u03c3 Tr\n\u0000V \u2020\n\u03c3 O\n\u0001\n.\nHere, G is the Gram matrix,\ni.e. that matrix with coefficients G\u03c0,\u03c3 = Tr\n\u0010\nV \u2020\nd (\u03c0)Vd(\u03c3)\n\u0011\n, and G+ is its pseudo-inverse. This\nresult allows us to express the moment operator in terms of the so-called Weingarten coefficients\nWg(\u03c0\u22121\u03c3, d) := (G+)\u03c0,\u03c3 [51, 55\u201357]2, as follows:\nE\nU\u223c\u00b5H\n\u0002\nU \u2297kOU \u2020\u2297k\u0003\n=\nX\n\u03c0,\u03c3\u2208Sk\nWg(\u03c0\u22121\u03c3, d) Tr\n\u0010\nV \u2020\nd (\u03c3)O\n\u0011\nVd(\u03c0).\n(35)\nThe Weingarten coefficients Wg(\u03c0\u22121\u03c3, d) can be written in terms of characters of the symmetric\ngroup. However, we will not explore this aspect here. For reference, see [51, 55, 59, 60].\nThe Gram matrix G has a simple expression in terms of the cycle structure of the permutations,\ngiven by:\nG\u03c0,\u03c3 = Tr\n\u0010\nV \u2020\nd (\u03c0)Vd(\u03c3)\n\u0011\n= Tr\n\u0000Vd(\u03c0\u22121)Vd(\u03c3)\n\u0001\n= Tr\n\u0000Vd(\u03c0\u22121\u03c3)\n\u0001\n= d#cycles(\u03c0\u22121\u03c3),\n(36)\nwhere the last equality follows from the fact that Tr(Vd(\u03c0)) = P\ni1,...,ik\u2208[d]k\n\ni1\n\f\fi\u03c0\u22121(1)\n\u000b\n\u00b7 \u00b7 \u00b7\n\nik\n\f\fi\u03c0\u22121(k)\n\u000b\nand observing that this sum has d#cycles(\u03c0) nonvanishing terms and they are all equal to 1. This\nfact is also evident in the tensor networks notation that we will introduce in section 6.\nProposition 11. For \u03c0 \u2208Sk, the permutation matrices Vd(\u03c0) are linearly independent if k \u2264d,\nbut linearly dependent if k > d.\nProof. Let us consider first the case where k \u2264d. We assume that there exist complex coefficients\n\u03b1\u03c0 \u2208C for all \u03c0 \u2208Sk such that the following equation holds:\nX\n\u03c0\u2208Sk\n\u03b1\u03c0Vd(\u03c0) = 0.\n(37)\nSince, k \u2264d, we can choose k distinct elements i1, . . . , ik \u2208[d] and apply to the right of both sides\nof the previous equation the state |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9, obtaining:\nX\n\u03c0\u2208Sk\n\u03b1\u03c0\n\f\fi\u03c0\u22121(1)\n\u000b\n\u2297\u00b7 \u00b7 \u00b7 \u2297\n\f\fi\u03c0\u22121(k)\n\u000b\n= 0.\n(38)\nFor all \u03c3 \u2208Sk, we multiply to the left by\n\ni\u03c3\u22121(1)\n\f\f \u2297\u00b7 \u00b7 \u00b7 \u2297\n\ni\u03c3\u22121(k)\n\f\f and deduce \u03b1\u03c3 = 0. Thus, we\nhave shown linear independence. If k > d, then consider the operator:\nA =\nX\n\u03c0\u2208Sk\nsgn(\u03c0)Vd(\u03c0).\n(39)\n2The calculation of moments over the Haar measure is often referred to as the Weingarten calculus [57, 58].\n6\n", "8": "Now we show this linear combination is the zero operator, proving linear dependence.\nWe consider the action of A on an arbitrary product basis state |i1\u27e9\u2297\u00b7 \u00b7 \u00b7\u2297|ik\u27e9. Since k > d, at\nleast two tensor factors must have matching entry, i.e., there exist l \u0338= m \u2208[k] such that il = im.\nDue to anti-symmetrization, the output vector has to be the zero vector. In fact, we have:\nA |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9= AVd(\u03c4l,m) |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9\n(40)\n=\nX\n\u03c0\u2208Sk\nsgn(\u03c0)Vd(\u03c0)Vd(\u03c4l,m) |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9\n(41)\n=\nX\n\u03c0\u2208Sk\nsgn(\u03c0)Vd(\u03c0\u03c4l,m) |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9\n(42)\n=\nX\n\u03c0\u2208Sk\nsgn(\u03c0\u03c4 \u22121\nl,m)Vd(\u03c0) |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9\n(43)\n= sgn\n\u0010\n\u03c4 \u22121\nl,m\n\u0011 X\n\u03c0\u2208Sk\nsgn(\u03c0)Vd(\u03c0) |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9\n(44)\n= \u2212A |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9.\n(45)\nTherefore A |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9= 0 and so A = 0.\nIn the following we define the identity permutation operator I and the Flip operator F (also\noften referred to as SWAP operator) which are the permutation operators corresponding to the\nelements of the permutation group S2.\nDefinition 12 (Identity and Flip operators). The identity permutation operator I is defined as\nthe linear operator that leaves any tensor product state |\u03c8\u27e9\u2297|\u03d5\u27e9unchanged, that is:\nI (|\u03c8\u27e9\u2297|\u03d5\u27e9) = |\u03c8\u27e9\u2297|\u03d5\u27e9,\nfor all |\u03c8\u27e9, |\u03d5\u27e9\u2208Cd.\n(46)\nThe Flip operator F is defined as the linear operator that interchanges the order of the tensor\nfactors of any product state |\u03c8\u27e9\u2297|\u03d5\u27e9, that is:\nF (|\u03c8\u27e9\u2297|\u03d5\u27e9) = |\u03d5\u27e9\u2297|\u03c8\u27e9,\nfor all |\u03c8\u27e9, |\u03d5\u27e9\u2208Cd.\n(47)\nWriting the Identity and the Flip in the computational basis, we have:\nI =\nd\nX\ni,j=1\n|i, j\u27e9\u27e8i, j| ,\nF =\nd\nX\ni,j=1\n|i, j\u27e9\u27e8j, i| .\n(48)\nFrom this, it is evident that the Flip operator is Hermitian. Another key property of the Flip\noperator is the swap-trick, which states that for all operators A, B \u2208L(Cd), we have:\nTr((A \u2297B) F) = Tr(AB) .\n(49)\nThis property can be easily verified using the definition of the Flip operator. The swap-trick is\nparticularly useful as it allows us to simplify calculations involving tensor products and permuta-\ntions, and it will be used extensively in the subsequent sections.\nWe now present a corollary of Theorem 10, which plays a crucial role in many calculations\ninvolving Haar integrals in the context of quantum information, as we will see in section 9. In the\nfollowing corollary we assume d > 1 (which makes sense for an n-qubit system, since d = 2n > 1).\nCorollary 13 (First and second moment).\nGiven O \u2208L\n\u0000Cd\u0001\n, we have:\nE\nU\u223c\u00b5H\n\u0002\nUOU \u2020\u0003\n= Tr(O)\nd\nI.\n(50)\nGiven O \u2208L((Cd)\u22972), we have:\nE\nU\u223c\u00b5H\n\u0002\nU \u22972OU \u2020\u22972\u0003\n= cI,OI + cF,OF,\n(51)\nwhere:\ncI,O = Tr(O) \u2212d\u22121 Tr(FO)\nd2 \u22121\nand\ncF,O = Tr(FO) \u2212d\u22121 Tr(O)\nd2 \u22121\n.\n(52)\n7\n", "9": "Proof. According to Theorem (10), we have that the first-order moment operator is proportional\nto the identity operator (the only permutation operator associated with the permutation group of\none element S1), i.e.\nE\nU\u223c\u00b5H\n\u0002\nUOU \u2020\u0003\n= cII,\n(53)\nwith cI \u2208C. Taking the trace to both sides, we deduce that cI = Tr(O)\nd\n.\nMoreover, using Theorem (10), we can see that that the second-order moment operator is a\nlinear combination of the two permutation operators associated with the permutation group S2\nwhich are the identity I and the flip F operator:\nE\nU\u223c\u00b5H\n\u0002\nU \u22972OU \u2020\u22972\u0003\n= cI,OI + cF,OF,\n(54)\nwith cI,O, cF,O \u2208C. To find these numbers, we left-multiply both sides by I and take the trace,\nwhich gives us:\nTr(O) = cI,Od2 + cF,Od,\n(55)\nwhere we used the fact that Tr(I) = d2 and Tr(F) = d. Similarly, by left-multiplying by F and\ntaking the trace, we obtain the linear system of equation:\n(\nTr(O) = cI,Od2 + cF,Od\nTr(FO) = cI,Od + cF,Od2 .\n(56)\nSolving this system, we obtain cI,O = Tr(O)\u2212d\u22121 Tr(OF)\nd2\u22121\nand cF,O = Tr(FO)\u2212d\u22121 Tr(O)\nd2\u22121\n.\nWe have shown how to obtain the formulas for the first and second moment operator by\nutilizing the property that the moment operator lies in the commutant (Lemma 6.2) and that the\ncommutant is the span of the permutation matrices Comm(U(d), k) = span\n\u0010\nVd(\u03c0) : \u03c0 \u2208Sk\n\u0011\nfor\nk = 1, 2, which are particular instances of Schur-Weyl duality. Now, we will provide explicit proofs\nfor these cases.\nExample 14.\nComm(U(d), k = 1) = span\n\u0010\nI\n\u0011\n,\n(57)\nComm(U(d), k = 2) = span\n\u0010\nI, F\n\u0011\n.\n(58)\nProof. Consider an element A \u2208Comm(U(d), k = 1). In the canonical basis decomposition, A can\nbe written as:\nA =\nd\nX\ni,j=1\nAi,j |i\u27e9\u27e8j| =\nd\nX\ni=1\nAi,i |i\u27e9\u27e8i| +\nd\nX\ni,k=1\nj\u0338=i\nAi,j |i\u27e9\u27e8j| ,\n(59)\nwhere Ai,j := \u27e8i| A |j\u27e9. Since A is in the commutant, then UAU \u2020 = A holds for all unitary matrices\nU. By choosing a unitary U that sends vector |k\u27e9to its negative |k\u27e9\u2192\u2212|k\u27e9while leaving the\nother basis vectors unchanged, it follows that, for all k \u0338= l \u2208[d], the term Ak,l |k\u27e9\u27e8l| is equal\nto its negative, and hence, Ak,l = 0. Therefore, we have that if A is in the commutant, then\nA = Pd\ni=1 Ai,i |i\u27e9\u27e8i|. Now, for all k \u0338= l \u2208[d], by choosing a unitary matrix U that exchanges\nthe vectors |k\u27e9and |l\u27e9while leaving the other basis states unchanged, we derive that all diagonal\nelements Ak,k should be equal each other for all k \u2208[d]. Thus, we have A = c Pd\ni=1 |i\u27e9\u27e8i| = cI, where\nc := A1,1. Therefore an operator can only be in the commutant if and only if it is proportional to\nthe Identity I. Thus, we have shown the first formula we aimed to prove.\n8\n", "10": "Consider now Q \u2208Comm(U(d), k = 2). Q can be decomposed as:\nQ =\nd\nX\ni,j,k,l=1\nQi,j;k,l |i, j\u27e9\u27e8k, l| ,\n(60)\nwhere Qi,j;k,l := \u27e8i, j| Q |k, l\u27e9. Since Q is in the commutant, then U \u22972QU \u2020\u22972 = Q holds for all\nunitary matrices U. For all sets of indices {i, j} \u0338= {k, l}, let m be a index such that m \u2208{i, j} but\nm /\u2208{k, l} or vice versa (there is at least one). By choosing unitaries that send a basis vector to its\nnegative, while leaving unchanged the other basis vectors, it follows that, for all {i, j} \u0338= {k, l} \u2208[d],\nthe terms Qi,j;k,l |i, j\u27e9\u27e8k, l| are equal to their negatives, and hence, Qi,j;k,l = 0. Therefore, if Q is\nin the commutant, it must have the following form:\nQ =\nd\nX\ni=1\nQi,i;i,i |i, i\u27e9\u27e8i, i| +\nd\nX\ni,j=1\ni\u0338=j\nQi,j;i,j |i, j\u27e9\u27e8i, j| +\nd\nX\ni,j=1\ni\u0338=j\nQi,j;j,i |i, j\u27e9\u27e8j, i| .\n(61)\nAgain, by choosing a unitary matrix U that exchanges the vectors |i, j\u27e9with a different vector\n|k, l\u27e9while leaving the other basis states unchanged, and using U \u22972QU \u2020\u22972 = Q, we derive that:\nQ = a\nd\nX\ni=1\n|i, i\u27e9\u27e8i, i| + b\nd\nX\ni,j=1\ni\u0338=j\n|i, j\u27e9\u27e8i, j| + c\nd\nX\ni,j=1\ni\u0338=j\n|i, j\u27e9\u27e8j, i|\n(62)\nwhere a := Q1,1;1,1, b := Q1,2;1,2 and c := Q1,2;2,1. Note that we can also write Q as:\nQ = (a \u2212b \u2212c)\nd\nX\ni=1\n|i, i\u27e9\u27e8i, i| + b I + c F.\n(63)\nSince I and F commute with U \u22972 for all U \u2208U(d), then Q is in the commutant if and only if\n(a \u2212b \u2212c) Pd\ni=1 |i, i\u27e9\u27e8i, i| is also in the commutant.\nWe now show that Pd\ni=1 |i, i\u27e9\u27e8i, i| is not in the commutant, which implies that Q is in the\ncommutant if and only if (a \u2212b \u2212c) = 0, i.e., if and only if Q is a linear combination of only I\nand F. To see this, suppose that Pd\ni=1 |i, i\u27e9\u27e8i, i| is in the commutant. Then, it should commute\nwith U \u22972 for all unitaries U. We can choose the (Discrete Fourier Transform) unitary U such that\nU |k\u27e9=\n1\n\u221a\nd\nPd\nj=1 \u03c9(j\u22121)(k\u22121) |j\u27e9, where \u03c9 := exp\n\u0000i 2\u03c0\nd\n\u0001\n, and obtain the following relation:\nd\nX\ni=1\n|i, i\u27e9\u27e8i, i| =\nd\nX\ni=1\nU \u22972 |i, i\u27e9\u27e8i, i| U \u22972\u2020.\n(64)\nHowever, computing the expectation value on both sides of the previous equation over the state\n|1, 1\u27e9leads to 1 = 1\nd, which is false for every d > 1 (for d = 1, the relation to prove immediately\nfollows). Therefore, we conclude that Pd\ni=1 |i, i\u27e9\u27e8i, i| is not in the commutant, and hence Q is in\nthe commutant if and only if Q is a linear combination of I and F.\n4\nSymmetric subspace\nIn this section, we introduce the symmetric subspace, which plays a crucial role when analyzing\nHaar random states.\nFor a more in-depth analysis, see [61].\nThe symmetric subspace can be\ndefined as the set of states |\u03c8\u27e9in (Cd)\u2297k that are invariant under permutations of their constituent\nsubsystems. Formally, we define the symmetric subspace as follows:\nDefinition 15 (Symmetric subspace).\nSymk(Cd) :=\nn\n|\u03c8\u27e9\u2208(Cd)\u2297k : Vd(\u03c0) |\u03c8\u27e9= |\u03c8\u27e9\u2200\u03c0 \u2208Sk\no\n.\n(65)\n9\n", "11": "To facilitate our analysis, we also define the operator P (d,k)\nsym\nas follows:\nP (d,k)\nsym := 1\nk!\nX\n\u03c0\u2208Sk\nVd(\u03c0).\n(66)\nTheorem 16 (Projector on Symk(Cd)). P (d,k)\nsym\nis the orthogonal projector on the symmetric sub-\nspace Symk(Cd).\nProof. We start by observing that Vd(\u03c0)P (d,k)\nsym = P (d,k)\nsym :\nVd(\u03c0)P (d,k)\nsym = 1\nk!\nX\n\u03c3\u2208Sk\nVd(\u03c0)Vd(\u03c3) = 1\nk!\nX\n\u03c3\u2208Sk\nVd(\u03c0\u03c3) = 1\nk!\nX\n\u03c3\u2208Sk\nVd(\u03c3) = P (d,k)\nsym .\n(67)\nUsing this, we can show that P (d,k)2\nsym\n= P (d,k)\nsym :\nP (d,k)2\nsym\n= 1\nk!\nX\n\u03c0\u2208Sk\nVd(\u03c0)P (d,k)\nsym = 1\nk!\nX\n\u03c0\u2208Sk\nP (d,k)\nsym = P (d,k)\nsym .\n(68)\nFurthermore, we have P (d,k)\u2020\nsym\n= P (d,k)\nsym :\nP (d,k)\u2020\nsym\n= 1\nk!\nX\n\u03c0\u2208Sk\nV \u2020\nd (\u03c0) = 1\nk!\nX\n\u03c0\u2208Sk\nVd(\u03c0\u22121) = 1\nk!\nX\n\u03c0\u2208Sk\nVd(\u03c0) = P (d,k)\nsym .\n(69)\nTherefore, P (d,k)\nsym is an orthogonal projector. Moreover Im\n\u0010\nP (d,k)\nsym\n\u0011\n\u2286Symk(Cd): in fact P (d,k)\nsym |\u03c8\u27e9\u2208\nSymk(Cd) for all |\u03c8\u27e9\u2208(Cd)\u2297k, since Vd(\u03c0)P (d,k)\nsym |\u03c8\u27e9= P (d,k)\nsym |\u03c8\u27e9for all \u03c0 \u2208Sk, where we used\nagain that Vd(\u03c0)P (d,k)\nsym = P (d,k)\nsym . Moreover if |\u03c8\u27e9\u2208Symk(Cd), then\nP (d,k)\nsym |\u03c8\u27e9= 1\nk!\nX\n\u03c0\u2208Sk\nVd(\u03c0) |\u03c8\u27e9= 1\nk!\nX\n\u03c0\u2208Sk\n|\u03c8\u27e9= |\u03c8\u27e9.\n(70)\nTherefore we also have Symk(Cd) \u2286Im\n\u0010\nP (d,k)\nsym\n\u0011\nand so Symk(Cd) = Im\n\u0010\nP (d,k)\nsym\n\u0011\n.\nWe now turn to computing the dimension of the symmetric subspace.\nTheorem 17 (Dimension of the symmetric subspace).\nTr\n\u0010\nP (d,k)\nsym\n\u0011\n= dim\n\u0000Symk(Cd)\n\u0001\n=\n\u0012k + d \u22121\nk\n\u0013\n.\n(71)\nProof. The first equality follows by the fact that P (d,k)\nsym is the orthogonal projector onto Symk(Cd).\nNow we observe that:\nSymk(Cd) = Im\n\u0010\nP (d,k)\nsym\n\u0011\n= span\n\u0010\nP (d,k)\nsym |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9: \u2200i1, . . . , ik \u2208[d]\n\u0011\n.\n(72)\nTo count the number of vectors in this set that are linearly independent, we make the following\nobservation. Suppose |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9and |j1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|jk\u27e9are two computational basis vectors with\ni1, j1, . . . , ik, jk \u2208[d] such that the sets {i1, . . . , ik} and {j1, . . . , jk} have the same number nm of\nelements that are equal to m for every m \u2208[d]. Then there exists a unitary operator Vd(\u03c0) such\nthat Vd(\u03c0) |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9= |j1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|jk\u27e9. Furthermore, since P (d,k)\nsym Vd(\u03c0) = P (d,k)\nsym , it follows\nthat P (d,k)\nsym |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9= P (d,k)\nsym |j1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|jk\u27e9.\nTherefore, we can define the set of vectors |n1, . . . , nd\u27e9, where n1, . . . , nd \u2208[k] with n1 + \u00b7 \u00b7 \u00b7 +\nnd = k, as follows:\n|n1, . . . , nd\u27e9:= P (d,k)\nsym |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9,\n(73)\nwhere |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9is any computational basis vector such that, for each m \u2208[d], there are nm\ndistinct j \u2208[k] such that ij = m. It is easy to see that these vectors are orthogonal, and hence\nlinearly independent. Therefore, the dimension of the symmetric subspace is equal to the number\nof linearly independent vectors in the set |n1, . . . , nd\u27e9defined earlier. This is equal to the number\nof ways of deciding how to assign k indices between d possible labels, which is\n\u0000k+d\u22121\nk\n\u0001\n.\n10\n", "12": "Next, we introduce the anti-symmetric subspace.\nDefinition 18 (Anti-symmetric subspace). The anti-symmetric subspace is the set:\nASymk(Cd) :=\nn\n|\u03c8\u27e9\u2208(Cd)\u2297k : Vd(\u03c0) |\u03c8\u27e9= sgn (\u03c0) |\u03c8\u27e9\u2200\u03c0 \u2208Sk\no\n,\n(74)\nwhere sgn (\u03c3) denotes the sign of a permutation \u03c3 \u2208Sk.\nSimilarly as before, we can define the operator:\nP (d,k)\nasym := 1\nk!\nX\n\u03c0\u2208Sk\nsgn (\u03c0) Vd(\u03c0).\n(75)\nand prove the following theorem:\nTheorem 19. The operator P (d,k)\nasym is the orthogonal projector on the anti-symmetric subspace\nASymk(Cd).\nProof. We have:\nVd(\u03c3)P (d,k)\nasym = 1\nk!\nX\n\u03c0\u2208Sk\nsgn (\u03c0) Vd(\u03c3)Vd(\u03c0) = 1\nk!\nX\n\u03c0\u2208Sk\nsgn (\u03c0) Vd(\u03c3\u03c0)\n(76)\n= 1\nk!\nX\n\u03c0\u2208Sk\nsgn\n\u0000\u03c3\u22121\u03c0\n\u0001\nVd(\u03c0) = sgn\n\u0000\u03c3\u22121\u0001\nP (d,k)\nasym\n(77)\n= sgn (\u03c3) P (d,k)\nasym.\n(78)\nSimilarly, P (d,k)\nasymVd(\u03c3) = sgn (\u03c3) P (d,k)\nasym. Using this, we can show that P (d,k)2\nasym = P (d,k)\nasym:\nP 2\nasym = 1\nk!\nX\n\u03c0\u2208Sk\nsgn (\u03c0) Vd(\u03c0)P (d,k)\nasym = 1\nk!\nX\n\u03c0\u2208Sk\n(sgn (\u03c0))2 P (d,k)\nasym = P (d,k)\nasym.\n(79)\nWe also have P (d,k)\u2020\nasym = P (d,k)\nasym:\nP (d,k)\u2020\nasym = 1\nk!\nX\n\u03c0\u2208Sk\nsgn (\u03c0) V \u2020\nd (\u03c0) = 1\nk!\nX\n\u03c0\u2208Sk\nsgn (\u03c0) Vd(\u03c0\u22121) = 1\nk!\nX\n\u03c0\u2208Sk\nsgn\n\u0000\u03c0\u22121\u0001\nVd(\u03c0\u22121)\n(80)\n= 1\nk!\nX\n\u03c0\u2208Sk\nsgn (\u03c0) Vd(\u03c0) = P (d,k)\nasym.\n(81)\nWe can show that Im\n\u0010\nP (d,k)\nasym\n\u0011\n\u2286ASymk(Cd) as follows: for all |\u03c8\u27e9\u2208(Cd)\u2297k, we have P (d,k)\nasym |\u03c8\u27e9\u2208\nASymk(Cd), since Vd(\u03c0)P (d,k)\nasym |\u03c8\u27e9= sgn (\u03c0) P (d,k)\nasym |\u03c8\u27e9for all \u03c0 \u2208Sk, where we used again that\nVd(\u03c0)P (d,k)\nasym = sgn (\u03c0) P (d,k)\nasym. Moreover, we can also show that ASymk(Cd) \u2286Im\n\u0010\nP (d,k)\nasym\n\u0011\n. In fact,\nif |\u03c8\u27e9\u2208ASymk(Cd), then we have:\nP (d,k)\nasym |\u03c8\u27e9= 1\nk!\nX\n\u03c0\u2208Sk\nsgn (\u03c0) Vd(\u03c0) |\u03c8\u27e9= 1\nk!\nX\n\u03c0\u2208Sk\n(sgn (\u03c0))2 |\u03c8\u27e9= |\u03c8\u27e9.\n(82)\nTherefore, we have shown that Im\n\u0010\nP (d,k)\nasym\n\u0011\n= ASymk(Cd), which implies that P (d,k)\nasym is the\northogonal projector on the anti-symmetric subspace ASymk(Cd).\nNext, we compute the dimension of the anti-symmetric subspace.\nProposition 20 (Dimension of the anti-symmetric subspace). If d \u2265k, we have:\nTr\n\u0010\nP (d,k)\nasym\n\u0011\n= dim\n\u0000ASymk(Cd)\n\u0001\n=\n\u0012d\nk\n\u0013\n,\n(83)\notherwise Tr\n\u0010\nP (d,k)\nasym\n\u0011\n= 0.\n11\n", "13": "Proof. First, we have:\nASymk(Cd) = Im\n\u0010\nP (d,k)\nasym\n\u0011\n= span\n\u0010\nP (d,k)\nasym |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9: \u2200i1, . . . , ik \u2208[d]\n\u0011\n.\n(84)\nTo count the number of linearly independent vectors P (d,k)\nasym |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9, we observe that\nif there are at least two tensor factors of |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9with matching entry i.e. there exist\nl \u0338= m \u2208[k] such that il = im, then:\nP (d,k)\nasym |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9= 0.\n(85)\nThis because:\nP (d,k)\nasym |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9= P (d,k)\nasymVd(\u03c4l,m) |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9\n(86)\n= sgn (\u03c4l,m) P (d,k)\nasym |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9\n(87)\n= \u2212P (d,k)\nasym |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9,\n(88)\nwhere in the second equality we used P (d,k)\nasymVd(\u03c4l,m) = sgn (\u03c4l,m) P (d,k)\nasym (as shown in the proof of\nTheorem 19). Therefore, i1, . . . , ik must all be distinct for P (d,k)\nasym |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9to be nonzero.\nThis also implies that if d < k, then Tr\n\u0010\nP (d,k)\nasym\n\u0011\n= 0.\nTherefore, we now focus on the case\nd \u2265k.\nIf for all m \u2208[d], there exist two vectors |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9and |j1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|jk\u27e9with\ni1, j1 . . . , ik, jk \u2208[d] such that both sets, {i1, . . . , ik} and {j1, . . . , jk}, contain nm \u2208{0, 1} elements\nequal to m, then there exists a permutation Vd(\u03c0) such that Vd(\u03c0) |i1\u27e9\u2297\u00b7 \u00b7 \u00b7\u2297|ik\u27e9= |j1\u27e9\u2297\u00b7 \u00b7 \u00b7\u2297|jk\u27e9.\nSince P (d,k)\nasymVd(\u03c0) = sgn (\u03c0) P (d,k)\nasym, we have P (d,k)\nasym |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9= sgn (\u03c0) P (d,k)\nasym |j1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|jk\u27e9,\nand hence, P (d,k)\nasym |i1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|ik\u27e9and P (d,k)\nasym |j1\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|jk\u27e9are linearly dependent.\nThus, taking n1, . . . , nd \u2208{0, 1} with n1 + \u00b7 \u00b7 \u00b7 + nd = k, we define |n1, . . . , nd\u27e9as P (d,k)\nasym |i1\u27e9\u2297\n\u00b7 \u00b7 \u00b7\u2297|ik\u27e9, where |i1\u27e9\u2297\u00b7 \u00b7 \u00b7\u2297|ik\u27e9is any computational basis vector such that, for each m \u2208[d], there\nexist nm elements j \u2208[k] such that ij = m. It is easy to see that such vectors are orthogonal and\nhence independent. Therefore, the dimension is given by the number of such independent vectors,\nwhich is equal to the number of ways to choose an unordered subset of k elements from a set of d\nelements, which is\n\u0000d\nk\n\u0001\n.\nWe will now present a proposition that establishes a relationship between the symmetric and\nanti-symmetric subspaces.\nProposition 21. We have P (d,k)\u2020\nasym P (d,k)\nsym\n= 0. In particular P (d,k)\nasym and P (d,k)\nsym\nare orthogonal with\nrespect to the Hilbert-Schmidt inner product.\nProof. We have:\nP (d,k)\u2020\nasym P (d,k)\nsym = P (d,k)\nasymP (d,k)\nsym = 1\nk!\nX\n\u03c0\u2208Sk\nsgn (\u03c0) Vd(\u03c0)P (d,k)\nsym =\n \n1\nk!\nX\n\u03c0\u2208Sk\nsgn (\u03c0)\n!\nP (d,k)\nsym = 0,\n(89)\nwhere we used that Vd(\u03c0)P (d,k)\nsym = P (d,k)\nsym\nand that\n1\nk!\nP\n\u03c0\u2208Sk sgn (\u03c0) = 0 since:\n1\nk!\nX\n\u03c0\u2208Sk\nsgn (\u03c0) = 1\nk!\nX\n\u03c0\u2208Sk\nsgn (\u03c4\u03c0) = sgn (\u03c4) 1\nk!\nX\n\u03c0\u2208Sk\nsgn (\u03c0) = \u22121\nk!\nX\n\u03c0\u2208Sk\nsgn (\u03c0) ,\n(90)\nwhere \u03c4 is any permutation.\nNote that, for k = 2 (and d > 1), we have that, dim\n\u0000Sym2(Cd)\n\u0001\n+ dim\n\u0000ASym2(Cd)\n\u0001\n=\n\u0000d+1\n2\n\u0001\n+\n\u0000d\n2\n\u0001\n= d2, this implies that (Cd)\u22972 = Sym2(Cd) \u2295ASym2(Cd).\nSince P (d,2)\nsym and P (d,2)\nasym are both linear combinations of permutations, they commute with U \u22972\nfor all unitaries U. Consequently, they are elements of a basis for the commutant Comm(U(d), k =\n2) and they are orthogonal to each other. Furthermore, the commutant can have at most dimension\n12\n", "14": "two, since it is spanned by the identity and Flip operators (Example 14). Thus, P (d,k)\nsym\nand P (d,k)\nasym\nform an orthogonal basis for the commutant.\nSince the moment operator is the orthogonal projector onto the commutant (Theorem 7), we\ncan derive the formula for the second-order moment operator (already derived in Corollary 13),\nusing P (d,k)\nsym\nand P (d,k)\nasym as the basis. We express the moment operator as:\nE\nU\u223c\u00b5H\n\u0002\nU \u22972OU \u2020\u22972\u0003\n=\nD\nP (d,2)\nsym\n\r\r\rP (d,2)\nsym\n\r\r\r\n2\n, O\nE\nHS\nP (d,2)\nsym\n\r\r\rP (d,2)\nsym\n\r\r\r\n2\n+\nD\nP (d,2)\nasym\n\r\r\rP (d,2)\nasym\n\r\r\r\n2\n, O\nE\nHS\nP (d,2)\nasym\n\r\r\rP (d,2)\nasym\n\r\r\r\n2\n(91)\n=\nTr\n\u0010\nP (d,2)\nsym O\n\u0011\nTr\n\u0010\nP (d,2)\nsym\n\u0011 P (d,2)\nsym +\nTr\n\u0010\nP (d,2)\nasymO\n\u0011\nTr\n\u0010\nP (d,2)\nasym\n\u0011 P (d,2)\nasym\n(92)\n= Tr(O) + Tr(FO)\nd(d + 1)\n\u0012I + F\n2\n\u0013\n+ Tr(O) \u2212Tr(FO)\nd(d \u22121)\n\u0012I \u2212F\n2\n\u0013\n(93)\n= Tr(O) \u2212d\u22121 Tr(FO)\nd2 \u22121\nI + Tr(OF) \u2212d\u22121 Tr(O)\nd2 \u22121\nF,\n(94)\nwhere in the first equality we used the fact that P (d,2)\nsym and P (d,2)\nasym are an orthonormal basis for the\ncommutant, we utilized the fact that P (d,2)\nsym and P (d,2)\nasym are orthogonal projectors (meaning that they\nsquare to themselves and are Hermitian), in the third equality we substituted P (d,2)\nsym\n= 1\n2 (I + F)\nand P (d,2)\nasym = 1\n2 (I \u2212F) along with their respective traces to arrive at the desired formula.\nNow we show a theorem that states that for all quantum states |\u03d5\u27e9in a d-dimensional Hilbert\nspace, the moment operator of |\u03d5\u27e9\u27e8\u03d5|\u2297k is a uniform linear combination of permutations, which\ncan be written in terms of the projector on the symmetric subspace P (d,k)\nsym .\nTheorem 22. Let d, k \u2208N. For all |\u03d5\u27e9\u2208Cd, the moment operator is a uniform linear combination\nof permutations:\nE\nU\u223c\u00b5H\nh\nU \u2297k |\u03d5\u27e9\u27e8\u03d5|\u2297k U \u2020\u2297ki\n=\nP (d,k)\nsym\nTr\n\u0010\nP (d,k)\nsym\n\u0011,\n(95)\nwith P (d,k)\nsym = 1\nk!\nP\n\u03c0\u2208Sk Vd(\u03c0) and Tr\n\u0010\nP (d,k)\nsym\n\u0011\n= dim\n\u0000Symk(Cd)\n\u0001\n=\n\u0000k+d\u22121\nk\n\u0001\n.\nProof. For all \u03c3 \u2208Sk, we left-multiply both sides of Eq. (30) by Vd(\u03c3\u22121) and obtain:\nVd(\u03c3\u22121)M(k)\n\u00b5H\n\u0010\n(|\u03d5\u27e9\u27e8\u03d5|)\u2297k\u0011\n=\nX\n\u03c0\u2208Sk\nc\u03c0Vd(\u03c3\u22121)Vd(\u03c0),\n(96)\nwhere M(k)\n\u00b5H\n\u0010\n(|\u03d5\u27e9\u27e8\u03d5|)\u2297k\u0011\n:=\nE\nU\u223c\u00b5H\nh\u0000U |\u03d5\u27e9\u27e8\u03d5| U \u2020\u0001\u2297ki\n. Using the fact that Vd(\u03c3\u22121) commutes with\nU \u2297k for all unitaries U and that Vd(\u03c3\u22121) |\u03d5\u27e9\u2297k = |\u03d5\u27e9\u2297k, the LHS is:\nVd(\u03c3\u22121)M(k)\n\u00b5H\n\u0010\n(|\u03d5\u27e9\u27e8\u03d5|)\u2297k\u0011\n= M(k)\n\u00b5H\n\u0010\n(|\u03d5\u27e9\u27e8\u03d5|)\u2297k\u0011\n.\n(97)\nThe RHS is:\nX\n\u03c0\u2208Sk\nc\u03c0Vd(\u03c3\u22121)Vd(\u03c0) =\nX\n\u03c0\u2208Sk\nc\u03c0Vd(\u03c3\u22121\u03c0) =\nX\n\u03c0\u2208Sk\nc\u03c3\u03c0Vd(\u03c0).\n(98)\nTherefore, we have:\nM(k)\n\u00b5H\n\u0010\n(|\u03d5\u27e9\u27e8\u03d5|)\u2297k\u0011\n=\nX\n\u03c0\u2208Sk\nc\u03c3\u03c0Vd(\u03c0).\n(99)\nAssuming d > 1, the previous equation implies that all the coefficients must be the same, i.e.,\nc\u03c3 = cI for all \u03c3 \u2208Sk (note that this can be shown without using linear independence of the\n13\n", "15": "permutation matrices, but just using that the permutation matrices are all different linear operators\nfor d > 13). Hence, we have:\nM(k)\n\u00b5H\n\u0010\n(|\u03d5\u27e9\u27e8\u03d5|)\u2297k\u0011\n= cI\n X\n\u03c0\u2208Sk\nVd(\u03c0)\n!\n= cIk! P (d,k)\nsym .\n(100)\nThus, taking the trace, we get:\ncI =\n1\nk! Tr\n\u0010\nP (d,k)\nsym\n\u0011 = 1\nk!\n1\n\u0000k+d\u22121\nk\n\u0001.\n(101)\nDefinition 23 (Haar measure on states). Given a state |\u03d5\u27e9in Cd, we denote\nE\n|\u03c8\u27e9\u223c\u00b5H\nh\n|\u03c8\u27e9\u27e8\u03c8|\u2297ki\n:=\nE\nU\u223c\u00b5H\nh\nU \u2297k |\u03d5\u27e9\u27e8\u03d5|\u2297k U \u2020\u2297ki\n.\n(102)\nNote that the right invariance of the Haar measure implies that the definition of\nE\n|\u03c8\u27e9\u223c\u00b5H\nh\n|\u03c8\u27e9\u27e8\u03c8|\u2297ki\ndoes not depend on the choice of |\u03d5\u27e9. Moreover, due to Theorem 22, we have:\nE\n|\u03c8\u27e9\u223c\u00b5H\nh\n|\u03c8\u27e9\u27e8\u03c8|\u2297ki\n=\nP (d,k)\nsym\nTr\n\u0010\nP (d,k)\nsym\n\u0011.\n(103)\n5\nVectorization formalism\nWe define the linear operator vec : L\n\u0000Cd\u0001\n\u2192(Cd)\u22972 as follows: for all i, j \u2208[d], we set vec(|i\u27e9\u27e8j|) :=\n|i\u27e9\u2297|j\u27e9.\nThis means that if A \u2208L\n\u0000Cd\u0001\nis written as A = Pd\ni,j=1 Ai,j |i\u27e9\u27e8j|, then vec(A) =\nPd\ni,j=1 Ai,j |i\u27e9\u2297|j\u27e9. This justifies the name \u201cvectorization\u201d, as the linear map vec(\u00b7) sends the\nd \u00d7 d matrix A to the d2-dimensional vector vec(A). Importantly, vec(\u00b7) is a bijection, meaning\nthat for all |v\u27e9\u2208(Cd)\u22972 there exists a unique A \u2208L\n\u0000Cd\u0001\nsuch that |v\u27e9= vec(A) (in fact, one can\ntake A = Pd\ni,j=1 \u27e8i, j|v\u27e9|i\u27e9\u27e8j|) and vice versa.\nIt is often convenient to express vec(A) in the form vec(A) = A \u2297I |\u2126\u27e9, where |\u2126\u27e9:= vec(I) =\nPd\ni=1 |i, i\u27e9is the vectorization of the identity matrix, i.e., the non-normalized maximally entangled\nstate. To simplify the notation, we can use the shorthand |A\u27e9\u27e9:= vec(A). Another useful property\nis that the canonical inner product between two vectorized operators A and B is equal to their\nHilbert-Schmidt scalar product, i.e., \u27e8\u27e8A|B\u27e9\u27e9= \u27e8A, B\u27e9HS, where \u27e8\u27e8A|B\u27e9\u27e9:= vec(A)\u2020 vec(B) is the\ncanonical inner product. Using the so-called transpose-trick A \u2297I |\u2126\u27e9= I \u2297AT |\u2126\u27e9, we have the\nABC-rule:\n|ABC\u27e9\u27e9= A \u2297CT |B\u27e9\u27e9,\n(104)\nfor all A, B, C \u2208L\n\u0000Cd\u0001\n.\nConsider a linear superoperator \u03a6: L(Cd) \u2192L(Cd). It is worth noting that the map |\u03a6(X)\u27e9\u27e9\nis linear with respect to |X\u27e9\u27e9for all |X\u27e9\u27e9\u2208(Cd)\u22972. This linearity implies the existence of a matrix\nvec(\u03a6) \u2208L((Cd)\u22972) associated with this linear transformation. In other words, we can express the\naction of \u03a6 on an operator X as follows:\n|\u03a6(X)\u27e9\u27e9= vec(\u03a6)|X\u27e9\u27e9\nfor all X \u2208L(Cd).\n(105)\nIt is important to mention that for all linear superoperators \u03a6 : L(Cd) \u2192L(Cd) there exists\na set of matrices {Ai}d2\ni=1, {Bi}d2\ni=1 \u2208L(Cd) such that \u03a6(X) = Pd2\ni=1 AiXB\u2020\ni . To see why, observe\nthat:\n\u03a6(X) = Tr2\n\u0000I \u2297XT \u03c1\u03a6\n\u0001\n,\n(106)\n3To see it explicitly, one can choose the permutation \u03c3, which fixes all indices except for two, which are inter-\nchanged.\n14\n", "16": "where \u03c1\u03a6 := \u03a6\u2297I(|\u2126\u27e9\u27e8\u2126|) = Pd\ni,j=1 \u03a6(|i\u27e9\u27e8j|)\u2297|i\u27e9\u27e8j| is the so-called Choi matrix of \u03a6, I : L(Cd) \u2192\nL(Cd) is the identity channel and Tr2 indicates the partial trace with respect to the second tensor\nspace. Now, performing a singular value decomposition (SVD) on \u03c1\u03a6, we have:\n\u03c1\u03a6 =\nd2\nX\ni=1\n\u03bbi |ui\u27e9\u27e8vi| =\nd2\nX\ni=1\n|vec(Ai)\u27e9\u27e8vec(Bi)| =\nd2\nX\ni=1\nAi \u2297I |\u2126\u27e9\u27e8\u2126| B\u2020\ni \u2297I,\n(107)\nwhere \u03bbi \u22650, |ui\u27e9and |vi\u27e9are respectively the singular values and the column vectors associated\nto the SVD unitaries, and we defined Ai := \u221a\u03bbivec\u22121(|ui\u27e9) and Bi := \u221a\u03bbivec\u22121(|vi\u27e9). Substituting\nthis expression back into (106), we obtain the desired claim. (Note that if \u03a6 is completely positive,\nthen its Choi matrix is positive, so we can perform an eigendecomposition instead of an SVD, and\narrive at the same conclusion as before, with Bi = Ai.)\nUsing the ABC-rule (104), we can rewrite \u03a6(X) = Pd2\ni=1 AiXB\u2020\ni as |\u03a6(X)\u27e9\u27e9= Pd2\ni=1 Ai \u2297\nB\u2217\ni |X\u27e9\u27e9, which implies:\nvec(\u03a6) =\nd2\nX\ni=1\nAi \u2297B\u2217\ni .\n(108)\nAdditionally, it is often advantageous to express the moment operator M(k)\n\u00b5H(O) =\nE\nU\u223c\u00b5H\n\u0002\nU \u2297kOU \u2020\u2297k\u0003\nin its vectorized form:\n|M(k)\n\u00b5H(O)\u27e9\u27e9=\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k \u2297U \u2217\u2297k\u0003\n|O\u27e9\u27e9.\n(109)\nDefinition 24 (Vectorized moment operator). We define the vectorized moment operator M(k)\n\u00b5H \u2208\nL\n\u0000(Cd)\u22972k\u0001\nas:\nM(k)\n\u00b5H := vec(M(k)\n\u00b5H) =\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k \u2297U \u2217\u2297k\u0003\n.\n(110)\nProposition 7 has a vectorized version as follows:\nProposition 25. Let the commutant space be Comm := Comm(U(d), k). Let {Pi}dim(Comm)\ni=1\nbe\nelements of an orthonormal basis of Comm with respect to the Hilbert-Schmidt inner product. Then,\nwe have:\nM(k)\n\u00b5H :=\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k \u2297U \u2217\u2297k\u0003\n=\ndim(Comm)\nX\ni=1\n|Pi\u27e9\u27e9\u27e8\u27e8Pi|.\n(111)\nMoreover, we have Tr\n\u0010\nM(k)\n\u00b5H\n\u0011\n= dim (Comm).\nProof. Vectorizing the equation derived in Proposition 7, we have:\nM(k)\n\u00b5H|O\u27e9\u27e9= |M(k)\n\u00b5H(O)\u27e9\u27e9=\ndim(Comm)\nX\ni=1\n\u27e8Pi, O\u27e9HS|Pi\u27e9\u27e9=\ndim(Comm)\nX\ni=1\n|Pi\u27e9\u27e9\u27e8\u27e8Pi|O\u27e9\u27e9.\n(112)\nSince the previous equation holds for all O \u2208L\n\u0000(Cd)\u2297k\u0001\nand therefore for all |O\u27e9\u27e9\u2208(Cd)\u22972k, we\nhave the thesis.\nBuilding upon the previous proposition and the fact that Tr\n\u0010\nM(k)\n\u00b5H\n\u0011\n=\nE\nU\u223c\u00b5H |Tr(U)|2k, we can\nderive the following equation:\nE\nU\u223c\u00b5H |Tr(U)|2k = dim(Comm(U(d), k)).\n(113)\nIn the case where d \u2265k (which is the case we are most interested in), we find that\nE\nU\u223c\u00b5H |Tr(U)|2k =\nk!. This is due to the fact that the k-th order commutant of the unitary group corresponds to the\n15\n", "17": "span of the permutation operators (as a consequence of Schur-Weyl duality, see Theorem 9), which\nare linearly independent for d \u2265k (as stated in Proposition 11).\nIt is also worth noting that the vectorized moment operator M(k)\n\u00b5H is an orthogonal projector,\nsince M(k)2\n\u00b5H\n= M(k)\n\u00b5H (due to the right invariance of the Haar measure) and M(k)\u2020\n\u00b5H = M(k)\n\u00b5H (due to\nProposition 3).\nFurthermore, as an exercise, we provide an alternative proof of Theorem 7 based on vectoriza-\ntion.\nTheorem 26 (Projector onto the commutant). The moment operator M(k)\n\u00b5H(\u00b7) =\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k (\u00b7) U \u2020\u2297k\u0003\nis the orthogonal projector onto the commutant Comm := Comm(U(d), k) with respect to the\nHilbert-Schmidt inner product. In particular, let P1, . . . , Pdim(Comm) be an orthonormal basis of\nComm and let O \u2208L((Cd)\u2297k). Then, we have:\nM(k)\n\u00b5H(O) =\ndim(Comm)\nX\ni=1\n\u27e8Pi, O\u27e9HSPi .\n(114)\nProof. Since the vectorized moment operator M(k)\n\u00b5H is an orthogonal projector, it admits an eigende-\ncomposition with eigenvalues 0 and 1 and eigenvectors {vi}r\ni=1, where r is the rank of the projector\nM(k)\n\u00b5H:\nM(k)\n\u00b5H := vec(M(k)\n\u00b5H) =\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k \u2297U \u2217\u2297k\u0003\n=\nr\nX\ni=1\n|vi\u27e9\u27e8vi| =\nr\nX\ni=1\n|Pi\u27e9\u27e9\u27e8\u27e8Pi|,\n(115)\nwhere we used the fact that for each |vi\u27e9, there exists Pi \u2208L((Cd)\u2297k) such that |vi\u27e9= |Pi\u27e9\u27e9for\neach i \u2208[r]. We note that Pi are operators in Comm(U(d), k). This can be shown as follows:\nPi = vec\u22121(|Pi\u27e9\u27e9) = vec\u22121\u0010\nvec(M(k)\n\u00b5H)|Pi\u27e9\u27e9\n\u0011\n= M(k)\n\u00b5H(Pi) \u2208Comm(U(d), k),\n(116)\nwhere in the last step we used Lemma 6.2. Furthermore, {Pi}r\ni=1 form an orthonormal set with\nrespect to the Hilbert-Schmidt inner product:\n\u27e8Pi, Pj\u27e9HS = \u27e8\u27e8Pi|Pj\u27e9\u27e9= \u27e8vi|vj\u27e9= \u03b4i,j\n\u2200i, j \u2208[r].\n(117)\nMoreover, they constitute a basis for Comm since, for all A \u2208Comm, we have |A\u27e9\u27e9= M(k)\n\u00b5H|A\u27e9\u27e9=\nPr\ni=1\u27e8\u27e8Pi|A\u27e9\u27e9|Pi\u27e9\u27e9, which implies that A \u2208span ({Pi}r\ni=1). Hence, the rank of M(k)\n\u00b5H is equal to the\ndimension of the commutant, i.e., r = dim (Comm). Consequently, we can conclude the proof by\nnoting that for all O \u2208L\n\u0000(Cd)\u2297k\u0001\n:\nM(k)\n\u00b5H(O) = vec\u22121\u0010\nvec(M(k)\n\u00b5H)|O\u27e9\u27e9\n\u0011\n= vec\u22121\n r\nX\ni=1\n|Pi\u27e9\u27e9\u27e8\u27e8Pi|O\u27e9\u27e9\n!\n=\nr\nX\ni=1\n\u27e8Pi, O\u27e9HSPi.\n(118)\nTo address the issue of the permutation matrices not being orthonormal, we can introduce a\nvectorized version of Eq.(35) that provides a concise representation of the moment operator.\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k \u2297U \u2217\u2297k\u0003\n=\nX\n\u03c0,\u03c3\u2208Sk\nWg(\u03c0\u22121\u03c3, d)|Vd(\u03c0)\u27e9\u27e9\u27e8\u27e8Vd(\u03c3)|.\n(119)\nProof. Using Eq.(35), we have:\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k \u2297U \u2217\u2297k\u0003\n|O\u27e9\u27e9=\nE\nU\u223c\u00b5H|U \u2297kOU \u2020\u2297k\u27e9\u27e9\n(120)\n=\nX\n\u03c0,\u03c3\u2208Sk\nWg\n\u0000\u03c0\u22121\u03c3, d\n\u0001\n|Vd(\u03c0)\u27e9\u27e9Tr\n\u0010\nV \u2020\nd (\u03c3)O\n\u0011\n(121)\n=\nX\n\u03c0,\u03c3\u2208Sk\nWg\n\u0000\u03c0\u22121\u03c3, d\n\u0001\n|Vd(\u03c0)\u27e9\u27e9\u27e8\u27e8Vd(\u03c3)|O\u27e9\u27e9.\n(122)\nSince this equation holds for all vectors |O\u27e9\u27e9in (Cd)\u22972k, we conclude the proof.\n16\n", "18": "We can now write the moment operator equations for k = 1 and k = 2 presented in Example 13\nin their vectorized form:\nE\nU\u223c\u00b5H [U \u2297U \u2217] = 1\nd|I\u27e9\u27e9\u27e8\u27e8I|,\n(123)\nE\nU\u223c\u00b5H\n\u0002\nU \u22972 \u2297U \u2217\u22972\u0003\n=\n1\nd2 \u22121\n\u0014\n|I\u27e9\u27e9\u27e8\u27e8I| \u22121\nd|I\u27e9\u27e9\u27e8\u27e8F| \u22121\nd|F\u27e9\u27e9\u27e8\u27e8I| + |F\u27e9\u27e9\u27e8\u27e8F|\n\u0015\n.\n(124)\nProof. For Equation (123), we have:\nE\nU\u223c\u00b5H [U \u2297U \u2217] |O\u27e9\u27e9=\nE\nU\u223c\u00b5H|UOU \u2020\u27e9\u27e9= Tr(O)\nd\n|I\u27e9\u27e9= 1\nd|I\u27e9\u27e9\u27e8\u27e8I|O\u27e9\u27e9,\n(125)\nwhere we used \u27e8\u27e8I|O\u27e9\u27e9= Tr(IO) = Tr(O). For Equation (124), we have:\nE\nU\u223c\u00b5H\n\u0002\nU \u22972 \u2297U \u2217\u22972\u0003\n|O\u27e9\u27e9=\nE\nU\u223c\u00b5H|U \u22972OU \u2020\u22972\u27e9\u27e9\n(126)\n= Tr(O) \u2212d\u22121 Tr(FO)\nd2 \u22121\n|I\u27e9\u27e9+ Tr(FO) \u2212d\u22121 Tr(O)\nd2 \u22121\n|F\u27e9\u27e9\n(127)\n=\n1\nd2 \u22121\n\u0014\n|I\u27e9\u27e9\u27e8\u27e8I|O\u27e9\u27e9\u22121\nd|I\u27e9\u27e9\u27e8\u27e8F|O\u27e9\u27e9\u22121\nd|F\u27e9\u27e9\u27e8\u27e8I|O\u27e9\u27e9+ |F\u27e9\u27e9\u27e8\u27e8F|O\u27e9\u27e9\n\u0015\n,\n(128)\nwhere we used that F\u2020 = F, \u27e8\u27e8I|O\u27e9\u27e9= Tr(O) and \u27e8\u27e8F|O\u27e9\u27e9= Tr(FO).\nEquations like the ones presented above can be effectively visualized and manipulated using\nTensor Network diagrams.\n6\nTensor network diagrams\nTensor Networks provide a graphical representation that simplifies the understanding and analysis\nof tensor operations [62]. In these diagrams, tensors are represented as boxes (or nodes), and\ntensor contractions are represented as connections between boxes. To illustrate the concept, we\nuse specific diagrams for ket-states, bra-states, and matrices. A ket-state |\u03c8\u27e9\u2208Cd is represented\nwith a box and a leg as follows:\n|\u03c8\u27e9\n.\n(129)\nSimilarly, a bra-state \u27e8\u03c8| is represented as:\n\u27e8\u03c8|\n.\n(130)\nMatrices, such as A \u2208L\n\u0000Cd\u0001\n, are depicted like boxes with one leg in and one leg out as:\nA\n.\n(131)\nIn particular, the identity matrix I \u2208L\n\u0000Cd\u0001\nis simply represented by a line:\n.\n(132)\n17\n", "19": "The trace Tr(A) of an operator A \u2208L\n\u0000Cd\u0001\nis denoted as:\nA\nA\n=\n.\n(133)\nGiven A, B \u2208L\n\u0000Cd\u0001\n, their product AB is represented by placing the box representing matrix A\non the left side of the box representing matrix B. This can be illustrated as follows:\nA\nB\n.\n(134)\nThe transpose AT of the matrix A is depicted by:\nA\nAT\n=\n.\n(135)\nGiven A \u2208L\n\u0000Cd\u0001\nand B \u2208L\n\u0010\nCd\u2032\u0011\n, their tensor product A \u2297B is denoted by arranging the box\nrepresenting matrix B below the box representing matrix A:\nA\nB\n.\n(136)\nA \u2208L\n\u0000Cd\u0001\n\u2297L\n\u0010\nCd\u2032\u0011\nis represented with a box that has two (different) legs on the left and two\non the right:\nA\n.\n(137)\nThe partial trace with respect to the second tensor space Tr2 (A) is denoted as:\nA\n,\n(138)\nand similarly for the partial trace with respect to the first tensor space.\n18\n", "20": "Particularly important is the non-normalized maximally entangled state |\u2126\u27e9= |I\u27e9\u27e9, which is\nthe vectorization of the identity and is denoted as:\n=\n|\ud835\udd40\u27e9\u27e9\n=\n.\n(139)\nGiven an operator A \u2208L\n\u0000Cd\u0001\n, its vectorization |A\u27e9\u27e9= A \u2297I |\u2126\u27e9is represented as:\nA\nAT\n=\n|A\u27e9\u27e9\n=\n,\n(140)\nwhere the equality is due to the transpose-trick |A\u27e9\u27e9= A \u2297I |\u2126\u27e9= I \u2297AT |\u2126\u27e9. In Tensor Network\nnotation, the diagram below makes it clear that \u27e8\u27e8A|B\u27e9\u27e9= Tr\n\u0000A\u2020B\n\u0001\n:\n,\n(141)\nas well as the ABC-rule (104):\n|ABC\u27e9\u27e9=\nB\nA\nC\nB\nA\n=\nCT\n|B\u27e9\u27e9\n=\nA\nCT\n, (142)\nwhere A, B, C \u2208L\n\u0000Cd\u0001\n.\nIn accordance with the Definition 23, a permutation matrix Vd(\u03c0), with \u03c0 \u2208Sk, maps the\ntensor product state |\u03c81\u27e9\u2297\u00b7 \u00b7 \u00b7 \u2297|\u03c8k\u27e9to the tensor product state\n\f\f\u03c8\u03c0\u22121(1)\n\u000b\n\u2297\u00b7 \u00b7 \u00b7 \u2297\n\f\f\u03c8\u03c0\u22121(k)\n\u000b\n:\nVd(\u03c0)\n|\u03c81\u27e9\n|\u03c8\u03c0\u22121(1)\u27e9\n|\u03c8\u03c0\u22121(2)\u27e9\n|\u03c8\u03c0\u22121(k)\u27e9\n|\u03c82\u27e9\n|\u03c8k\u27e9\n=\n,\n(143)\nand it can be represented by a diagram with lines connecting the tensor space of the i-th element\non the right with the the \u03c0(i)-th element on the left for each i \u2208[k]. For example, the identity\noperator I and the Flip operator F are represented as follows:\n\ud540\n=\n,\n\ud53d\n=\n.\n(144)\n19\n", "21": "The composition of permutations can be visualized by placing the corresponding diagrams next to\neach other. When considering a matrix A \u2208L\n\u0000Cd\u0001\n\u2297L\n\u0010\nCd\u2032\u0011\n, its vectorization is represented as:\nA\n.\n(145)\nFor instance, the vectorization of the identity operator I and the Flip operator F are represented\nas:\n\ud540\n=\n,\n\ud53d\n=\n.\n(146)\nUsing this diagrammatic notation, we can express Eq.(123)\nE\nU\u223c\u00b5H [U \u2297U \u2217] = 1\nd|I\u27e9\u27e9\u27e8\u27e8I| in Tensor\nNetwork notation as:\nEU\u223c\u00b5H\n\uf8ee\n\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\nU\nU*\n\uf8f9\n\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb\n= 1\nd\n.\n(147)\nSimilarly, Eq.(124)\nE\nU\u223c\u00b5H\n\u0002\nU \u22972 \u2297U \u2217\u22972\u0003\n=\n1\nd2\u22121\n\u0002\n|I\u27e9\u27e9\u27e8\u27e8I| \u22121\nd|I\u27e9\u27e9\u27e8\u27e8F| \u22121\nd|F\u27e9\u27e9\u27e8\u27e8I| + |F\u27e9\u27e9\u27e8\u27e8F|\n\u0003\ncan be rep-\nresented as:\nEU\u223c\u00b5H\n\uf8ee\n\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\n\uf8f9\n\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb\n=\n1\nd2 \u22121\n\uf8ee\n\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\n\u22121\nd\n\u22121\nd\n+\n\uf8f9\n\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb\n.\n(148)\nUsing the diagrammatic notation, we can easily see that:\nE\nU\u223c\u00b5H\n\u0002\nUi1,j1U \u2217\ni2,j2\n\u0003\n= 1\nd\u03b4i1,i2\u03b4j1,j2,\n(149)\nwhere we used\nE\nU\u223c\u00b5H\n\u0002\nUi1,j1U \u2217\ni2,j2\n\u0003\n= \u27e8i1, i2|\nE\nU\u223c\u00b5H [U \u2297U \u2217] |j1, j2\u27e9and \u03b4a,b represents the Kronecker\ndelta. Similarly:\nE\nU\u223c\u00b5H\n\u0002\nUi1,j1Ui2,j2U \u2217\ni3,j3U \u2217\ni4,j4\n\u0003\n=\n1\nd2 \u22121\n\u0014\n\u03b4i1,i3\u03b4i2,i4\u03b4j1,j3\u03b4j2,j4 \u22121\nd\u03b4i1,i3\u03b4i2,i4\u03b4j1,j4\u03b4j2,j3\n\u0015\n(150)\n+\n1\nd2 \u22121\n\u0014\n\u22121\nd\u03b4i1,i4\u03b4i2,i3\u03b4j1,j3\u03b4j2,j4 + \u03b4i1,i4\u03b4i2,i3\u03b4j1,j4\u03b4j2,j3\n\u0015\n,\n(151)\n20\n", "22": "where we used\nE\nU\u223c\u00b5H\n\u0002\nUi1,j1Ui2,j2U \u2217\ni3,j3U \u2217\ni4,j4\n\u0003\n= \u27e8i1, i2, i3, i4|\nE\nU\u223c\u00b5H\n\u0002\nU \u22972 \u2297U \u2217\u22972\u0003\n|j1, j2, j3, j4\u27e9. An-\nother useful relation is the partial-swap-trick Tr2(A \u2297B F) = AB, which can be visualized as:\nB\nA\n=\nA\nB\n,\n(152)\nand thus we have the swap-trick formula Tr(A \u2297B F) = Tr(AB). Similarly we also have Tr1(A \u2297\nB F) = BA.\nMore generally, consider the cyclic permutation \u03c0cyc \u2208Sk, which corresponds to the unitary\noperator:\nVd(\u03c0cyc) =\nX\ni1,...,ik\u2208[d]\n|i2, . . . , ik, i1\u27e9\u27e8i1, i2, . . . , ik| .\n(153)\nThis unitary operator can be depicted diagrammatically as:\n=\nVd(\u03c0cyc)\n.\n(154)\nNow, we want to calculate Tr2,...,n (A1 \u2297\u00b7 \u00b7 \u00b7 \u2297AnVd(\u03c0cyc)), and we will show that it simplifies\nto A1 \u00b7 \u00b7 \u00b7 An. We can verify this through direct calculation using resolutions of identities:\nTr2,...,n (A1 \u2297\u00b7 \u00b7 \u00b7 \u2297Ak Vd(\u03c0cyc)) =\nX\ni1,...,ik\u2208[d]\nTr2,\u00b7\u00b7\u00b7 ,k (A1 \u2297\u00b7 \u00b7 \u00b7 \u2297Ak |i2, . . . , ik, i1\u27e9\u27e8i1, i2, . . . , ik|)\n=\nX\ni1,...,ik\u2208[d]\nA1 |i2\u27e9\u27e8i1| \u27e8i2| A2 |i3\u27e9\u27e8i3| A3 |i4\u27e9\u00b7 \u00b7 \u00b7 \u27e8ik| Ak |i1\u27e9\n=\nX\ni1,i2\u2208[d]\nA1 |i2\u27e9\u27e8i1| \u27e8i2| A2A3 \u00b7 \u00b7 \u00b7 Ak |i1\u27e9= A1 \u00b7 \u00b7 \u00b7 Ak,\n(155)\nAlternatively, we can represent this calculation diagrammatically as:\nA1\nA2\nA3\nAk\nVd(\u03c0cyc)\n=\nAk\nA1\n.\n(156)\nHence, we have the generalized swap-trick, known as the cyclic-permutation-trick:\nTr(A1 \u2297\u00b7 \u00b7 \u00b7 \u2297Ak Vd(\u03c0cyc)) = Tr(A1 \u00b7 \u00b7 \u00b7 Ak).\n(157)\n21\n", "23": "7\nUnitary designs\nGenerating Haar random unitaries on a quantum computer can be a computationally expensive\ntask, since most unitaries require an exponential number of elementary gates with respect to the\nnumber of qubits [3, 39, 63] to be implemented.\nHowever, for many applications in quantum\ninformation, only low-order moments of the Haar measure are needed [1, 10, 13\u201315, 21, 40]. This\nmotivates the definition of unitary k-designs [64], which are distributions of unitaries that match\nthe moments of the Haar measure up to the k-th order, where k \u2208N. As we will mention later,\ngenerating unitary k-designs can be done efficiently in the number of elementary gates.\nDefinition 27 (Unitary k-design). Let \u03bd be a probability distribution defined over a set of unitaries\nS \u2286U(d). The distribution \u03bd is unitary k-design if and only if:\nE\nV \u223c\u03bd\n\u0002\nV \u2297kOV \u2020\u2297k\u0003\n=\nE\nU\u223c\u00b5H\n\u0002\nU \u2297kOU \u2020\u2297k\u0003\n,\n(158)\nfor all O \u2208L\n\u0000(Cd)\u2297k\u0001\n.\nFor instance, consider a distribution \u03bd where the set of unitaries S is discrete and each unitary\nhas an equal probability of being chosen. In this case, we have:\nE\nV \u223c\u03bd\n\u0002\nV \u2297kOV \u2020\u2297k\u0003\n= 1\n|S|\nX\nV \u2208S\nV \u2297kOV \u2020\u2297k.\n(159)\nAn equivalent way to define a unitary k-design is to relate the vectorized moment operator of the\ndistribution \u03bd to that of the Haar measure \u00b5H. Specifically, we have the following:\nObservation 28. A probability distribution \u03bd is a unitary k-design if and only if:\nE\nV \u223c\u03bd\n\u0002\nV \u2297k \u2297V \u2217\u2297k\u0003\n=\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k \u2297U \u2217\u2297k\u0003\n.\n(160)\nProof. By taking the vectorization to both sides of Eq.(158), we have:\nE\nV \u223c\u03bd\n\u0002\nV \u2297k \u2297V \u2217\u2297k\u0003\n|O\u27e9\u27e9=\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k \u2297U \u2217\u2297k\u0003\n|O\u27e9\u27e9.\n(161)\nNow Eq.(160) follows by observing that for all |\u03c8\u27e9\u2208(Cd)\u22972k there exists O \u2208L\n\u0000(Cd)\u2297k\u0001\nsuch\nthat |O\u27e9\u27e9= |\u03c8\u27e9. Similarly, the converse holds.\nObservation 29. If \u03bd is a (k + 1)-design, then \u03bd is also a k-design.\nProof. Let O = O\u2032 \u2297I\nd where O\u2032 \u2208L\n\u0000(Cd)\u2297k\u0001\n. The claim follows by applying the Definition 27\nwith such defined O and taking the partial trace with respect to the (k + 1)-th tensor product\nspace.\nIt is also useful to define the following quantity, the frame potential [65], which provides another\nway to verify if a probability distribution is a k-design.\nDefinition 30 (Frame potential). Let \u03bd be a probability distribution defined over the set of unitaries\nS \u2286U(d). For a given k \u2208N, we define the k-frame potential, denoted as F(k)\n\u03bd\n, as follows:\nF(k)\n\u03bd\n:=\nE\nU,V \u223c\u03bd\nh\f\fTr\n\u0000UV \u2020\u0001\f\f2ki\n.\n(162)\nAs we will show in Proposition 34, a probability distribution \u03bd is a k-design if and only if its k-\nframe potential coincides with that of the Haar measure \u00b5H. Thus, given a probability distribution\n\u03bd and a set of unitaries S, we can compute the frame potential F(k)\n\u03bd\nand compare it with that of\nthe Haar measure to determine whether \u03bd is a k-design or not. It is also useful to define the notion\nof k-invariant distribution.\n22\n", "24": "Definition 31 (k-invariant measure). Let \u03bd be a probability distribution defined over a set of\nunitaries S \u2286U(d). \u03bd is k-invariant if and only if, for any polynomial p(U) of degree \u2264k in the\nmatrix elements of U and U \u2217, it holds\nE\nU\u223c\u03bd [ p (U)] = E\nU\u223c\u03bd [ p (UV )] = E\nU\u223c\u03bd [ p (V U)] ,\n(163)\nfor all V \u2208S.\nWe begin by making the following observation, which will be useful for computing the frame\npotential of the Haar measure \u00b5H.\nLemma 32. Let \u03bd be a probability distribution defined over a set of unitaries S \u2286U(d). If \u03bd is\nk-invariant, then we have:\nF(k)\n\u03bd\n= dim (Comm(S, k)) ,\n(164)\nwhere Comm(S, k) is defined in Definition 5.\nProof. By (right) k-invariance we have:\nF(k)\n\u03bd\n=\nE\nU,V \u223c\u03bd\nh\f\fTr\n\u0000UV \u2020\u0001\f\f2ki\n= E\nU\u223c\u03bd\nh\n|Tr(U)|2ki\n.\n(165)\nTherefore:\nF(k)\n\u03bd\n= E\nU\u223c\u03bd\nh\n|Tr(U)|2ki\n= E\nU\u223c\u03bd\nh\nTr(U)k Tr(U \u2217)ki\n= Tr\n\u0010\nE\nU\u223c\u03bd\n\u0002\nU \u2297k \u2297U \u2217\u2297k\u0003\u0011\n.\n(166)\nWe can conclude the proof by observing that Tr\n\u0010\nE\nU\u223c\u03bd\n\u0002\nU \u2297k \u2297U \u2217\u2297k\u0003\u0011\n= dim (Comm(S, k)), ac-\ncording to Proposition 25. Note that although the proof of Proposition 25 was given for the Haar\nmeasure on the unitary group, it applies equally to any k-invariant measure.\nIt is worth noting that the left and right invariance properties, and therefore Lemma 32, hold\nfor any uniform probability distribution \u03bd defined over a subgroup of unitaries S.\nIn the following lemma, we show that the difference between the frame potential of a probability\ndistribution \u03bd (not necessarily k-invariant) and that of the Haar measure \u00b5H can be represented\nby the squared 2-norm of the difference between their vectorized moment operator.\nLemma 33 (Frame potential difference). Let F(k)\n\u03bd\nand F(k)\n\u00b5H be the frame potentials of the proba-\nbility distribution \u03bd and the Haar measure \u00b5H, respectively. Then, we have:\nF(k)\n\u03bd\n\u2212F(k)\n\u00b5H =\n\r\r\r\r E\nV \u223c\u03bd\n\u0002\nV \u2297k \u2297V \u2217\u2297k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k \u2297U \u2217\u2297k\u0003\r\r\r\r\n2\n2\n.\n(167)\nProof. Let M(k)\n\u00b5H :=\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k \u2297U \u2217\u2297k\u0003\nand M(k)\n\u03bd\n:=\nE\nV \u223c\u03bd\n\u0002\nU \u2297k \u2297U \u2217\u2297k\u0003\n.\nFirst, we note that M(k)\u2020\n\u00b5H = M(k)\n\u00b5H due to Proposition 3. Furthermore, because of the invariance\nof the Haar measure, we have M(k)2\n\u00b5H\n= M(k)\n\u00b5H and M(k)\n\u03bd M(k)\n\u00b5H = M(k)\n\u03bd M(k)\u2020\n\u00b5H = M(k)\n\u00b5H. Thus, by using\nthese properties, we obtain:\n\r\r\rM(k)\n\u03bd\n\u2212M(k)\n\u00b5H\n\r\r\r\n2\n2 = Tr\n\u0014\u0010\nM(k)\n\u03bd\n\u2212M(k)\n\u00b5H\n\u0011\u2020 \u0010\nM(k)\n\u03bd\n\u2212M(k)\n\u00b5H\n\u0011\u0015\n(168)\n= Tr\nh\nM(k)\u2020\n\u03bd\nM(k)\n\u03bd\ni\n+ Tr\nh\nM(k)\u2020\n\u00b5H M(k)\n\u00b5H\ni\n\u2212Tr\nh\nM(k)\u2020\n\u03bd\nM(k)\n\u00b5H\ni\n\u2212Tr\nh\nM(k)\u2020\n\u00b5H M(k)\n\u03bd\ni\n(169)\n= Tr\nh\nM(k)\u2020\n\u03bd\nM(k)\n\u03bd\ni\n\u2212Tr\nh\nM(k)\n\u00b5H\ni\n(170)\n= Tr\nh\nM(k)\n\u03bd M(k)\u2020\n\u03bd\ni\n\u2212Tr\nh\nM(k)\n\u00b5HM(k)\u2020\n\u00b5H\ni\n.\n(171)\nWe can conclude by observing that for \u00b5 = \u00b5H and \u00b5 = \u03bd we have:\nTr\nh\nM(k)\n\u00b5 M(k)\u2020\n\u00b5\ni\n=\nE\nV,U\u223c\u00b5 Tr\n\u0002\n(UV \u2020)\u2297k \u2297(UV \u2020)\u2217\u2297k\u0003\n=\nE\nV,U\u223c\u00b5\nh\f\fTr\n\u0000UV \u2020\u0001\f\f2ki\n= F(k)\n\u00b5 .\n(172)\n23\n", "25": "It follows from the previous Lemma that showing that a distribution \u03bd is a k-design can be\nachieved by computing its frame potential and comparing it with that of the Haar measure \u00b5H. This\nis due to the fact that if the two frame potentials coincide, the difference between their vectorized\nmoment operators in 2-norm must be zero, hence they must be equal (which is an equivalent unitary\ndesign definition because of Observation 28). We can restate the result explicitly as follows:\nProposition 34 (Frame potential k-design condition). We have:\nF(k)\n\u03bd\n\u2265F(k)\n\u00b5H = dim(span(Vd(\u03c0) : \u03c0 \u2208Sk)).\n(173)\nMoreover, the equality holds if and only if \u03bd is a k-unitary design.\nIn particular, if k \u2264d, then dim(span(Vd(\u03c0) : \u03c0 \u2208Sk)) = k!.\nProof. By Lemma 33, Lemma 32 and Schur-Weyl duality 9, we have:\nF(k)\n\u03bd\n\u2265F(k)\n\u00b5H = dim (Comm(U(d), k)) = dim (span(Vd(\u03c0) : \u03c0 \u2208Sk)) .\n(174)\nMoreover, by Proposition 11, we have that if k \u2264d, then the number of linearly independent\npermutation matrices is k!.\nBy utilizing this result, we can derive a straightforward lower bound on the cardinality of a\ndiscrete set S of unitaries necessary to form a k-design. To establish this bound, let us consider\nthe frame potential F(k)\n\u03bd\nassociated with the uniform distribution \u03bd over the discrete set S. We\ncan then deduce that:\nF(k)\n\u03bd\n=\n1\n|S|2\n|S|\nX\ni,j=1\n\f\f\fTr\n\u0010\nUiU \u2020\nj\n\u0011\f\f\f\n2k\n\u2265\n1\n|S|2\n|S|\nX\ni=1\n\f\f\fTr\n\u0010\nUiU \u2020\ni\n\u0011\f\f\f\n2k\n= 1\n|S|d2k.\n(175)\nFurthermore, considering the fact that \u03bd constitutes a k-design (with k \u2264d), by the previous\nproposition, we have that F(k)\n\u03bd\n= k!. This implies that the cardinality of the set S must satisfy\n|S| \u2265d2k\nk! . Consequently, if we are considering an n-qubit system where the Hilbert space dimension\nis d = 2n, the cardinality of S must grow at least exponentially with the number of qubits. For a\nmore comprehensive analysis of lower bounds of k-design, we recommend referring to the following\nreferences [39, 59, 65, 66].\nThe following proposition provides equivalent definitions of unitary k-design:\nProposition 35 (Equivalent definitions of unitary k-design.). Let \u03bd be a probability distribution\nover a set of unitaries S \u2286U. Then, \u03bd is a unitary k-design if and only if:\n1.\nE\nU\u223c\u03bd\n\u0002\nU \u2297kOU \u2020\u2297k\u0003\n=\nE\nU\u223c\u00b5H\n\u0002\nU \u2297kOU \u2020\u2297k\u0003\nfor all O \u2208L\n\u0000(Cd)\u2297k\u0001\n.\n2.\nE\nV \u223c\u03bd\n\u0002\nV \u2297k \u2297V \u2217\u2297k\u0003\n=\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k \u2297U \u2217\u2297k\u0003\n.\n3.\nF(k)\n\u03bd\n= dim (Comm(U(d), k)).\n4.\nE\nV \u223c\u03bd[ p(V ) ] =\nE\nU\u223c\u00b5H[ p(U) ] for all polynomials p(U) homogeneous of degree k in the matrix\nelements of U and homogeneous of degree k in the matrix elements of U \u2217.\nProof. The equivalence between 1. and 2. is shown in Observation 28 and the one between 2.\nand 3. is shown in Proposition 34. To show that 2. implies 4., we observe that any homogeneous\npolynomial p(U) of degree k in the elements of U and in the elements of U \u2217can be written\nas p(U) = Tr\n\u0002\nAU \u2297k \u2297U \u2217\u2297k\u0003\nfor a matrix A \u2208L\n\u0000(Cd)\u22972k\u0001\nwith entries the coefficients of the\npolynomial. Similarly, to show that 4. implies 2., we note that, for all matrices A \u2208L\n\u0000(Cd)\u22972k\u0001\n,\npA(U) := Tr\n\u0002\nAU \u2297k \u2297U \u2217\u2297k\u0003\nis a homogeneous polynomial of degree k in both the elements of U\nand U \u2217. Therefore we have\nTr\n\u0010\nA E\nV \u223c\u03bd\n\u0002\nV \u2297k \u2297V \u2217\u2297k\u0003\u0011\n= Tr\n\u0012\nA\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k \u2297U \u2217\u2297k\u0003\u0013\nfor all A \u2208L\n\u0000(Cd)\u22972k\u0001\n,\n(176)\nwhich implies the point 2.\n24\n", "26": "Moreover, if \u03bd is a uniform distribution over a set of unitaries S which forms a group, then\nif dim (Comm(S, k)) = dim (Comm(U(d), k)), then, by Proposition 32 and Proposition 34, \u03bd is a\nk-unitary design.\nNow we turn to the definition of k-designs for distributions over sets of states, which are known\nas state k-designs or spherical k-designs [67].\nDefinition 36 (State k-design). Let \u03b7 be a probability distribution over a set of states S \u2286Cd.\nThe distribution \u03b7 is said to be a state k-design (or also spherical k-designs) if and only if:\nE\n|\u03c8\u27e9\u223c\u03b7\nh\n|\u03c8\u27e9\u27e8\u03c8|\u2297ki\n=\nE\n|\u03c8\u27e9\u223c\u00b5H\nh\n|\u03c8\u27e9\u27e8\u03c8|\u2297ki\n.\n(177)\nA unitary k-design \u03bd induces a k-state design for the probability distribution over states U |\u03c80\u27e9,\nwhere U is drawn from \u03bd and |\u03c80\u27e9is fixed. This can be seen by setting O = (|\u03c80\u27e9\u27e8\u03c80|)\u2297k in\nDefinition 27.\nSimilarly to the unitary k-design case, we can define the so-called state frame potential.\nDefinition 37 (State frame potential). The state frame potential is defined as:\nF(k,\u03b7)\nstate :=\nE\n|\u03c8\u27e9,|\u03d5\u27e9\u223c\u03b7\nh\n|\u27e8\u03c8|\u03d5\u27e9|2ki\n.\n(178)\nWe now state a proposition that relates the state frame potential to k-designs:\nProposition 38 (State frame potential design). Let \u03b7 be a probability distribution over a set of\nstates S \u2286Cd. Then:\nF(k,\u03b7)\nstate \u2265\n\u0000dim\n\u0000Symk(Cd)\n\u0001\u0001\u22121 ,\n(179)\nwhere dim\n\u0000Symk(Cd)\n\u0001\n=\n\u0000d+k\u22121\nk\n\u0001\n. Equality holds if and only if \u03b7 is a k-state design.\nProof. We denote A(k)\n\u00b5H :=\nE\n|\u03c8\u27e9\u223c\u00b5H\nh\n|\u03c8\u27e9\u27e8\u03c8|\u2297ki\nand A(k)\n\u03b7\n:=\nE\n|\u03c8\u27e9\u223c\u03b7\nh\n|\u03c8\u27e9\u27e8\u03c8|\u2297ki\n. We have:\n\r\r\rA(k)\n\u03b7\n\u2212A(k)\n\u00b5H\n\r\r\r\n2\n2 = Tr\n\u0014\u0010\nA(k)\n\u03b7\n\u2212A(k)\n\u00b5H\n\u00112\u0015\n(180)\n= Tr\n\u0014\u0010\nA(k)\n\u03b7\n\u00112\u0015\n+ Tr\n\u0014\u0010\nA(k)\n\u00b5H\n\u00112\u0015\n\u22122 Tr\nh\nA(k)\n\u03b7 A(k)\n\u00b5H\ni\n(181)\n=\nE\n|\u03c8\u27e9,|\u03d5\u27e9\u223c\u03b7\nh\n|\u27e8\u03c8|\u03d5\u27e9|2ki\n+ Tr\n\u0014\u0010\nA(k)\n\u00b5H\n\u00112\u0015\n\u22122 Tr\nh\nA(k)\n\u03b7 A(k)\n\u00b5H\ni\n,\n(182)\nwhere in the second equality we used cyclicity of the trace. Additionally, we have:\nTr\n\u0014\u0010\nA(k)\n\u00b5H\n\u00112\u0015\n= Tr\n\uf8ee\n\uf8f0\n \nP (d,k)\nsym\ndim (Symk(Cd))\n!2\uf8f9\n\uf8fb\n(183)\n= Tr\n\"\nP (d,k)\nsym\n(dim (Symk(Cd)))2\n#\n(184)\n=\n\u0000dim\n\u0000Symk(Cd)\n\u0001\u0001\u22121 ,\n(185)\nwhere in the first equality we used Eq.(95), in the second equality the fact that P (d,k)\nsym\nsquares\nto itself (Theorem 16) and in the last equality the fact that P (d,k)\nsym\nis the orthogonal projector\non the symmetric subspace (Theorem 16). Similarly, we can show that Tr\nh\nA(k)\n\u03b7 A(k)\n\u00b5H\ni\nis equal to\n\u0000dim\n\u0000Symk(Cd)\n\u0001\u0001\u22121. Here, dim\n\u0000Symk(Cd)\n\u0001\ncan be calculated using Proposition 17, which shows\nthat it is equal to\n\u0000d+k\u22121\nk\n\u0001\n. Therefore, we can conclude.\n25\n", "27": "It is worth noting that any uniform distribution \u03bd defined over a set of unitaries S = {Ui}d2\ni=1\nthat forms a basis for L(Cd) and satisfies Tr\n\u0010\nU \u2020\ni Uj\n\u0011\n= d\u03b4i,j constitutes a 1-design. This can be\neasily proven by computing the frame potential as follows:\nF(k=1)\n\u03bd\n=\n1\n|S|2\nd2\nX\ni,j=1\n\f\f\fTr\n\u0010\nUiU \u2020\nj\n\u0011\f\f\f\n2\n= 1\nd4\nd2\nX\ni,j=1\nd2\u03b4i,j = 1 = dim(span(Vd(\u03c0) : \u03c0 \u2208S1)),\n(186)\nand applying Proposition 34.\nTherefore, the uniform distribution defined over the Pauli basis\n\u02dcP := {I, X, Y, Z}\u2297n is a 1-design, where n is the number of qubits and d = 2n.\nThe Flip operator can be elegantly represented in terms of the Pauli basis using the following\nexpression:\nF =\nX\nP,Q\u2208\u02dc\nP\n1\nd2 Tr((P \u2297Q) F)P \u2297Q =\nX\nP,Q\u2208\u02dc\nP\n1\nd2 Tr(PQ)P \u2297Q =\nX\nP \u2208\u02dc\nP\n1\ndP \u2297P,\n(187)\nwhere we wrote the Flip operator in the Pauli basis and used the swap-trick. Using this, it is\nalso evident that the Pauli group forms a 1-design (according to Definition 27). In fact, for any\nO \u2208L\n\u0000Cd\u0001\n, we have:\n1\n| \u02dcP|\nX\nP \u2208\u02dc\nP\nPOP \u2020 = 1\nd2\nX\nP \u2208\u02dc\nP\nTr2 ((I \u2297O)(P \u2297P)F) = 1\nd Tr2 ((I \u2297O)FF) = Tr(O)\nd\n=\nE\nU\u223c\u00b5H\n\u0002\nUOU \u2020\u0003\n,\nwhere in the first step we used the partial-swap-trick (Eq.(152)) and in the last step (Eq.(50)).\nAn important set of unitaries is the Clifford group Cl(n) [68] i.e. the set of unitaries which\nsends the Pauli group Pn in itself under the adjoint operation:\nCl(n) := {U \u2208U(2n): UPU \u2020 \u2208Pn for all P \u2208Pn},\n(188)\nwhere Pn := {ik}3\nk=0 \u00d7 {I, X, Y, Z}\u2297n. It can be proven that the uniform distribution over the\nClifford group, forms a 3-design for all d = 2n [69, 70], but it fails to be a 4-design [71].\nMoreover, it can be shown that any Clifford circuit can be implemented with O(n2/ log(n))\ngates from the set {H, CNOT, S} where H, CNOT and S are the Hadamard, Controlled-NOT and\nPhase gate, respectively [63, 72]. Furthermore, there are efficient algorithms to sample uniformly\nfrom the Clifford group [73, 74]. This is of fundamental importance for applications in quantum\ncomputing, since if we are interested in reproducing moments of the Haar measure up to the third\nmoment, it is sufficient to sample efficient quantum circuits that correspond to Clifford unitaries\n(instead of sampling from the Haar measure, which would require implementing quantum circuits\nwith an exponential number of gates in the number of qubits [63]).\n8\nApproximate unitary designs\nIn many cases, having an exact unitary design may not be necessary, and having an approximate\none may suffice. Various definitions of approximate unitary designs have been proposed in the\nliterature [39, 49, 59]. Here we will explore some of them and their relationships.\nWe begin by defining the concept of Tensor Product Expander (TPE)-\u03b5-approximate k-design\n[59]. To simplify the notation, we use U \u2297k,k := U \u2297k \u2297U \u2217\u2297k.\nDefinition 39 (Tensor Product Expander (TPE)-\u03b5-approximate k-design). Let \u03b5 > 0. We say\nthat \u03bd is a TPE \u03b5-approximate k-design if and only if:\n\r\r\r\r E\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\r\r\r\r\n\u221e\n\u2264\u03b5.\n(189)\nThe TPE notion of approximate unitary design is particularly advantageous because it can be\n\u201camplified\u201d. This means that if a distribution of unitaries \u03bd is a TPE \u03bb-approximate k-design,\nthen the distribution of unitaries associated to the product UP \u00b7 \u00b7 \u00b7 U1 of unitaries {Ui}P\ni=1, each\n26\n", "28": "independently distributed according to \u03bd, is a TPE \u03bbP-approximate design (as we prove below).\nWe denote by \u03bdP this distribution of the product of P unitaries sampled independently by \u03bd. Note\nthat the vectorized moment operator associated with \u03bdP is:\nE\nU\u223c\u03bdPU \u2297k,k =\nE\nU1,...,UP\u223c\u03bd (UP \u00b7 \u00b7 \u00b7 U1)\u2297k,k .\n(190)\nWe state the proposition below:\nProposition 40 (Amplification of TPE).\nLet 1 > \u03bb \u2265\u03b5 > 0. If \u03bd is a TPE \u03bb-approximate\nk-design, then \u03bdP is a TPE \u03b5-approximate k-design, where P is a positive integer such that P \u2265\n1\nlog(\u03bb\u22121) log\n\u0000\u03b5\u22121\u0001\n.\nProof. We have to bound the following quantity\n\r\r\r\r E\nV \u223c\u03bdP\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\r\r\r\r\n\u221e\n. We first ob-\nserve that the vectorized moment operator associated to \u03bdP is:\nE\nV \u223c\u03bdP\n\u0002\nV \u2297k,k\u0003\n=\nE\nV1,...,VP\u223c\u03bd (VP \u00b7 \u00b7 \u00b7 V1)\u2297k,k =\n\u0010\nE\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\u0011P\n,\n(191)\nwhere we used the independence of U1, . . . , UP. Moreover, we have:\n\u0010\nE\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\u0011P\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\n=\n\u0012\nE\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\u0013P\n,\n(192)\nwhich can be shown by induction. The basis step is trivial for P = 1. Suppose the claim is true\nfor P, then:\n\u0012\nE\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\u0013P+1\n(193)\n=\n\u0012\nE\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\u0013P \u0012\nE\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\u0013\n(194)\n=\n\u0012\u0010\nE\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\u0011P\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\u0013 \u0012\nE\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\u0013\n(195)\n=\n\u0010\nE\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\u0011P+1\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\n,\n(196)\nwhere in the last step we used the invariance of the Haar measure to conclude that\nV k,k\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\n=\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\nV k,k =\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\n.\n(197)\nTherefore we have:\n\r\r\r\r E\nV \u223c\u03bdP\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\r\r\r\r\n\u221e\n=\n\r\r\r\r\r\n\u0012\nE\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\u0013P\r\r\r\r\r\n\u221e\n(198)\n\u2264\n\r\r\r\r E\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\r\r\r\r\nP\n\u221e\n(199)\n\u2264\u03bbP,\n(200)\nwhere in the first step we used Eq.(191) and Eq.(192), in the second step we used the submul-\ntiplicativity4 of the infinity norm and in the last step we used that \u03bd is a TPE \u03bb-approximate\nk-design. By choosing P \u2265log(\u03b5)\nlog(\u03bb), we can conclude that \u03bdP is a TPE \u03b5-approximate k-design.\nThe previous Proposition implies that if we have a TPE \u03bb-approximate k-design and we want\nto amplify it in order to achieve a TPE with approximation precision \u03b5 inverse exponential in the\nnumber of qubits i.e. \u03b5 = \u02dc\u03b5d\u2212c where \u02dc\u03b5, c > 0 and d = 2n, then we can achieve this by choosing\na number of repetitions P \u2265\n1\nlog(\u03bb\u22121)\n\u0000log\n\u0000\u02dc\u03b5\u22121\u0001\n+ nc log(2)\n\u0001\n. Note that this expression is linear in\nthe number of qubits n if \u03bb = O(1).\nWe will now define the notion of diamond \u03b5-approximate k-design.\n4Note that the submultiplicativity inequality is saturated if\nE\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\nis Hermitian (or more generally normal).\n27\n", "29": "Definition 41 (Diamond \u03b5-approximate k-design). We say that \u03bd is a diamond \u03b5-approximate\nk-design if and only if\n\r\r\rM(k)\n\u03bd\n\u2212M(k)\n\u00b5H\n\r\r\r\n\u2662\u2264\u03b5,\n(201)\nwhere the diamond norm of a superoperator \u03a6 : L(CD) \u2192L(CD) can be defined as\n\u2225\u03a6\u2225\u2662:= sup\nX\u0338=0\n\u2225\u03a6 \u2297I (X)\u22251\n\u2225X\u22251\n,\n(202)\nwhere I : L(CD) \u2192L(CD) is the identity channel.\nIt is worth mentioning that the diamond norm distance between two quantum channels has\nan important operational interpretation, as it is closely related to the one-shot distinguishability\nprobability between the two channels [75].\nIn the following Proposition, we will see the relation between the Diamond approximate design\ndefinition and the TPE one previously introduced.\nProposition 42 (Diamond vs TPE).\n\u2022 We have:\n\r\r\rM(k)\n\u03bd\n\u2212M(k)\n\u00b5H\n\r\r\r\n\u2662\u2264dk\n\r\r\r\r E\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\r\r\r\r\n\u221e\n.\n(203)\nThus, if \u03bd is a TPE \u03b5-approximate k-design, then \u03bd is a diamond \u03b5dk-approximate k-design.\n\u2022 Conversely, we have:\n\r\r\r\r E\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\r\r\r\r\n\u221e\n\u2264dk/2\r\r\rM(k)\n\u03bd\n\u2212M(k)\n\u00b5H\n\r\r\r\n\u2662.\n(204)\nHence, if \u03bd is a diamond \u03b5-approximate k-design, then \u03bd is a TPE \u03b5dk/2-approximate k-\ndesign.\nProof. Let \u03a6 := M(k)\n\u03bd\n\u2212M(k)\n\u00b5H. We have:\n\u2225\u03a6\u2225\u2662= sup\nX\u0338=0\n\u2225\u03a6 \u2297I (X)\u22251\n\u2225X\u22251\n\u2264\n\u221a\nd2k sup\nX\u0338=0\n\u2225\u03a6 \u2297I (X)\u22252\n\u2225X\u22251\n\u2264dk sup\nX\u0338=0\n\u2225\u03a6 \u2297I (X)\u22252\n\u2225X\u22252\n,\n(205)\nwhere we used that \u2225A\u22251 \u2264\n\u221a\nD\u2225A\u22252 and \u2225A\u22252 \u2264\u2225A\u22251 for A \u2208L(CD). Now we observe that:\nsup\nX\u0338=0\n\u2225\u03a6 \u2297I (X)\u22252\n\u2225X\u22252\n=\nsup\nX : \u2225X\u22252=1\n\u2225vec(\u03a6 \u2297I) |X\u27e9\u27e9\u22252 = \u2225vec(\u03a6 \u2297I)\u2225\u221e,\n(206)\nwhere in the first equality we used that the Hilbert-Schmidt norm of a matrix is the 2-norm of the\nvectorized matrix and that vec (\u03a6 \u2297I (X)) = vec(\u03a6 \u2297I) |X\u27e9\u27e9(see Eq.(105)), while in the third\nequality we used that \u2225A |v\u27e9\u22252 =\np\n\u27e8v| A\u2020A |v\u27e9and that the supremum of this quantity over all the\nvectors |v\u27e9that are normalized with respect to the 2-norm is achieved by the largest eigenvalue of\nA\u2020A, which coincides with the largest singular value of A. Now we have:\n\r\rvec\n\u0000U \u2297k (\u00b7) U \u2020\u2297k \u2297I\n\u0001\r\r\n\u221e=\n\r\rU \u2297k \u2297I\u2297k \u2297U \u2217\u2297k \u2297I\u2297k\r\r\n\u221e=\n\r\rU \u2297k \u2297U \u2217\u2297k \u2297I\u2297k \u2297I\u2297k\r\r\n\u221e,\n(207)\nwhere in the last step we permuted the tensor products using the p-norm property\n\r\rUAU \u2020\r\r\np =\n\u2225A\u2225p with U unitary matrix. Using this we can write:\n\r\r\rM(k)\n\u03bd\n\u2212M(k)\n\u00b5H\n\r\r\r\n\u2662\u2264dk\r\r\rvec\n\u0010\nM(k)\n\u03bd\n\u2297I\n\u0011\n\u2212vec\n\u0010\nM(k)\n\u00b5H \u2297I\n\u0011\r\r\r\n\u221e\n(208)\n= dk\n\r\r\r\r\n\u0012\nE\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\u0013\n\u2297I\u2297k \u2297I\u2297k\n\r\r\r\r\n\u221e\n(209)\n= dk\n\r\r\r\r E\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\r\r\r\r\n\u221e\n,\n(210)\n28\n", "30": "where in the last step we used the p-norm property \u2225A \u2297B\u2225p = \u2225A\u2225p\u2225B\u2225p. Hence the first claim\nfollows. Now for the second claim, reviewing in reverse what we have shown for the first claim, we\nhave:\n\r\r\r\r E\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\r\r\r\r\n\u221e\n= sup\nX\u0338=0\n\u2225\u03a6 \u2297I (X)\u22252\n\u2225X\u22252\n.\n(211)\nBy using that \u2225A\u22252 \u2264\u2225A\u22251, that \u2225A\u22251 \u2264\n\u221a\nD\u2225A\u22252 for A \u2208L(CD) and the definition of diamond\nnorm, we have:\n\r\r\r\r E\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\r\r\r\r\n\u221e\n\u2264\n\u221a\ndk\n\r\r\rM(k)\n\u03bd\n\u2212M(k)\n\u00b5H\n\r\r\r\n\u2662.\n(212)\nMotivated by Proposition 34, we introduce an alternative notion of approximation based on\nthe frame potential. Notably, the frame potential may be easier to estimate numerically than the\nother approximation notions previously introduced (if approached naively by their definition), as\nit involves computing the trace of matrices in L(Cd), rather than working with matrices defined in\ntensor product spaces. Specifically, we define a frame potential \u03b5-approximate k-design as follows:\nDefinition 43 (Frame potential \u03b5-approximate k-design). We say that \u03bd is a frame potential\n\u03b5-approximate k-design if and only if:\nq\nF(k)\n\u03bd\n\u2212F(k)\n\u00b5H \u2264\u03b5.\n(213)\nNote that the argument of this square root is always non-negative (due to Lemma 33).\nWe now establish a relationship between the Frame potential notion of approximate k-design\nand the TPE one.\nProposition 44 (Frame potential vs TPE relation).\n\u2022 We have:\nq\nF(k)\n\u03bd\n\u2212F(k)\n\u00b5H \u2264dk\n\r\r\r\r E\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\r\r\r\r\n\u221e\n.\n(214)\nTherefore, if \u03bd is a TPE \u03b5-approximate k-design, then \u03bd is a frame potential \u03b5dk-approximate\nk-design.\n\u2022 Conversely, we have:\n\r\r\r\r E\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\r\r\r\r\n\u221e\n\u2264\nq\nF(k)\n\u03bd\n\u2212F(k)\n\u00b5H .\n(215)\nThus, if \u03bd is frame potential \u03b5-approximate k-design, then \u03bd is a TPE \u03b5-approximate k-design.\nProof. By using Lemma (33), we have:\nq\nF(k)\n\u03bd\n\u2212F(k)\n\u00b5H =\n\r\r\r\r E\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\r\r\r\r\n2\n.\n(216)\nNow the first claim follows just by using that \u2225A\u22252 \u2264\n\u221a\nD\u2225A\u2225\u221efor all A \u2208L(CD), while the\nsecond claim follows by \u2225A\u2225\u221e\u2264\u2225A\u22252.\nIn the following, we relate the diamond notion of approximation with the frame potential one.\nProposition 45 (Diamond vs Frame potential).\n29\n", "31": "\u2022 We have:\n\r\r\rM(k)\n\u03bd\n\u2212M(k)\n\u00b5H\n\r\r\r\n\u2662\u2264dk\nq\nF(k)\n\u03bd\n\u2212F(k)\n\u00b5H .\n(217)\nHence, if \u03bd is a frame potential \u03b5-approximate k-design, then \u03bd is a diamond \u03b5dk-approximate\nk-design.\n\u2022 Conversely, we have:\nq\nF(k)\n\u03bd\n\u2212F(k)\n\u00b5H \u2264d3k/2\r\r\rM(k)\n\u03bd\n\u2212M(k)\n\u00b5H\n\r\r\r\n\u2662.\n(218)\nHence, if \u03bd is a diamond \u03b5-approximate k-design, then \u03bd is a frame potential \u03b5d3k/2-approximate\nk-design.\nProof. Using Eq.(203), we have:\n\r\r\rM(k)\n\u03bd\n\u2212M(k)\n\u00b5H\n\r\r\r\n\u2662\u2264dk\n\r\r\r\r E\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\r\r\r\r\n\u221e\n\u2264dk\nq\nF(k)\n\u03bd\n\u2212F(k)\n\u00b5H ,\n(219)\nwhere in the last step we used that \u2225A\u2225\u221e\u2264\u2225A\u22252 and Eq.(33). Therefore we have shown the first\nclaim. For the second claim, we have:\nq\nF(k)\n\u03bd\n\u2212F(k)\n\u00b5H \u2264\n\u221a\nd2k\n\r\r\r\r E\nV \u223c\u03bd\n\u0002\nV \u2297k,k\u0003\n\u2212\nE\nU\u223c\u00b5H\n\u0002\nU \u2297k,k\u0003\r\r\r\r\n\u221e\n\u2264dkdk/2\r\r\rM(k)\n\u03bd\n\u2212M(k)\n\u00b5H\n\r\r\r\n\u2662,\n(220)\nwhere in the first step we used Lemma 33 and that \u2225A\u22252 \u2264\n\u221a\nD\u2225A\u2225\u221efor A \u2208L(CD), while in the\nsecond step we used Eq.(204).\nAnother notion of unitary design approximation was introduced in [59], which we refer to as\nrelative error \u03b5-approximate k-design. This is defined as follows:\nDefinition 46 (Relative error \u03b5-approximate k-design).\nWe say that \u03bd is a relative error \u03b5-\napproximate k-design if and only if\n(1 \u2212\u03b5)M(k)\n\u03bd\n\u227cM(k)\n\u00b5H \u227c(1 + \u03b5)M(k)\n\u03bd ,\n(221)\nwhere A \u227cB means that B \u2212A is completely positive, and A and B are linear superoperators.\nFor further details on this approximation notion, see [59]. In [59, 76, 77], it was shown that\none-dimensional local random quantum circuits, which are quantum circuits of n qubits formed by\n2-qubit Haar random gates, of size O\n\u0000n2poly(k)\n\u0001\nare (relative error) \u03b5-approximate k-designs for\nall k \u2208O\n\u000020.4n\u0001\n. This result has been extended to higher dimensional quantum circuits in [78].\n9\nExamples and applications\nThis section explores diverse examples and applications where the Haar measure plays a funda-\nmental role in quantum information. We derive well-known formulas that reduce to computing\nmoments over the Haar measure, including the twirling of quantum channels and the average gate\nfidelity. These formulas lay the foundation for various applications, such as Randomized Bench-\nmarking [79].\nMoreover, we show how these moment calculations can be translated into probability statements\nusing concentration inequalities. Concentration inequalities serve as valuable tools for establishing\nrigorous bounds and enhancing our understanding of the statistical behavior associated with Haar\nrandom variables.\nFurthermore, we provide detailed insights into two notable examples showcasing the applica-\ntions of the theory of unitary design. We examine Barren Plateaus [30] in Variational Quantum\nAlgorithms, shedding light on the optimization landscapes encountered in such algorithms. Addi-\ntionally, we delve into Classical Shadow tomography [1], where the theory of unitary design aids\nin designing efficient measurement strategies for reconstructing properties of unknown quantum\nstates.\n30\n", "32": "9.1\nExamples of moment calculations\nWe start by deriving a formula that plays an important role in quantum information, in particular\nin Randomized Benchmarking [18, 79].\nThis formula illustrates that when a unitary operator\nU, randomly chosen from a 2-design, is applied before a quantum channel \u03a6, followed by the\napplication of its adjoint U \u2020, the resulting output channel resembles a depolarizing channel.\nExample 47 (Twirling of a quantum channel is a depolarizing channel). Let \u03bd a unitary 2-design\ndistribution. Consider a quantum channel \u03a6 : L(Cd) \u2192L(Cd) and a quantum state \u03c1 \u2208S\n\u0000Cd\u0001\n.\nThen:\nE\nU\u223c\u03bd\n\u0002\nU \u2020\u03a6\n\u0000U\u03c1U \u2020\u0001\nU\n\u0003\n= p\u03a6\u03c1 + (1 \u2212p\u03a6) Tr(\u03c1)I\nd,\n(222)\nwhere the left-hand side represents the so-called \u201ctwirling\u201d of \u03a6, and we define:\np\u03a6 := d2Fe (\u03a6) \u22121\nd2 \u22121\n.\n(223)\nHere, Fe (\u03a6) denotes the entanglement fidelity given by Fe (\u03a6) :=\n1\nd2 \u27e8\u2126| \u03a6 \u2297I(|\u2126\u27e9\u27e8\u2126|) |\u2126\u27e9, where\nI : L(Cd) \u2192L(Cd) represents the identity channel.\nProof. Due to the 2-design property of \u03bd and the fact that the quantity of interest is a second\nmoment quantity, we can average over the Haar measure \u00b5H instead of \u03bd. Considering a Kraus\ndecomposition for \u03a6 with operators {Ki}d2\ni=1, we have:\nE\nU\u223c\u00b5H\n\u0002\nU \u2020\u03a6\n\u0000U\u03c1U \u2020\u0001\nU\n\u0003\n=\nd2\nX\ni=1\nE\nU\u223c\u00b5H\nh\nU \u2020KiU\u03c1U \u2020K\u2020\ni U\ni\n(224)\n=\nd2\nX\ni=1\nE\nU\u223c\u00b5H Tr2\nh\n(I \u2297\u03c1)U \u2020\u22972(Ki \u2297K\u2020\ni )U \u22972F\ni\n(225)\n=\nd2\nX\ni=1\nTr2\n\u0014\n(I \u2297\u03c1)\nE\nU\u223c\u00b5H\n\u0010\nU \u22972(Ki \u2297K\u2020\ni )U \u2020\u22972\u0011\nF\n\u0015\n,\n(226)\nwhere in the second equality we used that AB = Tr2 (A \u2297B F), and in the third equality that\nE\nU\u223c\u00b5H [f(U)] =\nE\nU\u223c\u00b5H\n\u0002\nf(U \u2020)\n\u0003\n(Proposition 3) for all integrable functions f. Using Eq.(51) for the\nsecond moment, we have:\nE\nU\u223c\u00b5H\n\uf8ee\n\uf8f0U \u22972\n\uf8eb\n\uf8ed\nd2\nX\ni=1\nKi \u2297K\u2020\ni\n\uf8f6\n\uf8f8U \u2020\u22972\n\uf8f9\n\uf8fb= cII + cFF,\n(227)\nwhere the coefficients cI and cF are given by:\ncI =\nPd2\ni=1 Tr\n\u0010\nKi \u2297K\u2020\ni\n\u0011\n\u2212d\u22121 Tr\n\u0010Pd2\ni=1 Ki \u2297K\u2020\ni F\n\u0011\nd2 \u22121\n=\nPd2\ni=1 | Tr(Ki) |2 \u22121\nd2 \u22121\n(228)\ncF =\nTr\n\u0010\nF Pd2\ni=1 Ki \u2297K\u2020\ni\n\u0011\n\u2212d\u22121 Tr\n\u0010Pd2\ni=1 Ki \u2297K\u2020\ni\n\u0011\nd2 \u22121\n= d \u2212d\u22121 Pd2\ni=1 |Tr(Ki)|2\nd2 \u22121\n,\n(229)\nwhere we used the swap-trick and the fact that Pd2\ni=1 K\u2020\ni Ki = I. We observe that cF = d\u22121(1\u2212cI).\nTherefore:\nE\nU\u223c\u00b5H\n\u0002\nU \u2020\u03a6\n\u0000U\u03c1U \u2020\u0001\nU\n\u0003\n= Tr2 [(I \u2297\u03c1) (cI,I + cFF) F]\n(230)\n= cI Tr2 ((I \u2297\u03c1)F) + 1\nd(1 \u2212cI) Tr2((I \u2297\u03c1))\n(231)\n= cI\u03c1 + (1 \u2212cI) Tr(\u03c1) I\nd .\n(232)\n31\n", "33": "To conclude the proof, we observe that cI = p\u03a6, as defined in Eq.(223). This follows from the\nrelationship Pd2\ni=1 |Tr(Ki)|2 = d2Fe (\u03a6), as it can be easily seen:\nFe (\u03a6) := 1\nd2 \u27e8\u2126| \u03a6 \u2297I(|\u2126\u27e9\u27e8\u2126|) |\u2126\u27e9\n(233)\n=\nd2\nX\ni=1\n1\nd2 \u27e8\u2126| Ki \u2297I |\u2126\u27e9\u27e8\u2126| K\u2020\ni \u2297I |\u2126\u27e9\n(234)\n= 1\nd2\nd2\nX\ni=1\n|Tr(Ki)|2 .\n(235)\nIt is worth noting that this equality can also be understood visually with the help of diagrams.\nIt should be noted that the above formula, along with many other derivations in this tutorial,\nis based on the calculation of the moment operator that depends on the commutant of the unitary\ngroup. However, if we were to compute the Haar expected value defined over another subgroup\non the unitary group instead on the full unitary group, we could still use the same approach by\ncharacterizing the commutant of this subgroup.\nThe following example introduces the concept of average gate fidelity, a measure used to assess\nthe quality of quantum gates [24, 80].\nExample 48 (Average gate fidelity). Let \u03bd be a state 2-design distribution. Consider a quantum\nchannel \u03a6 : L(Cd) \u2192L(Cd) and a unitary channel U (\u00b7) = U (\u00b7) U \u2020. Then, the average gate fidelity\nis given by:\nE\n|\u03c8\u27e9\u223c\u03bd\n\u0002\n\u27e8\u03c8| U\u2020 \u25e6\u03a6 (|\u03c8\u27e9\u27e8\u03c8|) |\u03c8\u27e9\n\u0003\n= dFe\n\u0000U\u2020 \u25e6\u03a6\n\u0001\n+ 1\nd + 1\n,\n(236)\nwhere U\u2020 (\u00b7) = U \u2020 (\u00b7) U represents the adjoint channel of U, and Fe (\u03a6) :=\n1\nd2 \u27e8\u2126| \u03a6 \u2297I(|\u2126\u27e9\u27e8\u2126|) |\u2126\u27e9\ncorresponds to the entanglement-fidelity.\nProof. It is worth noting that this formula can be easily derived also from the previous Eq. 222\nwithout the need to explicitly compute any additional Haar moment. However, for the sake of\ncompleteness, we will still perform the derivation without using Eq. 222. We have:\nE\n|\u03c8\u27e9\u223c\u03bd\n\u0002\n\u27e8\u03c8| U \u2020\u03a6 (|\u03c8\u27e9\u27e8\u03c8|) U |\u03c8\u27e9\n\u0003\n=\nd2\nX\ni=1\nE\n|\u03c8\u27e9\u223c\u00b5H\nh\nTr\n\u0010\n|\u03c8\u27e9\u27e8\u03c8| U \u2020Ki |\u03c8\u27e9\u27e8\u03c8| K\u2020\ni U\n\u0011i\n(237)\n=\nd2\nX\ni=1\nE\n|\u03c8\u27e9\u223c\u00b5H\nh\nTr\n\u0010\n|\u03c8\u27e9\u27e8\u03c8|\u22972 \u0010\nU \u2020Ki \u2297K\u2020\ni U\n\u0011\nF\n\u0011i\n(238)\n= Tr\n\uf8eb\n\uf8edI + F\nd(d + 1)\nd2\nX\ni=1\n\u0010\nU \u2020Ki \u2297K\u2020\ni U\n\u0011\nF\n\uf8f6\n\uf8f8\n(239)\n=\n1\nd(d + 1)\n\uf8eb\n\uf8ed\nd2\nX\ni=1\nTr\n\u0010\nU \u2020KiK\u2020\ni U\n\u0011\n+\nd2\nX\ni=1\nTr\n\u0010\nU \u2020Ki \u2297K\u2020\ni U\n\u0011\n\uf8f6\n\uf8f8\n(240)\n=\n1\nd(d + 1)\n\uf8eb\n\uf8edd +\nd2\nX\ni=1\n\f\fTr\n\u0000U \u2020Ki\n\u0001\f\f2\n\uf8f6\n\uf8f8,\n(241)\nwhere we used in the first equality the Kraus decomposition of \u03a6 and the fact that \u03bd is a 2-design, in\nthe second equality the swap-trick, in the third equality we used linearity of the expected value and\nthe moment operator formula (95), in the fourth equality again the swap-trick, in the fifth equality\nthe fact that Pd2\ni=1 K\u2020\ni Ki = I. Finally, we observe that Fe\n\u0000U\u2020 \u25e6\u03a6\n\u0001\n=\n1\nd2\nPd2\ni=1\n\f\fTr\n\u0000U \u2020Ki\n\u0001\f\f2 (see\nEq.(233)), which concludes the proof.\n32\n", "34": "The following example considers a bipartite state \u03c1 \u2208S\n\u0000Cd \u2297Cd\u0001\nshared between Alice and\nBob, who apply unitary operations U and U \u2217to their respective subsystems, where U is sampled\naccording to a 2-design [26]. The resulting output state can be expressed as a combination of the\nmaximally mixed state and the maximally entangled state d\u22121 |\u2126\u27e9\u27e8\u2126|, and the coefficients of this\ncombination depend on the overlap of the state \u03c1 with the maximally entangled state d\u22121 |\u2126\u27e9\u27e8\u2126|.\nExample 49.\nLet \u03bd be a unitary 2-design distribution, and \u03c1 \u2208S\n\u0000Cd \u2297Cd\u0001\nbe a quantum state.\nE\nU\u223c\u03bd\n\u0002\nU \u2297U \u2217\u03c1U \u2020 \u2297U \u2217\u2020\u0003\n= p\u03c1\nI\nd2 + (1 \u2212p\u03c1) |\u2126\u27e9\u27e8\u2126|\nd\n,\n(242)\nwhere p\u03c1 := d2 (1\u2212d\u22121\u27e8\u2126|\u03c1|\u2126\u27e9)\nd2\u22121\nwith p\u03c1 \u2208\nh\n0,\nd2\nd2\u22121\ni\n.\nProof. By considering the partial transpose over the second subsystem and the 2-design formula\n(Eq.(51)), we obtain:\nE\nU\u223c\u03bd\n\u0002\nU \u2297U \u2217\u03c1U \u2020 \u2297U \u2217\u2020\u0003\n=\nE\nU\u223c\u00b5H\n\u0002\nU \u22972\u03c1TBU \u2020\u22972\u0003TB = cI,\u03c1TB ITB + cF,\u03c1TB FTB = cI,\u03c1TB I + cF,\u03c1TB |\u2126\u27e9\u27e8\u2126| ,\n(243)\nwith\ncI,\u03c1TB = Tr\n\u0000\u03c1TB\u0001\n\u2212d\u22121 Tr\n\u0000\u03c1TBF\n\u0001\nd2 \u22121\n= 1 \u2212d\u22121 \u27e8\u2126| \u03c1 |\u2126\u27e9\nd2 \u22121\n,\n(244)\nand\ncF,\u03c1TB = Tr\n\u0000F\u03c1TB\u0001\n\u2212d\u22121 Tr\n\u0000\u03c1TB\u0001\nd2 \u22121\n= \u27e8\u2126| \u03c1 |\u2126\u27e9\u2212d\u22121\nd2 \u22121\n.\n(245)\nNoting that cI,\u03c1TB = p\u03c1d\u22122 and cF,\u03c1TB = (1 \u2212p\u03c1)d\u22121, we obtain the desired result.\nNow, let us consider the problem of evaluating the expected purity of the reduced state obtained\nfrom a pure state distributed according to a 2-design distribution [81].\nExample 50 (Purity). Consider the complex Hilbert space of two-qudit systems HA \u2297HB of\ndimensions respectively dA = dim(HA) and dB = dim(HB). Given |\u03c8\u27e9\u2208HA \u2297HB, let \u03c1A :=\nTrB (|\u03c8\u27e9\u27e8\u03c8|). We have:\nE\n|\u03c8\u27e9\u223c\u03bd Tr\n\u0000\u03c12\nA\n\u0001\n= dB + dA\ndAdB + 1,\n(246)\nwhere \u03bd is a 2-design distribution.\nProof. We can express the expected value as follows:\nE\n|\u03c8\u27e9\u223c\u03bd Tr\n\u0000\u03c12\nA\n\u0001\n=\nE\n|\u03c8\u27e9\u223c\u00b5H Tr\n\u0000\u03c1\u22972\nA FA\n\u0001\n=\nE\n|\u03c8\u27e9\u223c\u03bd Tr\n\u0010\n|\u03c8\u27e9\u27e8\u03c8|\u22972 (FA \u2297IB)\n\u0011\n,\n(247)\nwhere in the first equality we used the swap-trick on the two copies of the subsystem A and denoted\nwith the subscript A the Flip operator acting on such two copies, and in the second equality we\nused that \u03c1A = TrB(|\u03c8\u27e9\u27e8\u03c8| IA \u2297IB). In tensor diagrams this is also clear to visualize. Since \u03bd is a\n2-design, we have:\nE\n|\u03c8\u27e9\u223c\u03bd Tr\n\u0000\u03c12\nA\n\u0001\n= Tr\n\u0012\nE\n|\u03c8\u27e9\u223c\u00b5H\nh\n|\u03c8\u27e9\u27e8\u03c8|\u22972i\n(FA \u2297IB)\n\u0013\n= Tr\n\u0012\u0014IA \u2297IB + FA \u2297FB\ndAdB(dAdB + 1)\n\u0015\n(FA \u2297IB)\n\u0013\n(248)\n=\n1\ndAdB(dAdB + 1)\n\u0000dAd2\nB + d2\nAdB\n\u0001\n= dB + dA\ndAdB + 1.\n(249)\n33\n", "35": "Now let us consider a system like in the previous example, where dA \u2264dB. Since the entan-\nglement entropy S (\u03c1A) := \u2212Tr(\u03c1A log2 \u03c1A) is lower bounded by the 2-Renyi entropy S2 (\u03c1A) :=\n\u2212log2\n\u0000Tr\n\u0000\u03c12\nA\n\u0001\u0001\n(Fact 1 in [82]), we have:\nE\n|\u03c8\u27e9\u223c\u03bdS(\u03c1A) \u2265\nE\n|\u03c8\u27e9\u223c\u03bdS2(\u03c1A) = \u2212E\n|\u03c8\u27e9\u223c\u03bd log2\n\u0000Tr\n\u0000\u03c12\nA\n\u0001\u0001\n\u2265\u2212log2\n\u0012\nE\n|\u03c8\u27e9\u223c\u03bd Tr\n\u0000\u03c12\nA\n\u0001\u0013\n,\n(250)\nwhere we used Jensen\u2019s inequality with the fact that \u2212log2(x) is a convex function. By using the\nresult from the previous Example 50, we have:\nE\n|\u03c8\u27e9\u223c\u03bdS(\u03c1A) \u2265log2\n\u0012dAdB + 1\ndB + dA\n\u0013\n\u2265log2(dA) \u2212log2\n\u0012dB + dA\ndB\n\u0013\n\u2265log2(dA) \u22121,\n(251)\nSince S (\u03c1A) \u2264log2(dA), we conclude that the expected value of the entanglement entropy of the\nreduced state of a pure state distributed according to a 2-design is close to its maximum value.\nHowever, it is important to note that for finite system sizes, there exists a gap between the exact\naverage entanglement entropy and the maximum value, as demonstrated by Page [83, 84]:\nE\n|\u03c8\u27e9\u223c\u03bdS(\u03c1A) =\n1\nln(2)\n \n\u2212dA \u22121\n2dB\n+\ndAdB\nX\nk=dB+1\n1\nk\n!\n> log2(dA) \u2212\n1\nln(2)\ndA\n2dB\n.\n(252)\nThis value is commonly referred to as the Page entropy. For a more in-depth analysis, see [41],\nwhere higher Renyi-entropies are also discussed.\nExample 51 (Expectation value). Consider a unitary k-design distribution denoted by \u03bd. Let\nO \u2208L\n\u0000Cd\u0001\nbe an operator. Then:\nE\n|\u03c8\u27e9\u223c\u03bd \u27e8\u03c8| O |\u03c8\u27e9k =\n1\n\u0000k+d\u22121\nk\n\u0001 Tr\nh\nO\u2297kP (d,k)\nsym\ni\n.\n(253)\nIn the case of k = 2, it simplifies to:\nE\n|\u03c8\u27e9\u223c\u03bd \u27e8\u03c8| O |\u03c8\u27e92 =\n1\nd (d + 1)\n\u0010\nTr(O)2 + Tr\n\u0000O2\u0001\u0011\n.\n(254)\nProof. This follows easily from Eq.(95):\nE\n|\u03c8\u27e9\u223c\u03bd \u27e8\u03c8| O |\u03c8\u27e9k = Tr\n\u0014\nO\u2297k\nE\n|\u03c8\u27e9\u223c\u03bd (|\u03c8\u27e9\u27e8\u03c8|)\u2297k\n\u0015\n(255)\n=\n1\n\u0000k+d\u22121\nk\n\u0001 Tr\nh\nO\u2297kP (d,k)\nsym\ni\n.\n(256)\nIf k = 2, then P (d,k)\nsym\n=\n1\n2 (I + F).\nUsing that Tr\n\u0002\nO\u22972\u0003\n= Tr [O]2 and Tr\n\u0002\nO\u22972F\n\u0003\n= Tr\n\u0002\nO2\u0003\n(swap-trick), leading to the desired expression.\nApplying Example 51 with O = |\u03d5\u27e9\u27e8\u03d5| with |\u03d5\u27e9\u2208Cd and noting that |\u03d5\u27e9\u27e8\u03d5|\u2297k P (d,k)\nsym = |\u03d5\u27e9\u27e8\u03d5|\u2297k,\nwe have the following result.\nExample 52. Consider a unitary k-design distribution denoted by \u03bd. Let |\u03d5\u27e9\u2208Cd. The following\nholds:\nE\n|\u03c8\u27e9\u223c\u03bd\nh\n|\u27e8\u03c8|\u03d5\u27e9|2ki\n=\n1\n\u0000k+d\u22121\nk\n\u0001 \u2264k!\ndk .\n(257)\nIn particular, for k = 1, we have\nE\n|\u03c8\u27e9\u223c\u03bd\nh\n|\u27e8\u03c8|\u03d5\u27e9|2i\n= 1\nd.\n34\n", "36": "9.2\nConcentration inequalities\nBy utilizing concentration inequalities, such as Markov\u2019s inequality, it is possible to establish a\nconnection between the exponential decay of the expected value with the number of qubits and\na probabilistic statement. Markov\u2019s inequality states that for a non-negative random variable X\nand any \u03b5 > 0, the probability that X exceeds \u03b5 is bounded by the ratio of the expected value of\nX to \u03b5:\nProb (X \u2265\u03b5) \u2264E [X]\n\u03b5\n.\n(258)\nIn a more general form, if g is a strictly increasing non-negative function, the inequality can be\nexpressed as:\nProb (X \u2265\u03b5) \u2264E [g(X)]\ng(\u03b5)\n.\n(259)\nTo do an example, consider P \u2208{I, X, Y, Z}\u2297n\\{I\u2297n} where X, Y, Z are Pauli matrices.\nBy\napplying Markov\u2019s inequality and utilizing Example (51), we find that when sampling a (Haar)\nrandom state |\u03c8\u27e9, the probability that the expectation value of P exceeds a threshold \u03b5 > 0 decays\nexponentially with the number of qubits n:\nProb\n|\u03c8\u27e9\u223c\u00b5H (|\u27e8\u03c8| P |\u03c8\u27e9| \u2265\u03b5) = Prob\n|\u03c8\u27e9\u223c\u00b5H\n\u0010\n|\u27e8\u03c8| P |\u03c8\u27e9|2 \u2265\u03b52\u0011\n\u2264\n1\n(2n + 1)\u03b52 .\n(260)\nThe same holds if the expected value is taken with respect to a state 2-design.\nAnother concentration inequality that can be particularly useful when analyzing the averages\nover Haar-random states is Levy\u2019s lemma.\nLemma 53 (Levy\u2019s lemma [85]). Consider the set S2d\u22121 := {v \u2208Cd : \u2225v\u22252 = 1}. Let f : S2d\u22121 \u2192\nR be a function satisfying the Lipschitz condition |f(v) \u2212f(w)| \u2264L\u2225v \u2212w\u22252. For all \u03b5 \u22650, we\nhave the probability bound:\nProb\n|\u03d5\u27e9\u223c\u00b5H\n\u0014\f\f\f\ff (\u03d5) \u2212\nE\n|\u03c8\u27e9\u223c\u00b5H [f (\u03c8)]\n\f\f\f\f \u2265\u03b5\n\u0015\n\u22642 exp\n\u0012\n\u22122d\u03b52\n9\u03c03L2\n\u0013\n.\n(261)\nUsing Levy\u2019s lemma, we can improve the dependence on the number of qubits n to a double\nexponential form compared to what we obtained by a simple application of Markov\u2019s inequality in\nEq. (260), as shown in the next example. However, this double exponential form comes at the cost\nof requiring the state to be drawn from the Haar measure rather than a state 2-design.\nExample 54. Let O \u2208Herm\n\u0000Cd\u0001\nbe a Hermitian operator. For all \u03b5 \u22650, we have:\nProb\n|\u03c8\u27e9\u223c\u00b5H\n\u0012\f\f\f\f\u27e8\u03c8| O |\u03c8\u27e9\u2212Tr(O)\nd\n\f\f\f\f \u2265\u03b5\n\u0013\n\u22642 exp\n \n\u2212\nd\u03b52\n18\u03c03\u2225O\u22252\n\u221e\n!\n.\n(262)\nIn particular, if O is a Pauli string P \u2208{I, X, Y, Z}\u2297n\\{I\u2297n}, we have:\nProb\n|\u03c8\u27e9\u223c\u00b5H (|\u27e8\u03c8| P |\u03c8\u27e9| \u2265\u03b5) \u22642 exp\n\u0012\n\u22122n\u03b52\n18\u03c03\n\u0013\n.\n(263)\nProof. To apply Levy\u2019s lemma, we consider the function f(\u03c8) = \u27e8\u03c8| O |\u03c8\u27e9and compute its expected\nvalue and Lipschitz constant. First, we observe that\nE\n|\u03c8\u27e9\u223c\u00b5H[f(\u03c8)] =\nE\n|\u03c8\u27e9\u223c\u00b5H[\u27e8\u03c8| O |\u03c8\u27e9] = Tr\n\u0014\nO\nE\n|\u03c8\u27e9\u223c\u00b5H |\u03c8\u27e9\u27e8\u03c8|\n\u0015\n= Tr(O)\nd\n.\n(264)\nNext, we determine the Lipschitz constant. We have\n|f(v) \u2212f(w)| = |Tr [(|u\u27e9\u27e8u| \u2212|v\u27e9\u27e8v|) O]| \u2264\u2225O\u2225\u221e\u2225|u\u27e9\u27e8u| \u2212|v\u27e9\u27e8v| \u22251\n(265)\n35\n", "37": "where we used the matrix H\u00a8older inequality. We then observe that:\n\u2225|u\u27e9\u27e8u| \u2212|v\u27e9\u27e8v|\u22251 = 2\nq\n1 \u2212|\u27e8u|v\u27e9|2.\n(266)\nThis can be seen by considering Q := |u\u27e9\u27e8u| \u2212|v\u27e9\u27e8v|. The Hermitian matrix Q has a rank of at\nmost 2, which means it can have at most two non-zero eigenvalues denoted as \u03bb1 and \u03bb2. Since\nthe trace of Q is zero, we have \u03bb2 = \u2212\u03bb1. Additionally, we know that Tr\n\u0000Q2\u0001\n= \u03bb2\n1 + \u03bb2\n2 = 2\u03bb2\n1,\nand Tr\n\u0000Q2\u0001\n= 2(1 \u2212|\u27e8u|v\u27e9|2). Therefore, we can conclude that \u03bb1 =\nq\n1 \u2212|\u27e8u|v\u27e9|2. The 1-norm of\nQ is given by \u2225Q\u22251 = |\u03bb1| + |\u03bb2|, which simplifies to \u2225Q\u22251 = 2\nq\n1 \u2212|\u27e8u|v\u27e9|2.\nMoreover, we have the following inequality:\n2\nq\n1 \u2212|\u27e8u|v\u27e9|2 \u22642\np\n2 \u22122 |\u27e8u|v\u27e9| \u22642\np\n2 \u22122 Re(\u27e8u|v\u27e9) = 2\u2225u \u2212v\u22252.\n(267)\nThis implies that\n\u2225|u\u27e9\u27e8u| \u2212|v\u27e9\u27e8v|\u22251 \u22642\u2225u \u2212v\u22252.\n(268)\nHence, we have |f(v) \u2212f(w)| \u22642\u2225O\u2225\u221e\u2225u \u2212v\u22252. By applying Levy\u2019s lemma with the Lipschitz\nconstant of f being 2\u2225O\u2225\u221e, we can conclude.\nCombining Markov\u2019s inequality with higher moments provides a useful trick for computing\nbounds. By using Prob (X \u2265\u03b5) \u2264Prob\n\u0000Xk \u2265\u03b5k\u0001\n\u2264\nE[Xk]\n\u03b5k\n, we can derive bounds based on the\nk-th moment of a random variable. This approach is particularly useful in situations involving\nk-unitary designs, where we can often compute moments only up to a given order.\nAnother useful inequality when averaging over the full Haar measure is the following. If \u03b1 > 0,\nthen Prob [X \u2265\u03b5] \u2264Prob [exp(\u03b1X) \u2265exp(\u03b1\u03b5)] \u2264exp(\u2212\u03b1\u03b5)E [exp(\u03b1X)]. To illustrate an applica-\ntion of this, let us consider an example provided also in the notes of Richard Kueng [45].\nExample 55. Consider a n-qubit state |\u03d5\u27e9\u2208Cd with d = 2n. If we randomly pick a state |\u03c8\u27e9\nfrom the Haar measure, the probability that the overlap between |\u03c8\u27e9and |\u03d5\u27e9is larger than \u03b5 > 0\ndecays double exponentially with the number of qubits n:\nProb\n|\u03c8\u27e9\u223c\u00b5H\nh\n|\u27e8\u03c8|\u03d5\u27e9|2 \u2265\u03b5\ni\n\u22642 exp\n\u0012\n\u2212d\n2\u03b5\n\u0013\n.\n(269)\nProof. We have:\nProb\n|\u03c8\u27e9\u223c\u00b5H\nh\n|\u27e8\u03c8|\u03d5\u27e9|2 \u2265\u03b5\ni\n\u2264Prob\n|\u03c8\u27e9\u223c\u00b5H\n\u0014\nexp\n\u0012d\n2 |\u27e8\u03c8|\u03d5\u27e9|2\n\u0013\n\u2265exp\n\u0012d\n2\u03b5\n\u0013\u0015\n(270)\n\u2264exp\n\u0012\n\u2212d\n2\u03b5\n\u0013\nE\n|\u03c8\u27e9\u223c\u00b5H\n\u0014\nexp\n\u0012d\n2 |\u27e8\u03c8|\u03d5\u27e9|2\n\u0013\u0015\n(271)\n= exp\n\u0012\n\u2212d\n2\u03b5\n\u0013 \u221e\nX\nk=0\n1\nk!\ndk\n2k E |\u27e8\u03c8|\u03d5\u27e9|2k\n(272)\n\u2264exp\n\u0012\n\u2212d\n2\u03b5\n\u0013 \u221e\nX\nk=0\n1\n2k = 2 exp\n\u0012\n\u2212d\n2\u03b5\n\u0013\n.\n(273)\nwhere we used the result of Example 52.\nFor more in-depth exploration of the applications of concentration inequalities in the context\nof Haar random unitaries and k-designs, see [39, 45, 49, 86].\n36\n", "38": "9.3\nApplications in Quantum Machine Learning\nLet us now analyze an application of unitary designs in the context of Quantum Machine Learning,\nspecifically in Variational Quantum Algorithms (VQAs) [32]. In VQAs, the problem at hand is\nformulated as the minimization of a cost function. This cost function is typically constructed using\nthe expectation value of an observable, which is estimated on a quantum computer using a prepared\nquantum state that depends on the parameters of the quantum gates. These gate parameters are\noptimized with a classical optimizer with the goal of minimizing the cost function.\nSpecifically, consider a Hilbert space H associated with an n-qubit system of dimension d = 2n.\nIn VQAs, it is customary to define the cost function as:\nC (\u03b8) := Tr\n\u0002\nU(\u03b8)\u03c10U \u2020(\u03b8)O\n\u0003\n,\n(274)\nwhere O \u2208Herm(H) represents an observable, \u03c10 \u2208S (H) is a fixed initial state, and U(\u03b8) denotes\nthe parameterized unitary transformation (or ansatze) defined as:\nU(\u03b8) =\nL\nY\nl=1\ne\u2212i\u03b8lHl.\n(275)\nHere, L is a positive integer representing the total number of parametrized quantum gates, \u03b8l \u2208R\nare the parameters associated with the parametrized gates, and Hl \u2208Herm(H) are their Hamil-\ntonian generators. In the context of VQAs, it is often assumed that the observable O can be\nexpressed as a linear combination of Pauli operators as:\nO =\nm\nX\ni=1\naiPi,\n(276)\nwhere Pi \u2208{I, X, Y, Z}\u2297n\\{I\u2297n}, m is a positive integer such that m \u2208O (poly(n)) and ai \u2208R\nare coefficients satisfying ai \u2208O (poly(n)) for all i \u2208[m]. These assumptions on O also hold for\nall Hl. It is worth noting that the defined observable O satisfies the properties Tr(O) = 0 and\nTr\n\u0000O2\u0001\n\u2208O (poly(n)2n).\nObservation 56. Let \u03bd be a distribution defined over the set of unitaries {U(\u03b8)}\u03b8\u2208RL. If \u03bd forms\na 2-design distribution5, then the following properties hold:\nE\nU\u223c\u03bd [C(\u03b8)] = 0,\nVar\nU\u223c\u03bd [C(\u03b8)] \u2208O\n\u0012poly(n)\n2n\n\u0013\n.\n(277)\nProof. By Eq.(50), we have:\nE\nU\u223c\u03bd [C(\u03b8)] = Tr\nh\nE\nU\u223c\u03bd\n\u0000U(\u03b8)\u03c10U \u2020(\u03b8)\n\u0001\nO\ni\n= Tr(O)\nd\n= 0,\n(278)\nwhere in the last step we used that O is traceless. The second equality follows from Var\nU\u223c\u03bd [C(\u03b8)] =\nE\nU\u223c\u03bd\n\u0002\nC(\u03b8)2\u0003\n\u2212E\nU\u223c\u03bd [C(\u03b8)]2 and Eq.(51):\nE\nU\u223c\u03bd\n\u0002\nC(\u03b8)2\u0003\n= Tr\nh\nE\nU\u223c\u03bd\n\u0000U \u22972(\u03b8)\u03c1\u22972\n0 U \u2020\u22972(\u03b8)\n\u0001\nO\u22972i\n(279)\n= cI,\u03c1\u22972\n0\nTr\n\u0002\nIO\u22972\u0003\n+ cF,\u03c1\u22972\n0\nTr\n\u0002\nFO\u22972\u0003\n(280)\n= cF,\u03c1\u22972\n0\nTr\n\u0002\nO2\u0003\n,\n(281)\nwhere cF,\u03c1\u22972\n0\n=\nTr(F\u03c1\u22972\n0 )\u2212d\u22121 Tr(\u03c1\u22972\n0 )\nd2\u22121\n=\nTr(\u03c12\n0)\u22122\u2212n\n22n\u22121\n, and in the last step we used that O is traceless.\nThe proof is concluded by noting that cF,\u03c1\u22972\n0\n\u2264\n1\n2n(2n+1) and using that Tr\n\u0002\nO2\u0003\n\u2208O (poly(n)2n).\n5For an analysis with approximate notions of designs, refer to [31].\n37\n", "39": "We can then apply Chebyshev\u2019s inequality, which states that for all \u03b5 > 0 we have:\nProb\nU\u223c\u03bd\n\u0010\f\f\fC(\u03b8) \u2212E\nU\u223c\u03bd [C(\u03b8)]\n\f\f\f \u2265\u03b5\n\u0011\n\u22641\n\u03b52 Var\nU\u223c\u03bd [C(\u03b8)] .\n(282)\nThis inequality provides an upper bound on the probability of encountering a point in the parameter\nspace where the cost function deviates from its expected value by more than \u03b5. In particular, the\nprobability of finding a point with a cost function larger than \u03b5 decays exponentially with the\nnumber of qubits: Prob\nU\u223c\u03bd (|C(\u03b8)| \u2265\u03b5) \u2208O\n\u0010\n\u03b5\u22122 poly(n)\n2n\n\u0011\n.\nSimilarly, with slightly more involved calculations, we can show that the exponential decay also\napplies to the variance of the partial derivatives of the cost function. This phenomenon, where\nthe variance of the partial derivatives of the cost function decays exponentially with the number\nof qubits n, is commonly referred to as Barren Plateaus [30].\nTo analyze the partial derivatives of the cost function, we can express the parameterized unitary\ncircuit U(\u03b8) as the product of two unitary operators: U(\u03b8) = UAUB, where UA = QL\nl=\u00b5+1 e\u2212i\u03b8lHl\nand UB = Q\u00b5\nl=1 e\u2212i\u03b8lHl. Consequently, we can write the partial derivative of the cost function as\nfollows:\n\u2202\u00b5C (\u03b8) = Tr\n\u0002\n(\u2202\u00b5U(\u03b8)) \u03c10U \u2020(\u03b8)O\n\u0003\n+ Tr\n\u0002\nU(\u03b8)\u03c10\n\u0000\u2202\u00b5U \u2020(\u03b8)\n\u0001\nO\n\u0003\n(283)\n= \u2212i Tr\nh\nUAH\u00b5UB\u03c10U \u2020\nBU \u2020\nAO\ni\n+ i Tr\nh\nUAUB\u03c10U \u2020\nBH\u00b5U \u2020\nAO\ni\n(284)\n= i Tr\nh\nUB\u03c10U \u2020\nB\nh\nH\u00b5, U \u2020\nAOUA\nii\n,\n(285)\nwhere we denoted by \u2202\u00b5 the partial derivative with respect to \u03b8\u00b5, we used that \u2202\u00b5U(\u03b8) =\n\u2212iUAH\u00b5UB and the cyclicity of the trace.\nUsing this expression for the partial derivative of\nthe cost function, we can prove the following:\nObservation 57. Let \u03bdA, \u03bdB be probability distributions defined over the sets of unitaries {UA(\u03b8)}\u03b8\u2208RL\u2212\u00b5\nand {UB(\u03b8)}\u03b8\u2208R\u00b5, respectively. Suppose that both \u03bdA and \u03bdB are 2-designs distributions.6 In this\ncase, the following properties hold:\nE\nUA\u223c\u03bdA\nUB\u223c\u03bdB\n[\u2202\u00b5C(\u03b8)] = 0,\nVar\nUA\u223c\u03bdA\nUB\u223c\u03bdB\n[\u2202\u00b5C(\u03b8)] \u2208O\n\u0012poly(n)\n2n \u22121\n\u0013\n.\n(286)\nProof. We have:\nE\nUA\u223c\u03bdA\nUB\u223c\u03bdB\n[\u2202\u00b5C(\u03b8)] = i Tr\n\u0012\nE\nUB\u223c\u03bdBb\n\u0010\nUB\u03c10U \u2020\nB\n\u0011 \u0014\nH\u00b5,\nE\nUA\u223c\u03bdA\n\u0010\nU \u2020\nAOUA\n\u0011\u0015\u0013\n(287)\n= i Tr\n\u0012\nE\nUB\u223c\u03bdB\n\u0010\nUB\u03c10U \u2020\nB\n\u0011 \u0014\nH\u00b5, Tr(O)\nd\nI\n\u0015\u0013\n(288)\n= 0,\n(289)\nwhere we used that O is traceless. Thus, for the variance, we have to compute\nVar\nUA\u223c\u03bdA\nUB\u223c\u03bdB\n[\u2202\u00b5C(\u03b8)] =\nE\nUA\u223c\u03bdA\nUB\u223c\u03bdB\n\u0002\n\u2202\u00b5C(\u03b8)2\u0003\n:\nE\nUA\u223c\u03bdA\nUB\u223c\u03bdB\n\u0002\n\u2202\u00b5C(\u03b8)2\u0003\n= \u2212\nE\nUA\u223c\u03bdA\nUB\u223c\u03bdB\nTr\n\u0010\nUB\u03c10U \u2020\nB\nh\nH\u00b5, U \u2020\nAOUA\ni\u00112\n(290)\n= \u2212\nE\nUA\u223c\u03bdA\nUB\u223c\u03bdB\nTr\n\u0012\nU \u22972\nB \u03c1\u22972\n0 U \u2020\u22972\nB\nh\nH\u00b5, U \u2020\nAOUA\ni\u22972\u0013\n(291)\n= \u2212cF,\u03c1\u22972\nE\nUA\u223c\u03bdA Tr\n\u0012\nF\nh\nH\u00b5, U \u2020\nAOUA\ni\u22972\u0013\n(292)\n= \u2212cF,\u03c1\u22972\nE\nUA\u223c\u03bdA Tr\n\u0012h\nH\u00b5, U \u2020\nAOUA\ni2\u0013\n,\n(293)\n6Check [30] for the case when only one between \u03bdA and \u03bdB is a 2-design.\n38\n", "40": "where in the third equality we utilized Eq.(51) as well as the fact that the trace of a commutator\nis always zero, we have defined cF,\u03c1\u22972\n0\n=\nTr(F\u03c1\u22972\n0 )\u2212d\u22121 Tr(\u03c1\u22972\n0 )\nd2\u22121\n=\nTr(\u03c12\n0)\u2212d\u22121\nd2\u22121\n, and in the last step we\nused the swap-trick. Now, using the fact that:\nTr\n\u0000[A, B]2\u0001\n= 2 Tr(ABAB) \u22122 Tr(AABB) = 2 Tr\n\u0000A\u22972B\u22972F\n\u0001\n\u22122 Tr\n\u0000(A2 \u2297I)B\u22972F\n\u0001\n,\n(294)\nwe have:\nE\nUA\u223c\u03bdA\nUB\u223c\u03bdB\n\u0002\n\u2202\u00b5C(\u03b8)2\u0003\n= \u2212cF,\u03c1\u22972\nE\nUA\u223c\u03bdA Tr\n\u0012h\nH\u00b5, U \u2020\nAOUA\ni2\u0013\n(295)\n= \u22122cF,\u03c1\u22972\n\u0012\nTr\n\u0012\nH\u22972\n\u00b5\nE\nUA\u223c\u03bdA(U \u2020\nAOUA)\u22972F\n\u0013\n\u2212Tr\n\u0012\n(H2\n\u00b5 \u2297I)\nE\nUA\u223c\u03bdA(U \u2020\nAOUA)\u22972F\n\u0013\u0013\n(296)\n= \u22122cF,\u03c1\u22972 \u0000cI,O\u22972 Tr\n\u0000H\u22972\n\u00b5\nI F\n\u0001\n\u2212cI,O\u22972 Tr\n\u0000(H2\n\u00b5 \u2297I) I F\n\u0001\n\u2212cF,O\u22972 Tr\n\u0000(H2\n\u00b5 \u2297I) F F\n\u0001\u0001\n(297)\n= 2dcF,\u03c1\u22972cF,O\u22972 Tr\n\u0000H2\n\u00b5\n\u0001\n,\n(298)\nwhere in the third equality we used again Eq.(51) along with the fact that H\u00b5 is traceless, and we\ndefined cF,O\u22972 as cF,O\u22972 =\nTr(FO\u22972)\u2212d\u22121 Tr(O\u22972)\nd2\u22121\n=\nTr(O2)\nd2\u22121 . Thus, we have:\nE\nUA\u223c\u03bdA\nUB\u223c\u03bdB\n\u0002\n\u2202\u00b5C(\u03b8)2\u0003\n\u2264\n2d\n(d2 \u22121)2 (Tr\n\u0000\u03c12\n0\n\u0001\n\u2212d\u22121) Tr\n\u0000O2\n\u00b5\n\u0001\nTr\n\u0000H2\n\u00b5\n\u0001\n\u22642 Tr\n\u0000O2\u0001\n(2n \u22121)2\nTr\n\u0000H2\n\u00b5\n\u0001\n2n + 1 .\n(299)\nWe can conclude by using that Tr\n\u0002\nO2\u0003\n\u2208O(poly(n)2n) and Tr\n\u0002\nH2\n\u00b5\n\u0003\n\u2208O(poly(n)2n).\nUsing again Chebyshev\u2019s inequality, we can conclude that the probability of finding a point\nin the parameter space with a partial derivative larger than a threshold \u03b5 decreases exponentially\nwith the number of qubits. Specifically, we have:\nProb\nUA\u223c\u03bdA\nUB\u223c\u03bdB\n(|\u2202\u00b5C(\u03b8)| \u2265\u03b5) \u2208O\n\u0012\n\u03b5\u22122 poly(n)\n2n \u22121\n\u0013\n.\n(300)\nThere are several recent works that leverage Haar integration to compute the concentration of\nvariational cost functions. For example, [87\u201389] extend the Barren Plateaus diagnosing method\n(variance computation) to the case where the variational circuit lives in a unitary subgroup (over\nwhich it forms 2-designs), which is particularly relevant in the case of symmetric ansatzes [90, 91].\nAdditionally, see [92\u201394] for cost-concentration analyses in the context of noisy circuits.\n9.4\nClassical shadow tomography\nThe classical shadow protocol, introduced by Huang et al. [1], is a method for predicting properties\nof quantum systems based on the theory of k-designs. In this tutorial, we will explore the classical\nshadow protocol as example of application.\nLet \u03c1 \u2208S\n\u0000Cd\u0001\nbe a quantum state of n-qubits, and let O1, . . . , OM \u2208Herm\n\u0000Cd\u0001\nbe Hermitian\noperators, where d = 2n. The goal is to estimate Tr(O1\u03c1), . . . , Tr(OM\u03c1) with a desired accuracy\nand probability of success. We assume that the full classical description of the state \u03c1 is unknown\nbut it can be \u201cqueried\u201d on a quantum device multiple times. When the state \u03c1 is queried, a unitary\nU is sampled randomly from a probability distribution \u00b5, and it is applied to \u03c1. The resulting\nstate, U\u03c1U \u2020, is measured in the computational basis {|b\u27e9}b\u2208[d]. Information about the sampled\nunitary U and the measurement outcome |b\u27e9is stored in a classical memory, which can be efficiently\nimplemented for appropriately chosen distributions of unitaries. The state U \u2020 |b\u27e9\u27e8b| U is referred\nto as a classical snapshot.\nNow, the expected value of the classical snapshot E\n\u0002\nU \u2020 |b\u27e9\u27e8b| U\n\u0003\nis considered, where U is\ndistributed according to the probability distribution \u00b5, and b is distributed according to the Born\u2019s\nrule probability distribution \u27e8b| U\u03c1U \u2020 |b\u27e9. More explicitly, we can associate a completely positive\ntrace-preserving linear map M (\u03c1) to E\n\u0002\nU \u2020 |b\u27e9\u27e8b| U\n\u0003\n, denoted as measurement channel:\nM (\u03c1) :=\nd\nX\nb=1\nE\nU\u223c\u00b5\n\u0002\n\u27e8b| U\u03c1U \u2020 |b\u27e9U \u2020 |b\u27e9\u27e8b| U\n\u0003\n.\n(301)\n39\n", "41": "Assuming that M is invertible, \u02c6\u03c1 := M\u22121 \u0000U \u2020 |b\u27e9\u27e8b| U\n\u0001\nserves as an unbiased estimator for\n\u03c1, meaning E [\u02c6\u03c1] = \u03c1. The matrix \u02c6\u03c1 is commonly known as the classical shadow of the state \u03c1.\nConsequently, \u02c6oi := Tr(Oi\u02c6\u03c1) is an unbiased estimator for Tr(Oi\u03c1):\n\u02c6oi := Tr\n\u0000OiM\u22121 \u0000U \u2020 |b\u27e9\u27e8b| U\n\u0001\u0001\nimplies\nE [\u02c6oi] = Tr(Oi\u03c1) for all i \u2208[M].\n(302)\nFor appropriately chosen probability distributions \u00b5, the estimator \u02c6oi can be efficiently computed\nclassically.\nTo estimate the number N of copies of \u03c1 (sample complexity) to achieve an additive accuracy\n\u03b5 > 0 in the estimation of Tr(Oi\u03c1) for all i \u2208[M], with a failure probability of at most \u03b4 > 0, it is\nimportant to bound the variance of the estimator:\nVar (\u02c6oi) := E\n\u0002\n\u02c6o2\ni\n\u0003\n\u2212E [\u02c6oi]2 .\n(303)\nIf the median of means [1, 95] is used as the estimator to post-process the data \u02c6oi for each i \u2208[M],\nthen a number of copies\nN = O\n\u0012log (2M/\u03b4)\n\u03b52\nmax\ni\u2208[m] [Var (\u02c6oi)]\n\u0013\n(304)\nis enough to estimate, for each i \u2208[m], Tr(Oi\u03c1) up to precision \u03b5 with success probability at least\n1 \u2212\u03b4.\nTherefore, the essential ingredients are the construction of the estimator through the inversion\nof the measurement channel M (\u00b7) and bounding the variance. Below we observe that the mea-\nsurement channel M (\u00b7) is related to the second moment operator over the probability distribution\n\u00b5, while the variance is related to a third moment.\nObservation 58.\nM (\u03c1) = Tr1\n \n(\u03c1 \u2297I)\n d\nX\nb=1\nE\nU\u223c\u00b5\nh\nU \u2020\u22972 |b\u27e9\u27e8b|\u22972 U \u22972i!!\n(305)\nVar (\u02c6oi) = Tr\n \n\u0000\u03c1 \u2297M\u22121 (Oi) \u2297M\u22121 (Oi)\n\u0001\n d\nX\nb=1\nE\nU\u223c\u00b5\nh\nU \u2020\u22973 |b\u27e9\u27e8b|\u22973 U \u22973i!!\n\u2212Tr(Oi\u03c1)2. (306)\nProof. For the measurement channel M(\u03c1), we have:\nM (\u03c1) :=\nd\nX\nb=1\nE\nU\u223c\u00b5\n\u0002\n\u27e8b| U\u03c1U \u2020 |b\u27e9U \u2020 |b\u27e9\u27e8b| U\n\u0003\n(307)\n=\nd\nX\nb=1\nE\nU\u223c\u00b5\n\u0002\nTr\n\u0000\u03c1U \u2020 |b\u27e9\u27e8b| U\n\u0001\nU \u2020 |b\u27e9\u27e8b| U\n\u0003\n,\n(308)\n= Tr1\n \n(\u03c1 \u2297I)\n d\nX\nb=1\nE\nU\u223c\u00b5\nh\nU \u2020\u22972 |b\u27e9\u27e8b|\u22972 U \u22972i!!\n.\n(309)\nFor the variance Eq.(303), we need to consider:\nE\n\u0000\u02c6o2\ni\n\u0001 :=\nd\nX\nb=1\nE\nU\u223c\u00b5\nh\n\u27e8b| U\u03c1U \u2020 |b\u27e9Tr\n\u0000OiM\u22121 \u0000U \u2020 |b\u27e9\u27e8b| U\n\u0001\u00012i\n.\n(310)\nWe first observe that Tr(AM (B)) = Pd\nb=1 E\nU\u223c\u00b5\n\u0002\n\u27e8b| UBU \u2020 |b\u27e9\u27e8b| UAU \u2020 |b\u27e9\n\u0003\n= Tr(M (A) B) for\nall A, B \u2208L\n\u0000Cd\u0001\n. This implies that Tr\n\u0000AM\u22121 (B)\n\u0001\n= Tr\n\u0000M\u22121 (A) B\n\u0001\nfor all A, B \u2208L\n\u0000Cd\u0001\n.\n40\n", "42": "Therefore:\nE\n\u0000\u02c6o2\ni\n\u0001\n=\nd\nX\nb=1\nE\nU\u223c\u00b5\nh\n\u27e8b| U\u03c1U \u2020 |b\u27e9Tr\n\u0000M\u22121 (Oi) U \u2020 |b\u27e9\u27e8b| U\n\u00012i\n(311)\n=\nd\nX\nb=1\nE\nU\u223c\u00b5\nh\nTr\n\u0000\u03c1U \u2020 |b\u27e9\u27e8b| U\n\u0001\nTr\n\u0000M\u22121 (Oi) U \u2020 |b\u27e9\u27e8b| U\n\u00012i\n(312)\n= Tr\n \n\u0000\u03c1 \u2297M\u22121 (Oi) \u2297M\u22121 (Oi)\n\u0001\n d\nX\nb=1\nE\nU\u223c\u00b5\nh\nU \u2020\u22973 |b\u27e9\u27e8b|\u22973 U \u22973i!!\n.\n(313)\nWe will now consider the unitary probability distribution that corresponds to the uniform\ndistribution over the Clifford group, that we defined in Eq.(188). It is important to remember that\nthe any unitary of the Clifford group can be implemented with O(n2/ log(n)) elementary gates [72]\nand that there are efficient algorithms to sample uniformly from the Clifford group [73, 74].\nSince the uniform distribution over the Clifford group is an exact 3-design, its first three mo-\nments coincide with those of the Haar measure. Thus, we need to insert in Eq.(305) the formula\nfor the second moment over the Haar measure to find the expression of the measurement channel\nM (\u03c1) and then invert it.\nObservation 59. The measurement channel is:\nM (\u03c1) =\n1\nd + 1 (Tr(\u03c1) I + \u03c1) .\n(314)\nThus, its inverse is:\nM\u22121 (\u03c1) = (d + 1)\u03c1 \u2212Tr(\u03c1) I.\n(315)\nProof. We have:\nM (\u03c1) =\nd\nX\nb=1\nTr1\n\u0012\n(\u03c1 \u2297I) E\nU\u223c\u00b5\nh\nU \u22972 |b\u27e9\u27e8b|\u22972 U \u2020\u22972i\u0013\n(316)\n=\nd\nX\nb=1\nTr1\n\u0012\n(\u03c1 \u2297I)\nI + F\nd(d + 1)\n\u0013\n(317)\n=\n1\nd + 1 (Tr(\u03c1) I + \u03c1) ,\n(318)\nwhere in the second equality we utilized Eq.(95) and in the second equality the partial-swap-trick\n(152).\nTherefore, we have that M\u22121 (\u03c1) = (d + 1)\u03c1 \u2212Tr(\u03c1) I, since it can be easily verified that this\nexpression satisfies M\u22121 (M (\u03c1)) = \u03c1.\nTo bound the variance we need to compute a third moment over the Haar measure of the\nunitary group, due to the 3-design property of the Clifford group.\nObservation 60. The variance is bounded by Var (\u02c6oi) \u22643 Tr\n\u0000O2\ni\n\u0001\n.\nProof. By utilizing Observation 58, we have:\nVar (\u02c6oi) = Tr\n \n\u0000\u03c1 \u2297M\u22121 (Oi) \u2297M\u22121 (Oi)\n\u0001\n d\nX\nb=1\nE\nU\u223c\u00b5\nh\nU \u2020\u22973 |b\u27e9\u27e8b|\u22973 U \u22973i!!\n\u2212Tr(Oi\u03c1)2. (319)\n41\n", "43": "Using Proposition 3, we know that\nE\nU\u223c\u00b5\nh\nU \u2020\u22973 |b\u27e9\u27e8b|\u22973 U \u22972i\n=\nE\nU\u223c\u00b5\nh\nU \u22973 |b\u27e9\u27e8b|\u22973 U \u2020\u22973i\n. Therefore\nby applying Eq.(95), we can express the third moment as:\nE\nU\u223c\u00b5\nh\nU \u2020\u22973 |b\u27e9\u27e8b|\u22973 U \u22973i\n=\n1\nd(d + 1)(d + 2)\n X\n\u03c0\u2208S3\nVd(\u03c0)\n!\n(320)\n=\n1\nd(d + 1)(d + 2)\n \n+\n+\n+\n+\n+\n!\n,\n(321)\nwhere we used the Tensor Network representation of permutations defined in Section 6. Substi-\ntuting this expression into the first term of Eq.(319), up to a global factor ((d + 1)(d + 2))\u22121, we\nhave :\nTr\n \n\u0000\u03c1 \u2297M\u22121 (Oi) \u2297M\u22121 (Oi)\n\u0001\n X\n\u03c0\u2208S3\nVd(\u03c0)\n!!\n= Tr\n\uf8eb\n\uf8ec\n\uf8ec\n\uf8ec\n\uf8ed\n\u2133\u22121(O)\n\u2133\u22121(O)\n\u03c1\n\uf8eb\n\uf8ed\n+\n+\n+\n+\n+\n\uf8f6\n\uf8f8\n\uf8f6\n\uf8f7\n\uf8f7\n\uf8f7\n\uf8f8\n= Tr(\u03c1) Tr\n\u0000M\u22121 (Oi)\n\u0001\nTr\n\u0000M\u22121 (Oi)\n\u0001\n+ Tr(\u03c1) Tr\n\u0010\nM\u22121 (Oi)2\u0011\n+ Tr\n\u0000\u03c1M\u22121 (Oi)\n\u0001\nTr\n\u0000M\u22121 (Oi)\n\u0001\n+ Tr\n\u0010\n\u03c1M\u22121 (Oi)2\u0011\n+ Tr\n\u0010\n\u03c1M\u22121 (Oi)2\u0011\n+ Tr\n\u0000\u03c1M\u22121 (Oi)\n\u0001\nTr\n\u0000M\u22121 (Oi)\n\u0001\n.\n(322)\nTo simplify the calculations, we can utilize a trick exploited in [1], namely that the variance Var (\u02c6oi)\nonly depends on the traceless part of the operator Oi, which is defined as O(0)\ni\n:= Oi \u2212Tr(Oi) I\nd.\nThis follows by using that Var (\u02c6oi) = E\nh\n(\u02c6oi \u2212Tr(Oi\u03c1))2i\nand observing that \u02c6oi \u2212Tr(Oi\u03c1) only\ndepends on the traceless part of Oi. In fact, by denoting \u02c6\u03c1 = M\u22121 \u0000U \u2020 |b\u27e9\u27e8b| U\n\u0001\n, we have:\n\u02c6oi \u2212Tr(Oi\u03c1) = Tr(Oi\u02c6\u03c1) \u2212Tr(Oi\u03c1) = Tr\n\u0010\nO(0)\ni\n\u02c6\u03c1\n\u0011\n\u2212Tr\n\u0010\nO(0)\ni\n\u03c1\n\u0011\n,\n(323)\nwhere we used that Tr(\u02c6\u03c1) = 1, since M\u22121 is trace-preserving (because M is trace-preserving).\nTherefore, by substituting Oi with O(0)\ni\nin Eq.(322), the right-hand side simplifies nicely:\nTr\n \u0010\n\u03c1 \u2297M\u22121 \u0010\nO(0)\ni\n\u0011\n\u2297M\u22121 \u0010\nO(0)\ni\n\u0011\u0011  X\n\u03c0\u2208S3\nVd(\u03c0)\n!!\n(324)\n= 0 + Tr(\u03c1) Tr\n\u0012\nM\u22121 \u0010\nO(0)\ni\n\u00112\u0013\n+ 0 + Tr\n\u0012\n\u03c1M\u22121 \u0010\nO(0)\ni\n\u00112\u0013\n+ Tr\n\u0012\n\u03c1M\u22121 \u0010\nO(0)\ni\n\u00112\u0013\n+ 0\n(325)\n= (d + 1)2 Tr\n\u0010\nO(0)2\ni\n\u0011\n+ 2(d + 1)2 Tr\n\u0010\n\u03c1O(0)2\ni\n\u0011\n,\n(326)\nwhere we used the fact, according to Eq.(315), that M\u22121 \u0010\nO(0)\ni\n\u0011\n= (d + 1)O(0)\ni\nis traceless. Sub-\nstituting this expression back into Eq.(319), we have:\nVar (\u02c6oi) =\n(d + 1)2\n(d + 1)(d + 2)\n\u0010\nTr\n\u0010\nO(0)2\ni\n\u0011\n+ 2 Tr\n\u0010\n\u03c1O(0)2\ni\n\u0011\u0011\n\u2212Tr\n\u0010\nO(0)\ni\n\u03c1\n\u00112\n(327)\n\u2264Tr\n\u0010\nO(0)2\ni\n\u0011\n+ 2 Tr\n\u0010\n\u03c1O(0)2\ni\n\u0011\n(328)\n\u22643 Tr\n\u0010\nO(0)2\ni\n\u0011\n,\n(329)\nwhere in the second step we used that I \u2212\u03c1 is positive semi-definite, and therefore Tr\n\u0010\n\u03c1O(0)2\ni\n\u0011\n\u2264\nTr\n\u0010\nO(0)2\ni\n\u0011\n.\nFinally, we conclude the proof by noting that Tr\n\u0010\nO(0)2\ni\n\u0011\n\u2264Tr\n\u0000O2\ni\n\u0001\n.\n42\n", "44": "Using the previous bound on the variance, we have that a number of copies\nN = O\n\u0012\n\u03b5\u22122 log (2M/\u03b4) max\ni\u2208[m]\n\u0002\nTr\n\u0000O2\ni\n\u0001\u0003\u0013\n(330)\nsuffices to estimate, for each i \u2208[m], Tr(Oi\u03c1) up to precision \u03b5 and with success probability at\nleast 1 \u2212\u03b4. Therefore, if we want to estimate observables with bounded 2-norm, we have that\nthe protocol is sample-efficient. However, it is important to emphasize that sampling efficiency\ndoes not imply that the protocol described is computationally efficient; in fact, to guarantee it,\nwe must also be able to compute the unbiased estimator in Eq.(302) in a time-efficient manner.\nThis is known for observables that have a particular structure such as stabilizer states (i.e., states\nconstructed by the application of a Clifford circuit to a computational basis state); in this case,\none can take advantage of the fact that computing the overlap between two stabilizer states can\nbe done efficiently in classical computational time [72].\nSee [1] for more details and also for\nchecking the interesting case in which the uniform distribution over the unitary set formed by the\ntensor product of single-qubit Clifford gates is considered, which is better known as \u201crandom Pauli\nbasis\u201d. In this case, it turns out that the shadow protocol is both sample and time efficient for local\nobservables like Paulis supported on a constant number of qubits. To explore additional examples\nof unitary distributions, one may refer for example to [96], which discusses the utilization of the\nfermionic Gaussian unitaries distribution, or to [97, 98], where unitary distributions generated by\nlocal random quantum circuits are investigated. Additionally, [99] analyzes Pauli-invariant unitary\nensembles.\n10\nAcknowledgments\nI thank Dax Enshan Koh, Hakop Pashayan, Philippe Faist, Johannes Jakob Meyer, Janek Denzler,\nLorenzo Leone, Ellen Derbishire, Alexander Nietner, Francesco Anna Mele and Carlos Bravo-Prieto\nfor insightful discussions and feedback. I am also grateful to the QML journal club of Jens Eisert\u2019s\ngroup for providing me the motivation to write this tutorial.\nReferences\n[1]\nH.-Y. Huang, R. Kueng, and J. Preskill, \u201cPredicting many properties of a quantum system\nfrom very few measurements\u201d, Nature Physics 16, 1050\u20131057 (2020) doi: 10.1038/s41567-\n020-0932-7.\n[2]\nJ. Haah, A. W. Harrow, Z. Ji, X. Wu, and N. Yu, \u201cSample-optimal tomography of quantum\nstates\u201d, IEEE Transactions on Information Theory, 1\u20131 (2017) doi: 10.1109/tit.2017.\n2719044.\n[3]\nA. Elben, S. T. Flammia, H.-Y. Huang, R. Kueng, J. Preskill, B. Vermersch, and P. Zoller,\n\u201cThe randomized measurement toolbox\u201d, Nature Reviews Physics 5, 9\u201324 (2022) doi: 10.\n1038/s42254-022-00535-2.\n[4]\nR. O\u2019Donnell and J. Wright, Efficient quantum tomography, 2015, doi: https://doi.org/\n10.48550/arXiv.1508.01907.\n[5]\nR. Kueng, H. Rauhut, and U. Terstiege, \u201cLow rank matrix recovery from rank one measure-\nments\u201d, Applied and Computational Harmonic Analysis 42, 88\u2013116 (2017) doi: 10.1016/j.\nacha.2015.07.007.\n[6]\nA. Elben, R. Kueng, H.-Y. R. Huang, R. van Bijnen, C. Kokail, M. Dalmonte, P. Calabrese,\nB. Kraus, J. Preskill, P. Zoller, and B. Vermersch, \u201cMixed-state entanglement from local\nrandomized measurements\u201d, Phys. Rev. Lett. 125, 200501 (2020) doi: 10.1103/PhysRevLe\ntt.125.200501.\n[7]\nM Gut\u00b8\u02d8a, J Kahn, R Kueng, and J. A. Tropp, \u201cFast state tomography with optimal error\nbounds\u201d, Journal of Physics A: Mathematical and Theoretical 53, 204001 (2020) doi: 10.\n1088/1751-8121/ab8111.\n43\n", "45": "[8]\nP. Cie\u00b4sli\u00b4nski, S. Imai, J. Dziewior, O. G\u00a8uhne, L. Knips, W. Laskowski, J. Meinecke, T.\nPaterek, and T. V\u00b4ertesi, Analysing quantum systems with randomised measurements, 2023,\ndoi: https://doi.org/10.48550/arXiv.2307.01251.\n[9]\nA. W. Harrow and S. Mehraban, \u201cApproximate unitary t-designs by short random quan-\ntum circuits using nearest-neighbor and long-range gates\u201d, Communications in Mathematical\nPhysics 401, 1531\u20131626 (2023) doi: 10.1007/s00220-023-04675-z.\n[10]\nA. Bouland, B. Fefferman, C. Nirkhe, and U. Vazirani, \u201cOn the complexity and verification\nof quantum random circuit sampling\u201d, Nature Physics 15, 159\u2013163 (2018) doi: 10.1038/\ns41567-018-0318-2.\n[11]\nR. Movassagh, Quantum supremacy and random circuits, 2020, doi: https://doi.org/10.\n48550/arXiv.1909.06210.\n[12]\nA. M. Dalzell, N. Hunter-Jones, and F. G. S. L. Brand\u02dcao, Random quantum circuits transform\nlocal noise into global white noise, 2021, doi: https://doi.org/10.48550/arXiv.2111.\n14907.\n[13]\nD. Hangleiter, J. Bermejo-Vega, M. Schwarz, and J. Eisert, \u201cAnticoncentration theorems for\nschemes showing a quantum speedup\u201d, Quantum 2, 65 (2018) doi: 10.22331/q-2018-05-\n22-65.\n[14]\nA. Bouland, J. F. Fitzsimons, and D. E. Koh, \u201cComplexity Classification of Conjugated\nClifford Circuits\u201d, in 33rd computational complexity conference (ccc 2018), Vol. 102, edited\nby R. A. Servedio, Leibniz International Proceedings in Informatics (LIPIcs) (2018), 21:1\u2013\n21:25, doi: 10.4230/LIPIcs.CCC.2018.21.\n[15]\nH. Pashayan, S. D. Bartlett, and D. Gross, \u201cFrom estimation of quantum probabilities to\nsimulation of quantum circuits\u201d, Quantum 4, 223 (2020) doi: 10.22331/q-2020-01-13-223.\n[16]\nD. Hangleiter and J. Eisert, \u201cComputational advantage of quantum random sampling\u201d, Re-\nviews of Modern Physics 95, doi: 10.1103/revmodphys.95.035001 (2023) doi: 10.1103/\nrevmodphys.95.035001.\n[17]\nS. Popescu, A. J. Short, and A. Winter, \u201cEntanglement and the foundations of statistical\nmechanics\u201d, Nature Physics 2, 754\u2013758 (2006) doi: 10.1038/nphys444.\n[18]\nJ. Emerson, R. Alicki, and K. \u02d9Z yczkowski, \u201cScalable noise estimation with random unitary\noperators\u201d, Journal of Optics B: Quantum and Semiclassical Optics 7, S347\u2013S352 (2005)\ndoi: 10.1088/1464-4266/7/10/021.\n[19]\nJ. Helsen, I. Roth, E. Onorati, A. Werner, and J. Eisert, \u201cGeneral framework for randomized\nbenchmarking\u201d, PRX Quantum 3, doi: 10.1103/prxquantum.3.020357 (2022) doi: 10.\n1103/prxquantum.3.020357.\n[20]\nE. Magesan, J. M. Gambetta, and J. Emerson, \u201cScalable and robust randomized benchmark-\ning of quantum processes\u201d, Phys. Rev. Lett. 106, 180504 (2011) doi: 10.1103/PhysRevLett.\n106.180504.\n[21]\nD. DiVincenzo, D. Leung, and B. Terhal, \u201cQuantum data hiding\u201d, IEEE Transactions on\nInformation Theory 48, 580\u2013598 (2002) doi: 10.1109/18.985948.\n[22]\nA. Harrow, P. Hayden, and D. Leung, \u201cSuperdense coding of quantum states\u201d, Physical\nReview Letters 92, doi: 10.1103/physrevlett.92.187901 (2004) doi: 10.1103/physrevl\nett.92.187901.\n[23]\nA. Ambainis, J. Bouda, and A. Winter, \u201cNonmalleable encryption of quantum information\u201d,\nJournal of Mathematical Physics 50, 042106 (2009) doi: 10.1063/1.3094756.\n[24]\nM. Horodecki, P. Horodecki, and R. Horodecki, \u201cGeneral teleportation channel, singlet frac-\ntion, and quasidistillation\u201d, Phys. Rev. A 60, 1888\u20131898 (1999) doi: 10.1103/PhysRevA.\n60.1888.\n[25]\nA. Abeyesinghe, I. Devetak, P. Hayden, and A. Winter, \u201cThe mother of all protocols: re-\nstructuring quantum information\u2019s family tree\u201d, Proceedings of the Royal Society A: Math-\nematical, Physical and Engineering Sciences 465, 2537\u20132563 (2009) doi: 10.1098/rspa.\n2009.0202.\n44\n", "46": "[26]\nM. Horodecki and P. Horodecki, \u201cReduction criterion of separability and limits for a class of\ndistillation protocols\u201d, Phys. Rev. A 59, 4206\u20134216 (1999) doi: 10.1103/PhysRevA.59.4206.\n[27]\nJ. Batle-Vallespir, Characterization of quantum entangled states and information measures,\n2006, doi: https://doi.org/10.48550/arXiv.quant-ph/0603124.\n[28]\nK. \u02d9Zyczkowski, P. Horodecki, A. Sanpera, and M. Lewenstein, \u201cVolume of the set of separable\nstates\u201d, Physical Review A 58, 883\u2013892 (1998) doi: 10.1103/physreva.58.883.\n[29]\nK. Zyczkowski and H.-J. Sommers, \u201cInduced measures in the space of mixed quantum states\u201d,\nJournal of Physics A: Mathematical and General 34, 7111\u20137125 (2001) doi: 10.1088/0305-\n4470/34/35/335.\n[30]\nJ. R. McClean, S. Boixo, V. N. Smelyanskiy, R. Babbush, and H. Neven, \u201cBarren plateaus\nin quantum neural network training landscapes\u201d, Nature Communications 9, doi: 10.1038/\ns41467-018-07090-4 (2018) doi: 10.1038/s41467-018-07090-4.\n[31]\nZ. Holmes, K. Sharma, M. Cerezo, and P. J. Coles, \u201cConnecting ansatz expressibility to\ngradient magnitudes and barren plateaus\u201d, PRX Quantum 3, doi: 10.1103/prxquantum.3.\n010313 (2022) doi: 10.1103/prxquantum.3.010313.\n[32]\nM. Cerezo, A. Arrasmith, R. Babbush, S. C. Benjamin, S. Endo, K. Fujii, J. R. McClean,\nK. Mitarai, X. Yuan, L. Cincio, and P. J. Coles, \u201cVariational quantum algorithms\u201d, Nature\nReviews Physics 3, 625\u2013644 (2021) doi: 10.1038/s42254-021-00348-9.\n[33]\nJ. Napp, Quantifying the barren plateau phenomenon for a model of unstructured variational\nans\u00a8atze, 2022, doi: https://doi.org/10.48550/arXiv.2203.06174.\n[34]\nB. Skinner, J. Ruhman, and A. Nahum, \u201cMeasurement-induced phase transitions in the\ndynamics of entanglement\u201d, Phys. Rev. X 9, 031009 (2019) doi: 10.1103/PhysRevX.9.\n031009.\n[35]\nM. P. Fisher, V. Khemani, A. Nahum, and S. Vijay, \u201cRandom quantum circuits\u201d, Annual\nReview of Condensed Matter Physics 14, 335\u2013379 (2023) doi: 10.1146/annurev-conmatph\nys-031720-030658.\n[36]\nA. Chan, A. De Luca, and J. T. Chalker, \u201cSolution of a minimal model for many-body\nquantum chaos\u201d, Phys. Rev. X 8, 041019 (2018) doi: 10.1103/PhysRevX.8.041019.\n[37]\nP. Hayden and J. Preskill, \u201cBlack holes as mirrors: quantum information in random sub-\nsystems\u201d, Journal of High Energy Physics 2007, 120\u2013120 (2007) doi: 10 . 1088 / 1126 -\n6708/2007/09/120.\n[38]\nJ. Haferkamp, P. Faist, N. B. T. Kothakonda, J. Eisert, and N. Y. Halpern, \u201cLinear growth\nof quantum circuit complexity\u201d, Nature Physics 18, 528\u2013532 (2022) doi: 10.1038/s41567-\n022-01539-6.\n[39]\nF. G. Brand\u02dcao, W. Chemissany, N. Hunter-Jones, R. Kueng, and J. Preskill, \u201cModels of\nquantum complexity growth\u201d, PRX Quantum 2, doi: 10.1103/prxquantum.2.030316\n(2021) doi: 10.1103/prxquantum.2.030316.\n[40]\nD. A. Roberts and B. Yoshida, \u201cChaos and complexity by design\u201d, Journal of High Energy\nPhysics 2017, doi: 10.1007/jhep04(2017)121 (2017) doi: 10.1007/jhep04(2017)121.\n[41]\nZ.-W. Liu, S. Lloyd, E. Zhu, and H. Zhu, \u201cEntanglement, quantum randomness, and complex-\nity beyond scrambling\u201d, Journal of High Energy Physics 2018, doi: 10.1007/jhep07(2018)\n041 (2018) doi: 10.1007/jhep07(2018)041.\n[42]\nE. Onorati, O. Buerschaper, M. Kliesch, W. Brown, A. H. Werner, and J. Eisert, \u201cMixing\nproperties of stochastic quantum hamiltonians\u201d, Communications in Mathematical Physics\n355, 905\u2013947 (2017) doi: 10.1007/s00220-017-2950-6.\n[43]\nO. Shtanko and R. Movassagh, \u201cStability of periodically driven topological phases against\ndisorder\u201d, Phys. Rev. Lett. 121, 126803 (2018) doi: 10.1103/PhysRevLett.121.126803.\n[44]\nR. Movassagh and A. Edelman, \u201cDensity of states of quantum spin systems from isotropic\nentanglement\u201d, Phys. Rev. Lett. 107, 097205 (2011) doi: 10.1103/PhysRevLett.107.\n097205.\n45\n", "47": "[45]\nR. J. Kueng and J. Tropp, Quantum and classical information processing with tensors, 2019,\ndoi: https://doi.org/10.7907/my9r-p178.\n[46]\nM. Christandl, The structure of bipartite quantum states - insights from group theory and\ncryptography, 2006, doi: https://doi.org/10.48550/arXiv.quant-ph/0604183.\n[47]\nM. Kliesch and I. Roth, \u201cTheory of quantum system certification\u201d, PRX Quantum 2, doi:\n10.1103/prxquantum.2.010201 (2021) doi: 10.1103/prxquantum.2.010201.\n[48]\nJ. Haferkamp, \u201cRandomness and complexity in random complex quantum systems\u201d, Disser-\ntation (2022), doi: http://dx.doi.org/10.17169/refubium-38286.\n[49]\nR. A. Low, Pseudo-randomness and learning in quantum computation, 2010, doi: https:\n//doi.org/10.48550/arXiv.1006.5227.\n[50]\nJ. Watrous, The theory of quantum information (Cambridge University Press, 2018), doi:\n10.1017/9781316848142.\n[51]\nB. Collins and P. \u00b4Sniady, \u201cIntegration with respect to the haar measure on unitary, orthogonal\nand symplectic group\u201d, Communications in Mathematical Physics 264, 773\u2013795 (2006) doi:\n10.1007/s00220-006-1554-3.\n[52]\nB. Simon, \u201cRepresentations of finite and compact groups\u201d, in (1995), doi: https://doi.\norg/10.1090/gsm/010.\n[53]\nR. Goodman and N. Wallach, \u201cSymmetry, representations, and invariants\u201d, in (2009), doi:\nhttps://doi.org/10.1007/978-0-387-79852-3.\n[54]\nL. Zhang, Matrix integrals over unitary groups: an application of schur-weyl duality, 2015,\ndoi: https://doi.org/10.48550/arXiv.1408.3782.\n[55]\nB. Collins, Moments and cumulants of polynomial random variables on unitary groups, the\nitzykson-zuber integral and free probability, 2002, doi: https://doi.org/10.48550/arXiv.\nmath-ph/0205010.\n[56]\nD. Weingarten, \u201cAsymptotic Behavior of Group Integrals in the Limit of Infinite Rank\u201d, J.\nMath. Phys. 19, 999 (1978) doi: 10.1063/1.523807.\n[57]\nB. Collins, S. Matsumoto, and J. Novak, \u201cThe weingarten calculus\u201d, Notices of the American\nMathematical Society 69, 1 (2022) doi: 10.1090/noti2474.\n[58]\nG. K\u00a8ostenberger, Weingarten calculus, 2021, doi: https://doi.org/10.48550/arXiv.\n2101.00921.\n[59]\nF. G. S. L. Brand\u02dcao, A. W. Harrow, and M. Horodecki, \u201cLocal random quantum circuits are\napproximate polynomial-designs\u201d, Communications in Mathematical Physics 346, 397\u2013434\n(2016) doi: 10.1007/s00220-016-2706-8.\n[60]\nD. Garc\u00b4\u0131a-Mart\u00b4\u0131n, M. Larocca, and M. Cerezo, Deep quantum neural networks form gaussian\nprocesses, 2023, doi: https://doi.org/10.48550/arXiv.2305.09957.\n[61]\nA. W. Harrow, The church of the symmetric subspace, 2013, doi: https://doi.org/10.\n48550/arXiv.1308.6595.\n[62]\nJ. C. Bridgeman and C. T. Chubb, \u201cHand-waving and interpretive dance: an introductory\ncourse on tensor networks\u201d, Journal of Physics A: Mathematical and Theoretical 50, 223001\n(2017) doi: 10.1088/1751-8121/aa6dc3.\n[63]\nM. A. Nielsen and I. L. Chuang, Quantum computation and quantum information: 10th\nanniversary edition (Cambridge University Press, 2010), doi: 10.1017/CBO9780511976667.\n[64]\nC. Dankert, R. Cleve, J. Emerson, and E. Livine, \u201cExact and approximate unitary 2-designs\nand their application to fidelity estimation\u201d, Physical Review A 80, doi: 10.1103/physreva.\n80.012304 (2009) doi: 10.1103/physreva.80.012304.\n[65]\nD. Gross, K. Audenaert, and J. Eisert, \u201cEvenly distributed unitaries: on the structure of\nunitary designs\u201d, Journal of Mathematical Physics 48, doi: 10.1063/1.2716992 (2007) doi:\n10.1063/1.2716992.\n[66]\nA. Roy and A. J. Scott, \u201cUnitary designs and codes\u201d, Designs, Codes and Cryptography 53,\n13\u201331 (2009) doi: 10.1007/s10623-009-9290-2.\n46\n", "48": "[67]\nA. Ambainis and J. Emerson, Quantum t-designs: t-wise independence in the quantum world,\n2007, doi: https://doi.org/10.48550/arXiv.quant-ph/0701126.\n[68]\nD. Gottesman, The heisenberg representation of quantum computers, 1998, doi: https://\ndoi.org/10.48550/arXiv.quant-ph/9807006.\n[69]\nZ. Webb, The clifford group forms a unitary 3-design, 2016, doi: https://doi.org/10.\n48550/arXiv.1510.02769.\n[70]\nH. Zhu, \u201cMultiqubit clifford groups are unitary 3-designs\u201d, Physical Review A 96, doi:\n10.1103/physreva.96.062336 (2017) doi: 10.1103/physreva.96.062336.\n[71]\nH. Zhu, R. Kueng, M. Grassl, and D. Gross, The clifford group fails gracefully to be a unitary\n4-design, 2016, doi: https://doi.org/10.48550/arXiv.1609.08172.\n[72]\nS. Aaronson and D. Gottesman, \u201cImproved simulation of stabilizer circuits\u201d, Physical Review\nA 70, doi: 10.1103/physreva.70.052328 (2004) doi: 10.1103/physreva.70.052328.\n[73]\nE. Van Den Berg, \u201cA simple method for sampling random clifford operators\u201d, in 2021 ieee\ninternational conference on quantum computing and engineering (qce) (2021), pp. 54\u201359,\ndoi: 10.1109/QCE52317.2021.00021.\n[74]\nR. Koenig and J. A. Smolin, \u201cHow to efficiently select an arbitrary clifford group element\u201d,\nJournal of Mathematical Physics 55, 122202 (2014) doi: 10.1063/1.4903507.\n[75]\nM. Wilde, \u201cQuantum information theory\u201d, in\n(Cambridge University Press, 2016), doi:\n10.1017/9781316809976.001.\n[76]\nJ. Haferkamp, \u201cRandom quantum circuits are approximate unitary t-designs in depth O\n\u0000nt5+o(1)\u0001\n\u201d,\nQuantum 6, 795 (2022) doi: 10.22331/q-2022-09-08-795.\n[77]\nA. W. Harrow and R. A. Low, \u201cRandom quantum circuits are approximate 2-designs\u201d, Com-\nmunications in Mathematical Physics 291, 257\u2013302 (2009) doi: 10.1007/s00220- 009-\n0873-6.\n[78]\nA. W. Harrow and S. Mehraban, \u201cApproximate unitary t-designs by short random quan-\ntum circuits using nearest-neighbor and long-range gates\u201d, Communications in Mathematical\nPhysics 401, 1531\u20131626 (2023) doi: 10.1007/s00220-023-04675-z.\n[79]\nE. Knill, D. Leibfried, R. Reichle, J. Britton, R. B. Blakestad, J. D. Jost, C. Langer, R. Ozeri,\nS. Seidelin, and D. J. Wineland, \u201cRandomized benchmarking of quantum gates\u201d, Physical\nReview A 77, doi: 10.1103/physreva.77.012307 (2008) doi: 10.1103/physreva.77.\n012307.\n[80]\nM. A. Nielsen, \u201cA simple formula for the average gate fidelity of a quantum dynamical\noperation\u201d, Physics Letters A 303, 249\u2013252 (2002) doi: 10.1016/s0375-9601(02)01272-0.\n[81]\nE. Lubkin and T. Lubkin, \u201cAverage quantal behavior and thermodynamic isolation\u201d, Inter-\nnational Journal of Theoretical Physics 32, 933\u2013943 (1993) doi: 10.1007/BF01215300.\n[82]\nE. Ram and I. Sason, On renyi entropy power inequalities, 2016, doi: https://doi.org/\n10.48550/arXiv.1601.06555.\n[83]\nD. N. Page, \u201cAverage entropy of a subsystem\u201d, Physical Review Letters 71, 1291\u20131294 (1993)\ndoi: 10.1103/physrevlett.71.1291.\n[84]\nP. Hayden, D. W. Leung, and A. Winter, \u201cAspects of generic entanglement\u201d, Communications\nin Mathematical Physics 265, 95\u2013117 (2006) doi: 10.1007/s00220-006-1535-6.\n[85]\nM. Ledoux, \u201cThe concentration of measure phenomenon\u201d, AMS Surveys and Monographs\n89, doi: https://doi.org/10.1090/surv/089 (2001) doi: https://doi.org/10.1090/\nsurv/089.\n[86]\nR. A. Low, \u201cLarge deviation bounds for k-designs\u201d, Proceedings of the Royal Society A:\nMathematical, Physical and Engineering Sciences 465, 3289\u20133308 (2009) doi: 10.1098/\nrspa.2009.0232.\n[87]\nM. Larocca, P. Czarnik, K. Sharma, G. Muraleedharan, P. J. Coles, and M. Cerezo, \u201cDiag-\nnosing barren plateaus with tools from quantum optimal control\u201d, Quantum 6, 824 (2022)\ndoi: 10.22331/q-2022-09-29-824.\n47\n", "49": "[88]\nE. Fontana, D. Herman, S. Chakrabarti, N. Kumar, R. Yalovetzky, J. Heredge, S. H. Suresh-\nbabu, and M. Pistoia, The adjoint is all you need: characterizing barren plateaus in quantum\nans\u00a8atze, 2023, doi: https://doi.org/10.48550/arXiv.2309.07902.\n[89]\nM. Ragone, B. N. Bakalov, F. Sauvage, A. F. Kemper, C. O. Marrero, M. Larocca, and M.\nCerezo, A unified theory of barren plateaus for deep parametrized quantum circuits, 2023,\ndoi: https://doi.org/10.48550/arXiv.2309.09342.\n[90]\nM. Larocca, F. Sauvage, F. M. Sbahi, G. Verdon, P. J. Coles, and M. Cerezo, \u201cGroup-invariant\nquantum machine learning\u201d, PRX Quantum 3, doi: 10.1103/prxquantum.3.030341 (2022)\ndoi: 10.1103/prxquantum.3.030341.\n[91]\nJ. J. Meyer, M. Mularski, E. Gil-Fuster, A. A. Mele, F. Arzani, A. Wilms, and J. Eisert,\n\u201cExploiting symmetry in variational quantum machine learning\u201d, PRX Quantum 4, doi:\n10.1103/prxquantum.4.010328 (2023) doi: 10.1103/prxquantum.4.010328.\n[92]\nS. Wang, E. Fontana, M. Cerezo, K. Sharma, A. Sone, L. Cincio, and P. J. Coles, \u201cNoise-\ninduced barren plateaus in variational quantum algorithms\u201d, Nature Communications 12,\ndoi: 10.1038/s41467-021-27045-6 (2021) doi: 10.1038/s41467-021-27045-6.\n[93]\nP. Singkanipa and D. A. Lidar, Beyond unital noise in variational quantum algorithms: noise-\ninduced barren plateaus and fixed points, 2024, doi: https://doi.org/10.48550/arXiv.\n2402.08721.\n[94]\nA. A. Mele, A. Angrisani, S. Ghosh, S. Khatri, J. Eisert, D. S. Fran\u00b8ca, and Y. Quek, Noise-\ninduced shallow circuits and absence of barren plateaus, 2024, doi: https://doi.org/10.\n48550/arXiv.2403.13927.\n[95]\nD. E. Koh and S. Grewal, \u201cClassical shadows with noise\u201d, Quantum 6, 776 (2022) doi:\n10.22331/q-2022-08-16-776.\n[96]\nK. Wan, W. J. Huggins, J. Lee, and R. Babbush, \u201cMatchgate shadows for fermionic quantum\nsimulation\u201d, Communications in Mathematical Physics 404, 629\u2013700 (2023) doi: 10.1007/\ns00220-023-04844-0.\n[97]\nH.-Y. Hu, S. Choi, and Y.-Z. You, \u201cClassical shadow tomography with locally scrambled\nquantum dynamics\u201d, Phys. Rev. Res. 5, 023027 (2023) doi: 10.1103/PhysRevResearch.5.\n023027.\n[98]\nC. Bertoni, J. Haferkamp, M. Hinsche, M. Ioannou, J. Eisert, and H. Pashayan, Shallow\nshadows: expectation estimation using low-depth random clifford circuits, 2023, doi: https:\n//doi.org/10.48550/arXiv.2209.12924.\n[99]\nK. Bu, D. E. Koh, R. J. Garcia, and A. Jaffe, \u201cClassical shadows with pauli-invariant unitary\nensembles\u201d, npj Quantum Information 10, doi: 10.1038/s41534-023-00801-w (2024) doi:\n10.1038/s41534-023-00801-w.\n48\n"}